---
title: 第二次考核总结
date: 2024-04-13 15:11:57
tags: []
categories:
cover: https://w.wallhaven.cc/full/l3/wallhaven-l3xk6q.jpg
---
# 第二次考核总结

## 1.应用层的服务

服务包括FTP、POP3（邮件）、SMTP、DHCP、DNS、SNMP、Telent Http

![image-20231117222144171](https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117222144171.png)

is-is和ospf协议类似，都是网络层的协议吧

## 3.ospf算法

ospf依赖于迪杰什特算法（spf算法）

### 思路

引进两个集合S和U，初始时，S中只有起点s；U中是除s之外的顶点，并且U中顶点的路径是”起点s到该顶点的路径”。然后，从U中找出路径最短的顶点，并将其加入到S中；接着，更新U中的顶点和顶点对应的路径。 然后，再从U中找出路径最短的顶点，并将其加入到S中；接着，更新U中的顶点和顶点对应的路径。 … 重复该操作，直到遍历完所有顶点。

### 操作步骤

1. 初始时，S只包含起点s；U包含除s外的其他顶点，且U中顶点的距离为”起点s到该顶点的距离”[例如，U中顶点v的距离为(s,v)的长度，然后s和v不相邻，则v的距离为∞]。
2. 从U中选出”距离最短的顶点k”，并将顶点k加入到S中；同时，从U中移除顶点k。
3. 更新U中各个顶点到起点s的距离。之所以更新U中顶点的距离，是由于上一步中确定了k是求出最短路径的顶点，从而可以利用k来更新其它顶点的距离；例如，(s,v)的距离可能大于(s,k)+(k,v)的距离。
4. 重复步骤(2)和(3)，直到遍历完所有顶点。

![image-20231117212858051](https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117212858051.png)

**距离都是相对于第一个顶点说的**

1. **以点D作为起点，A,B,G,F都是无穷的距离，然后C和E比较小的是c-3**
2. **接着取c作为顶点，A,G是无穷点，然后最小的是E-4**
3. **将E加入到顶点，无穷是A，最小的是F-6**
4. **取F最小的是G-12**
5. **取G点，最小的是b-13**
6. **取b点只剩下了a-22**

此时d到每一个点的最短距离就算出来了



## 7.7类LSA

一类：每路由器都会产生一条，描述自己的IP状况---本区域

二类：（DR产生）描述自己的IP状况（DR1，2类都可以产生）---本区域

三类：（ABR）将本区域的路由传输出去（1，2类转3类），可以从骨干到非骨干也可以从非骨干到骨干

四类：（ABR）描述ABR的位置信息，为第五类服务

五类：（ASBR）传递ospf的外部路由信息，做了路由引入到ospf的路由器就是ASBR

七类：（ASBR）适用于nssa的五类lsa



## 6.acl分类

基本acl：2000---2999

高级acl：3000---3999

二层acl：4000---4999

**用户自定义acl**：5000-5999

**用户acl**：6000---6999



数字型和命名型

## 11.MSTP解决了RSTP和STP的什么问题

![image-20231117211022375](https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117211022375.png)

我还是觉得mstp解决了vlan间不能负载均衡的问题

**hedex里面的文段：为了弥补STP和RSTP的缺陷，IEEE于2002年发布的802.1S标准定义了MSTP。MSTP兼容STP和RSTP，既可以快速收敛，又提供了数据转发的多个冗余路径，在数据转发过程中实现VLAN数据的负载均衡。**

## 12.路由备份和负载分担

路由备份：目的相同，下一跳不同，优先级不同，开销相同

负载分担：目的相同，下一跳不同，协议相同（优先级相同），开销相同（有一定的随机性）

## 13.RIP的防环机制

1-记数最大值（maximum hop count）：**定义最大跳数**（最大为15跳），当跳数为16跳时,目标为不可达

2- 水平分割（split horizon）：从**一个接口学习到的路由不会再广播回**该接口。**cisco可以对每个接口关闭水平分割功能。**

3-路由毒化（route posion）：**当拓扑变化时，路由器会将失效的路由标记为possibly down状态，并分配一个不可达的度量值。**（主动发）

4-毒性逆转（poison reverse）：从**一个接口学习的路由**会发送回该接口，但是已经被毒化，跳数设置为16跳，不可达。（被动接收到一个信息再还回去，随便下个毒）

5-触发更新（trigger update）：一旦检测到路由崩溃，**立即广播路由刷新** 报文，而不等到下一刷新周期。

6- 抑制计时器（holddown timer）：防止路由表频繁翻动，增加了网络的稳定性。（？）

## 14.ping包的后缀

 **-a**：**选择源IP地址，默认为输出接口。**

  **-t**：等待每一个回答的超时时间。单位毫秒，默认为2000毫秒。（一直ping）

  **-tos**：指定发送回显请求的TOS值，默认为0.

  ***\*-f\****：在数据包中设置不分段标志（仅ipv4）

  ***\*-h\****：指定发送到ECHO请求的TTL值，默认为255.（**生存时间**）

  **-m**：等待发送下一个包时间，以毫秒为单位，默认500毫秒。

**-s**：指定要发送的**数据字节数**，默认为56字节。（报文长度）

 ***\*-c\****：指定要发送的ECHO请求数量，默认为5.（报文数）

## 15.arp

**ARP 属于数据链路层，理由按照 OSI 参考模型， 数据链路层 封装 IP 报文时，需要通过 ARP 获取链路层目的地址，添加到报文头部，这就不属于网络层的功能了**。 结论：在 TCP/IP 模式中 ARP 协议属于网络层，在 OSI 参考模型中 ARP 协议属于数据链路层。

## 17.route-policy（路由策略）

**一个route policy下从小到大匹配node，一旦匹配到那就不再匹配，所以是或的关系**

多个apply之间是与的关系

**相同的if-match之间是或的关系**（多个route policy 如果都if-match了一个acl，假如说是acl2000，那么只有第一个route policy 能匹配上）

不同的if-match之间是与的关系（同一个route policy可以接n个acl规则）



**路由策略本质上控制出还是不出，属于是控制范畴**

## 18.RSTP快速收敛

**快速收敛**

**Proposal/Agreement机制**

pa是快速响应

当一个端口被选举成为指定端口之后，在STP中，该端口至少要等待一个Forward Delay（Learning）时间才会迁移到Forwarding状态。而在RSTP中，**此端口会先进入Discarding状态，再通过Proposal/Agreement机制快速进入Forward状态**。这种机制必须在**点到点**    **全双工链路**上使用。



**根端口快速切换机制**

如果网络中一个**根端口**失效，那么网络中**最优的Alternate端口将成为根端口**，进入Forwarding状态。因为通过这个Alternate端口连接的网段上必然有个指定端口可以通往根桥。

**边缘端口的引入**

**边缘端口不接收处理配置BPDU，不参与RSTP运算**，可以由Disable直接转到Forwarding状态，且不经历时延，就像在端口上将STP禁用。

### rstp的三种状态

- 如果不转发用户流量也不学习MAC地址，那么端口状态就是Discarding状态。
- 如果不转发用户流量但是学习MAC地址，那么端口状态就是Learning状态。
- 如果既转发用户流量又学习MAC地址，那么端口状态就是Forwarding状态。

相对于普通的stp没了listening、blocking和disabled状态

## 19.ospf区域的优点

1. 错误点：ospf不能了解区域外部的拓扑细节，它只能拿到路由信息，它具体怎么连（细节）是无法得知的
2. 关键点：同一个区域的数据库必须一样，那么原来比如三个交换机的数据现在只有一个了！那么并不就是减小lsdb么
3. lsdb小了那lsa也小了啊
4. 泛洪被限制在了区域里

## 4.4策略路由

1. 定义目的和终点
2. 关联acl
3. 选择走哪一条路
4. 还是关联

就是控制数据往哪里走，属于**转发**的范畴

## 20.通配符掩码

为1的位不变，其他的要改变，10.1.1.0   0.0.254.255说明第三位最后一个是一，在一的基础上加2，加4等等。

## 判断题

1题arp主要是解决**同一网络**的地址映射问题

4题它指的是时间上的先后而不是序号的先后。。。

## 4.3路由优先级

**直连路由 0**

**ospf 10**

**静态路由 60**

**rip 100**



## 5.1ospf和rip的区别

【工作核心不同】RIP：**数跳数；**OSPF：**计算链路的度量值**

【发送对象不同】osp**f向区域里所有人发，rip和相邻**的发

【特殊对象】ospf有dr和bdr的选举

【发送协议不同】**rip用udp包，ospf用ip包**

（。。。v2不用加掩码，记错了，v1加掩码）

## OSPF的五个报文

1. Hello报文：周期性发送，用于**发现和维持OSPF邻居**关系；
2. DD报文(DataBase Description Packet)：数据库描述报文，**描述本地LSDB的摘要信息**，用于两台路由器进行**数据库同步；**

3. **LSR报文**(Link State Request Packet)：链路状态请求报文，向对方**请求**所需要的**LSA**；

4. **LSU报文**(Link State Update Packet)：链路状态更新报文，向对方**发送**其所需要的**LSA**或者泛洪自己更新的LSA；

5. **LSAck**报文(Link State Acknowledgment Packet)：链路状态确认报文，用于**对收到的LSA进行确认。**

Hello报文和LSAck报文不需要确认。


## OSPF的七个邻居状态

1. Down    没有收到Hello包                                                
2. **Attempt （一般不存在）**Attempt 在帧中继网络中才会出现，表示的是网络为测试、唤醒状态
3. Init         		收到邻居发来的Hello包，但是收到Hello包中的邻居字段没有自己

4. 2-Way    收到邻居发来的Hello包的邻居列表中有自己，建立邻居关系（双向奔赴）    
5. Exstart    发送DD报文（此处DD报文不包含LSA头部信息）
6. Exchange   通过交换DD报文，交换LSA头部信息


​     具体的交互流程（？？？）

上述Exstart状态决定出主从关系后，即从设备此时收到了主设备发来的空的DD报文

从设备使用主的序列号发送DD报文来回应主（此时DD报文包含LSA头部信息）

主也通过DD报文发送自己的LSA头部信息，并将序列号加1

从又使用主的序列号回应主；一直循环，直到主与从的M位都不置位（或者说只要有一侧有未传递的LSA头，就会一直循环）  

7. Loading     通过上述获得的LSA头部信息，来确定自己需要哪些LSA
8. Full          LSDB同步完成，建立邻接关系



## NAT的种类、优缺点、适用场景



| 种类             | 优点                                     | 缺点                                             | 适用场景                             |
| ---------------- | ---------------------------------------- | ------------------------------------------------ | ------------------------------------ |
| 静态NAT          | 配置简单                                 | 不节省公网IP地址                                 | 一般用于在内网中对外提供服务的服务器 |
| 动态NAT          | 每个公网ip不再固定绑定私网设备，动态映射 | 进行地址转换的公网地址太少，新的设备无法对外通信 | 有限公网ip做临时的网络地址转换       |
| NAPT（增加端口） | 多个内网使用一个公网ip，更安全           | **通信仅限于TCP或UDP**，端口号可能不足           | 大型网络、多个设备绑定一个公网ip     |
| EASY IP          | 配置简单                                 | 太简单了，拓展性不够                             | 使用于小型网络，如家庭网             |

