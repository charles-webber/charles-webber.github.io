<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>asuka&amp;ayanami</title>
  
  <subtitle>anobaga?</subtitle>
  <link href="http://charles-webebr.github.io/atom.xml" rel="self"/>
  
  <link href="http://charles-webebr.github.io/"/>
  <updated>2024-04-13T07:11:57.199Z</updated>
  <id>http://charles-webebr.github.io/</id>
  
  <author>
    <name>charles-webber</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%80%83%E6%A0%B8%E6%80%BB%E7%BB%93/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%80%83%E6%A0%B8%E6%80%BB%E7%BB%93/</id>
    <published>2024-07-10T07:22:46.130Z</published>
    <updated>2024-04-13T07:11:57.199Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第二次考核总结"><a href="#第二次考核总结" class="headerlink" title="第二次考核总结"></a>第二次考核总结</h1><h2 id="1-应用层的服务"><a href="#1-应用层的服务" class="headerlink" title="1.应用层的服务"></a>1.应用层的服务</h2><p>服务包括FTP、POP3（邮件）、SMTP、DHCP、DNS、SNMP、Telent Http</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117222144171.png" alt="image-20231117222144171"></p><p>is-is和ospf协议类似，都是网络层的协议吧</p><h2 id="3-ospf算法"><a href="#3-ospf算法" class="headerlink" title="3.ospf算法"></a>3.ospf算法</h2><p>ospf依赖于迪杰什特算法（spf算法）</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>引进两个集合S和U，初始时，S中只有起点s；U中是除s之外的顶点，并且U中顶点的路径是”起点s到该顶点的路径”。然后，从U中找出路径最短的顶点，并将其加入到S中；接着，更新U中的顶点和顶点对应的路径。 然后，再从U中找出路径最短的顶点，并将其加入到S中；接着，更新U中的顶点和顶点对应的路径。 … 重复该操作，直到遍历完所有顶点。</p><h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><ol><li>初始时，S只包含起点s；U包含除s外的其他顶点，且U中顶点的距离为”起点s到该顶点的距离”[例如，U中顶点v的距离为(s,v)的长度，然后s和v不相邻，则v的距离为∞]。</li><li>从U中选出”距离最短的顶点k”，并将顶点k加入到S中；同时，从U中移除顶点k。</li><li>更新U中各个顶点到起点s的距离。之所以更新U中顶点的距离，是由于上一步中确定了k是求出最短路径的顶点，从而可以利用k来更新其它顶点的距离；例如，(s,v)的距离可能大于(s,k)+(k,v)的距离。</li><li>重复步骤(2)和(3)，直到遍历完所有顶点。</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117212858051.png" alt="image-20231117212858051"></p><p><strong>距离都是相对于第一个顶点说的</strong></p><ol><li><strong>以点D作为起点，A,B,G,F都是无穷的距离，然后C和E比较小的是c-3</strong></li><li><strong>接着取c作为顶点，A,G是无穷点，然后最小的是E-4</strong></li><li><strong>将E加入到顶点，无穷是A，最小的是F-6</strong></li><li><strong>取F最小的是G-12</strong></li><li><strong>取G点，最小的是b-13</strong></li><li><strong>取b点只剩下了a-22</strong></li></ol><p>此时d到每一个点的最短距离就算出来了</p><h2 id="7-7类LSA"><a href="#7-7类LSA" class="headerlink" title="7.7类LSA"></a>7.7类LSA</h2><p>一类：每路由器都会产生一条，描述自己的IP状况—本区域</p><p>二类：（DR产生）描述自己的IP状况（DR1，2类都可以产生）—本区域</p><p>三类：（ABR）将本区域的路由传输出去（1，2类转3类），可以从骨干到非骨干也可以从非骨干到骨干</p><p>四类：（ABR）描述ABR的位置信息，为第五类服务</p><p>五类：（ASBR）传递ospf的外部路由信息，做了路由引入到ospf的路由器就是ASBR</p><p>七类：（ASBR）适用于nssa的五类lsa</p><h2 id="6-acl分类"><a href="#6-acl分类" class="headerlink" title="6.acl分类"></a>6.acl分类</h2><p>基本acl：2000—2999</p><p>高级acl：3000—3999</p><p>二层acl：4000—4999</p><p><strong>用户自定义acl</strong>：5000-5999</p><p><strong>用户acl</strong>：6000—6999</p><p>数字型和命名型</p><h2 id="11-MSTP解决了RSTP和STP的什么问题"><a href="#11-MSTP解决了RSTP和STP的什么问题" class="headerlink" title="11.MSTP解决了RSTP和STP的什么问题"></a>11.MSTP解决了RSTP和STP的什么问题</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231117211022375.png" alt="image-20231117211022375"></p><p>我还是觉得mstp解决了vlan间不能负载均衡的问题</p><p><strong>hedex里面的文段：为了弥补STP和RSTP的缺陷，IEEE于2002年发布的802.1S标准定义了MSTP。MSTP兼容STP和RSTP，既可以快速收敛，又提供了数据转发的多个冗余路径，在数据转发过程中实现VLAN数据的负载均衡。</strong></p><h2 id="12-路由备份和负载分担"><a href="#12-路由备份和负载分担" class="headerlink" title="12.路由备份和负载分担"></a>12.路由备份和负载分担</h2><p>路由备份：目的相同，下一跳不同，优先级不同，开销相同</p><p>负载分担：目的相同，下一跳不同，协议相同（优先级相同），开销相同（有一定的随机性）</p><h2 id="13-RIP的防环机制"><a href="#13-RIP的防环机制" class="headerlink" title="13.RIP的防环机制"></a>13.RIP的防环机制</h2><p>1-记数最大值（maximum hop count）：<strong>定义最大跳数</strong>（最大为15跳），当跳数为16跳时,目标为不可达</p><p>2- 水平分割（split horizon）：从<strong>一个接口学习到的路由不会再广播回</strong>该接口。<strong>cisco可以对每个接口关闭水平分割功能。</strong></p><p>3-路由毒化（route posion）：<strong>当拓扑变化时，路由器会将失效的路由标记为possibly down状态，并分配一个不可达的度量值。</strong>（主动发）</p><p>4-毒性逆转（poison reverse）：从<strong>一个接口学习的路由</strong>会发送回该接口，但是已经被毒化，跳数设置为16跳，不可达。（被动接收到一个信息再还回去，随便下个毒）</p><p>5-触发更新（trigger update）：一旦检测到路由崩溃，<strong>立即广播路由刷新</strong> 报文，而不等到下一刷新周期。</p><p>6- 抑制计时器（holddown timer）：防止路由表频繁翻动，增加了网络的稳定性。（？）</p><h2 id="14-ping包的后缀"><a href="#14-ping包的后缀" class="headerlink" title="14.ping包的后缀"></a>14.ping包的后缀</h2><p> <strong>-a</strong>：<strong>选择源IP地址，默认为输出接口。</strong></p><p>  <strong>-t</strong>：等待每一个回答的超时时间。单位毫秒，默认为2000毫秒。（一直ping）</p><p>  <strong>-tos</strong>：指定发送回显请求的TOS值，默认为0.</p><p>  ****-f****：在数据包中设置不分段标志（仅ipv4）</p><p>  ****-h*<em><strong>：指定发送到ECHO请求的TTL值，默认为255.（</strong>生存时间</em>*）</p><p>  <strong>-m</strong>：等待发送下一个包时间，以毫秒为单位，默认500毫秒。</p><p><strong>-s</strong>：指定要发送的<strong>数据字节数</strong>，默认为56字节。（报文长度）</p><p> ****-c****：指定要发送的ECHO请求数量，默认为5.（报文数）</p><h2 id="15-arp"><a href="#15-arp" class="headerlink" title="15.arp"></a>15.arp</h2><p><strong>ARP 属于数据链路层，理由按照 OSI 参考模型， 数据链路层 封装 IP 报文时，需要通过 ARP 获取链路层目的地址，添加到报文头部，这就不属于网络层的功能了</strong>。 结论：在 TCP&#x2F;IP 模式中 ARP 协议属于网络层，在 OSI 参考模型中 ARP 协议属于数据链路层。</p><h2 id="17-route-policy（路由策略）"><a href="#17-route-policy（路由策略）" class="headerlink" title="17.route-policy（路由策略）"></a>17.route-policy（路由策略）</h2><p><strong>一个route policy下从小到大匹配node，一旦匹配到那就不再匹配，所以是或的关系</strong></p><p>多个apply之间是与的关系</p><p><strong>相同的if-match之间是或的关系</strong>（多个route policy 如果都if-match了一个acl，假如说是acl2000，那么只有第一个route policy 能匹配上）</p><p>不同的if-match之间是与的关系（同一个route policy可以接n个acl规则）</p><p><strong>路由策略本质上控制出还是不出，属于是控制范畴</strong></p><h2 id="18-RSTP快速收敛"><a href="#18-RSTP快速收敛" class="headerlink" title="18.RSTP快速收敛"></a>18.RSTP快速收敛</h2><p><strong>快速收敛</strong></p><p><strong>Proposal&#x2F;Agreement机制</strong></p><p>pa是快速响应</p><p>当一个端口被选举成为指定端口之后，在STP中，该端口至少要等待一个Forward Delay（Learning）时间才会迁移到Forwarding状态。而在RSTP中，<strong>此端口会先进入Discarding状态，再通过Proposal&#x2F;Agreement机制快速进入Forward状态</strong>。这种机制必须在<strong>点到点</strong>    <strong>全双工链路</strong>上使用。</p><p><strong>根端口快速切换机制</strong></p><p>如果网络中一个<strong>根端口</strong>失效，那么网络中<strong>最优的Alternate端口将成为根端口</strong>，进入Forwarding状态。因为通过这个Alternate端口连接的网段上必然有个指定端口可以通往根桥。</p><p><strong>边缘端口的引入</strong></p><p><strong>边缘端口不接收处理配置BPDU，不参与RSTP运算</strong>，可以由Disable直接转到Forwarding状态，且不经历时延，就像在端口上将STP禁用。</p><h3 id="rstp的三种状态"><a href="#rstp的三种状态" class="headerlink" title="rstp的三种状态"></a>rstp的三种状态</h3><ul><li>如果不转发用户流量也不学习MAC地址，那么端口状态就是Discarding状态。</li><li>如果不转发用户流量但是学习MAC地址，那么端口状态就是Learning状态。</li><li>如果既转发用户流量又学习MAC地址，那么端口状态就是Forwarding状态。</li></ul><p>相对于普通的stp没了listening、blocking和disabled状态</p><h2 id="19-ospf区域的优点"><a href="#19-ospf区域的优点" class="headerlink" title="19.ospf区域的优点"></a>19.ospf区域的优点</h2><ol><li>错误点：ospf不能了解区域外部的拓扑细节，它只能拿到路由信息，它具体怎么连（细节）是无法得知的</li><li>关键点：同一个区域的数据库必须一样，那么原来比如三个交换机的数据现在只有一个了！那么并不就是减小lsdb么</li><li>lsdb小了那lsa也小了啊</li><li>泛洪被限制在了区域里</li></ol><h2 id="4-4策略路由"><a href="#4-4策略路由" class="headerlink" title="4.4策略路由"></a>4.4策略路由</h2><ol><li>定义目的和终点</li><li>关联acl</li><li>选择走哪一条路</li><li>还是关联</li></ol><p>就是控制数据往哪里走，属于<strong>转发</strong>的范畴</p><h2 id="20-通配符掩码"><a href="#20-通配符掩码" class="headerlink" title="20.通配符掩码"></a>20.通配符掩码</h2><p>为1的位不变，其他的要改变，10.1.1.0   0.0.254.255说明第三位最后一个是一，在一的基础上加2，加4等等。</p><h2 id="判断题"><a href="#判断题" class="headerlink" title="判断题"></a>判断题</h2><p>1题arp主要是解决<strong>同一网络</strong>的地址映射问题</p><p>4题它指的是时间上的先后而不是序号的先后。。。</p><h2 id="4-3路由优先级"><a href="#4-3路由优先级" class="headerlink" title="4.3路由优先级"></a>4.3路由优先级</h2><p><strong>直连路由 0</strong></p><p><strong>ospf 10</strong></p><p><strong>静态路由 60</strong></p><p><strong>rip 100</strong></p><h2 id="5-1ospf和rip的区别"><a href="#5-1ospf和rip的区别" class="headerlink" title="5.1ospf和rip的区别"></a>5.1ospf和rip的区别</h2><p>【工作核心不同】RIP：<strong>数跳数；</strong>OSPF：<strong>计算链路的度量值</strong></p><p>【发送对象不同】osp<strong>f向区域里所有人发，rip和相邻</strong>的发</p><p>【特殊对象】ospf有dr和bdr的选举</p><p>【发送协议不同】<strong>rip用udp包，ospf用ip包</strong></p><p>（。。。v2不用加掩码，记错了，v1加掩码）</p><h2 id="OSPF的五个报文"><a href="#OSPF的五个报文" class="headerlink" title="OSPF的五个报文"></a>OSPF的五个报文</h2><ol><li><p>Hello报文：周期性发送，用于<strong>发现和维持OSPF邻居</strong>关系；</p></li><li><p>DD报文(DataBase Description Packet)：数据库描述报文，<strong>描述本地LSDB的摘要信息</strong>，用于两台路由器进行<strong>数据库同步；</strong></p></li><li><p><strong>LSR报文</strong>(Link State Request Packet)：链路状态请求报文，向对方<strong>请求</strong>所需要的<strong>LSA</strong>；</p></li><li><p><strong>LSU报文</strong>(Link State Update Packet)：链路状态更新报文，向对方<strong>发送</strong>其所需要的<strong>LSA</strong>或者泛洪自己更新的LSA；</p></li><li><p><strong>LSAck</strong>报文(Link State Acknowledgment Packet)：链路状态确认报文，用于<strong>对收到的LSA进行确认。</strong></p></li></ol><p>Hello报文和LSAck报文不需要确认。</p><h2 id="OSPF的七个邻居状态"><a href="#OSPF的七个邻居状态" class="headerlink" title="OSPF的七个邻居状态"></a>OSPF的七个邻居状态</h2><ol><li><p>Down    没有收到Hello包                                                </p></li><li><p><strong>Attempt （一般不存在）</strong>Attempt 在帧中继网络中才会出现，表示的是网络为测试、唤醒状态</p></li><li><p>Init         收到邻居发来的Hello包，但是收到Hello包中的邻居字段没有自己</p></li><li><p>2-Way    收到邻居发来的Hello包的邻居列表中有自己，建立邻居关系（双向奔赴）    </p></li><li><p>Exstart    发送DD报文（此处DD报文不包含LSA头部信息）</p></li><li><p>Exchange   通过交换DD报文，交换LSA头部信息</p></li></ol><p>​     具体的交互流程（？？？）</p><p>上述Exstart状态决定出主从关系后，即从设备此时收到了主设备发来的空的DD报文</p><p>从设备使用主的序列号发送DD报文来回应主（此时DD报文包含LSA头部信息）</p><p>主也通过DD报文发送自己的LSA头部信息，并将序列号加1</p><p>从又使用主的序列号回应主；一直循环，直到主与从的M位都不置位（或者说只要有一侧有未传递的LSA头，就会一直循环）  </p><ol start="7"><li>Loading     通过上述获得的LSA头部信息，来确定自己需要哪些LSA</li><li>Full          LSDB同步完成，建立邻接关系</li></ol><h2 id="NAT的种类、优缺点、适用场景"><a href="#NAT的种类、优缺点、适用场景" class="headerlink" title="NAT的种类、优缺点、适用场景"></a>NAT的种类、优缺点、适用场景</h2><table><thead><tr><th>种类</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td>静态NAT</td><td>配置简单</td><td>不节省公网IP地址</td><td>一般用于在内网中对外提供服务的服务器</td></tr><tr><td>动态NAT</td><td>每个公网ip不再固定绑定私网设备，动态映射</td><td>进行地址转换的公网地址太少，新的设备无法对外通信</td><td>有限公网ip做临时的网络地址转换</td></tr><tr><td>NAPT（增加端口）</td><td>多个内网使用一个公网ip，更安全</td><td><strong>通信仅限于TCP或UDP</strong>，端口号可能不足</td><td>大型网络、多个设备绑定一个公网ip</td></tr><tr><td>EASY IP</td><td>配置简单</td><td>太简单了，拓展性不够</td><td>使用于小型网络，如家庭网</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;第二次考核总结&quot;&gt;&lt;a href=&quot;#第二次考核总结&quot; class=&quot;headerlink&quot; title=&quot;第二次考核总结&quot;&gt;&lt;/a&gt;第二次考核总结&lt;/h1&gt;&lt;h2 id=&quot;1-应用层的服务&quot;&gt;&lt;a href=&quot;#1-应用层的服务&quot; class=&quot;headerli</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/openwrt/"/>
    <id>http://charles-webebr.github.io/2024/07/10/openwrt/</id>
    <published>2024-07-10T07:22:46.128Z</published>
    <updated>2024-05-28T07:39:19.348Z</updated>
    
    <content type="html"><![CDATA[<h1 id="openwrt-第一周"><a href="#openwrt-第一周" class="headerlink" title="openwrt-第一周"></a>openwrt-第一周</h1><h2 id="web界面"><a href="#web界面" class="headerlink" title="web界面"></a>web界面</h2><p>nx30 pro已经刷入了immortalWrt的系统，我们将路由器的wan口用双绞线和电脑相连，进入浏览器输入192.168.6.1即可打开web界面</p><p>进入之后发现有系统概况、防火墙、路由表、负载均衡等功能，非常直观就能配置而省去了输入命令的麻烦</p><p><img src="/.io//Users/alex/Documents/Tencent%20Files/1484145749/FileRecv/MobileFile/IMG20240516221533.jpg" alt="IMG20240516221533"></p><p>除此之外openwrt还能支持多种插件服务，比如说clash来对流量进行代理</p><p><img src="/.io//Users/alex/Documents/Tencent%20Files/1484145749/FileRecv/MobileFile/IMG20240516223237.jpg" alt="IMG20240516223237"></p><h2 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h2><h3 id="有usb口"><a href="#有usb口" class="headerlink" title="有usb口"></a>有usb口</h3><ol><li>利用写盘工具将固件烧录到我们的u盘中变成启动盘</li><li>将u盘插入路由器并且连接显示器、鼠标键盘后开机</li><li>进行系统安装</li></ol><h3 id="无usb口"><a href="#无usb口" class="headerlink" title="无usb口"></a>无usb口</h3><ol><li>利用putty工具登录到路由器</li><li>开启ssh</li><li>刷写uboot（系统引导加载程序）</li><li>路由器插电脑上，电脑更改静态ip为192.168.1.2 网关设置为192.168.1.1，浏览器输入192.168.1.1进入uboot的web界面，再选择并且刷入固件</li><li>等待路由器重启，将路由器的wan口用双绞线和电脑相连，进入浏览器输入192.168.6.1即可打开web界面</li></ol><h2 id="入门课"><a href="#入门课" class="headerlink" title="入门课"></a>入门课</h2><h3 id="路由器硬件构成"><a href="#路由器硬件构成" class="headerlink" title="路由器硬件构成"></a>路由器硬件构成</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240520150340298.png" alt="image-20240520150340298"></p><p>usb总线速度有点慢，跑802.ac不够</p><p><strong>板子</strong></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240520150917301.png" alt="image-20240520150917301"></p><ul><li><p>wifi芯片2.4g，5g一般是外挂的（7621，2.4g，5g）</p></li><li><p>电平：ttl和cmos</p></li><li><p>ram：DD2&#x2F;DDR3</p></li><li><p>rom：常见8-32M，一般是spi和nand（nor不用了），spi（串型）是工业用总线，容量不能太大；nand比spi好使，家用型</p></li></ul><h1 id="openwrt-第二周"><a href="#openwrt-第二周" class="headerlink" title="openwrt-第二周"></a>openwrt-第二周</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;openwrt-第一周&quot;&gt;&lt;a href=&quot;#openwrt-第一周&quot; class=&quot;headerlink&quot; title=&quot;openwrt-第一周&quot;&gt;&lt;/a&gt;openwrt-第一周&lt;/h1&gt;&lt;h2 id=&quot;web界面&quot;&gt;&lt;a href=&quot;#web界面&quot; class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/openuler2/"/>
    <id>http://charles-webebr.github.io/2024/07/10/openuler2/</id>
    <published>2024-07-10T07:22:46.126Z</published>
    <updated>2024-04-22T13:59:11.824Z</updated>
    
    <content type="html"><![CDATA[<h1 id="openuler2"><a href="#openuler2" class="headerlink" title="openuler2"></a>openuler2</h1><h2 id="常见文本编辑器"><a href="#常见文本编辑器" class="headerlink" title="常见文本编辑器"></a>常见文本编辑器</h2><p>Huawei Confidential5<br>Linux文本编辑器介绍<br>⚫ 文本编辑器是操作系统基础的功能软件之一。根据使用环境的不同，Linux的文本编<br>辑器有很多类型。<br>⚫ 常见的Linux文本编辑器有：<br> emacs<br> nano<br> gedit<br> kedit</p><h2 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h2><h3 id="关于vim你需要了解"><a href="#关于vim你需要了解" class="headerlink" title="关于vim你需要了解"></a>关于vim你需要了解</h3><p> Vim是从vi发展出来的一个文本编辑器。其代码补完、编译及错误跳转等方便编程的功能特<br>别丰富，在程序员中被广泛使用。和Emacs并列成为类Unix系统用户最喜欢的编辑器。<br>⚫ Vim的第一个版本由布莱姆·米勒在1991年发布。最初的简称是Vi IMitation，随着功能的不<br>断增加，正式名称改成了Vi IMproved。现在是在开放源代码方式下发行的自由软件。<br>⚫ 从vi派生出来的Vim具有多种模式：<br> 基本模式：普通模式、插入模式、可视模式、选择模式、命令行模式、Ex模式<br> 派生模式：操作符等待模式、插入普通模式、插入可视模式、插入选择模式、替换模式<br> 其他：Evim<br>⚫ openEuler 20.03 LTS系统安装后默认没有安装vim，需要手动安装vim</p><p>基本模式<br>▫ 普通模式：在普通模式中，用的编辑器命令，比如移动光标，删除文本等等。<br>这也是Vim启动后的默认模式。这正好和许多新用户期待的操作方式相反（大<br>多数编辑器默认模式为插入模式）。Vim强大的编辑能力来自于其普通模式命<br>令。普通模式命令往往需要一个操作符结尾。例如普通模式命令”dd”删除当前<br>行，但是第一个”d”的后面可以跟另外的移动命令来代替第二个”d”，比如用移<br>动到下一行的”j”键就可以删除当前行和下一行。另外还可以指定命令重复次数，<br>“2dd”（重复”dd”两次），和”dj”的效果是一样的。用户学习了各种各样的文本<br>间移动／跳转的命令和其他的普通模式的编辑命令，并且能够灵活组合使用的<br>话，能够比那些没有模式的编辑器更加高效的进行文本编辑。在普通模式中，<br>有很多方法可以进入插入模式。比较普通的方式是按”a”（append／追加）键<br>或者”i”（insert／插入）键。<br>▫ 插入模式：在这个模式中，大多数按键都会向文本缓冲区中插入文本。大多数<br>新用户希望文本编辑器编辑过程中一直保持这个模式。在插入模式中，可以按<br>ESC键回到普通模式。<br>▫ 可视模式：这个模式与普通模式比较相似。但是移动命令会扩大高亮的文本区<br>域。高亮区域可以是字符、行或者是一块文本。当执行一个非移动命令时，命<br>令会被执行到这块高亮的区域上。Vim的”文本对象”也能和移动命令一样用在这<br>个模式中。<br>▫ 选择模式：这个模式和无模式编辑器的行为比较相似（Windows标准文本控件<br>的方式）。这个模式中，可以用鼠标或者光标键高亮选择文本，不过输入任何<br>字符的话，Vim会用这个字符替换选择的高亮文本块，并且自动进入插入模式。</p><h3 id="vim打开文件进行编写"><a href="#vim打开文件进行编写" class="headerlink" title="vim打开文件进行编写"></a>vim打开文件进行编写</h3><p>常见参数：<br> -c ：打开文件前线执行指定的命令<br> -R ：以只读方式打开，但是可以强制保存<br> -M ：以只读方式打开，不可以强制保存<br> -r ：回复崩溃的会话<br> +<br>num ：从第num行开始</p><p><strong>如果文件不存在则创建</strong></p><h3 id="移动光标"><a href="#移动光标" class="headerlink" title="移动光标"></a>移动光标</h3><p> 上下左右键或k、j、h、l键上下左右移动光标<br> 0 移动到行首<br> g0 移到光标所在屏幕行行首<br> :n 移动到第n行。<br> gg: 到文件头部。<br> G: 到文件尾部</p><h3 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h3><p><strong>数据操作</strong><br> yy or Y: 复制整行文本。<br> y[n]w: 复制一(n)个词。<br> d[n]w: 删除（剪切）1(n)个单词<br> [n] dd: 删除（剪切）1(n)行</p><p><strong>复制</strong><br> yy or Y: 复制整行文本。<br> y[n]w: 复制一(n)个词。<br>⚫ <strong>粘贴</strong><br> 面向行的数据：<br>◼ p 放置数据在当前行的下面<br>◼ P 放置数据在当前行的上面<br> <strong>面向字符的数据</strong><br>◼ p 放置数据在光标的后面<br>◼ P 放置数据在光标前<br>⚫ <strong>删除</strong><br> d[n]w: 删除（剪切）1(n)个单词<br> [n] dd: 删除（剪切）1(n)行</p><h3 id="行号显示与取消"><a href="#行号显示与取消" class="headerlink" title="行号显示与取消"></a>行号显示与取消</h3><p><strong>显示行号</strong></p><p>set nu </p><p><strong>取消显示</strong></p><p>set nonu</p><h3 id="查找和替换"><a href="#查找和替换" class="headerlink" title="查找和替换"></a>查找和替换</h3><ul><li>查找</li></ul><p>​     &#x2F;word 向后搜索</p><p>​？word 向前搜索</p><ul><li><p>替换</p><p>:1,5s&#x2F;word1&#x2F;word2&#x2F;g </p><p>将文档中1-5行的word1替换为word2，不加g则只替换每行的第<br>一个word1。<br>：%s&#x2F;word1&#x2F;word2&#x2F;gi </p><p>将文档所有的word1替换为word2，不区分大小写。</p></li></ul><h3 id="设置搜索高亮"><a href="#设置搜索高亮" class="headerlink" title="设置搜索高亮"></a>设置搜索高亮</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240422215342529.png" alt="image-20240422215342529"></p><h3 id="修改文件"><a href="#修改文件" class="headerlink" title="修改文件"></a>修改文件</h3><p>输入i进入插入模式进行修改文件</p><p>修改完成后点击esc退出修改模式</p><p>输入：wq保存并且退出</p><h3 id="撤销与重做"><a href="#撤销与重做" class="headerlink" title="撤销与重做"></a>撤销与重做</h3><p>u撤销</p><p>ctrl+r重做</p><h3 id="保存与退出"><a href="#保存与退出" class="headerlink" title="保存与退出"></a>保存与退出</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240422215621336.png" alt="image-20240422215621336"></p><h2 id="文件文本操作"><a href="#文件文本操作" class="headerlink" title="文件文本操作"></a>文件文本操作</h2><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><p>小猫老弟</p><p>cat 是一个文本文件查看和连接工具。cat有如下功能：<br> <strong>显示文件内容</strong>，cat filename<br> <strong>编辑一个文件</strong>，cat &gt; filename。<br> 将几个文件<strong>合并为一个文件</strong>，cat file1 file2 &gt; file3<br>⚫ cat常用选项有：<br> -n：从1开始对<u>所有行</u><strong>编号</strong>并显示在每行开头<br> -b：从1开始对<u>非空行</u><strong>编号</strong>并显示在每行开头<br> -s：当有多个空行在一起时只输出一个空行<br> -E：在每行结尾增加$（？）<br> –help：显示帮助信息</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;openuler2&quot;&gt;&lt;a href=&quot;#openuler2&quot; class=&quot;headerlink&quot; title=&quot;openuler2&quot;&gt;&lt;/a&gt;openuler2&lt;/h1&gt;&lt;h2 id=&quot;常见文本编辑器&quot;&gt;&lt;a href=&quot;#常见文本编辑器&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/openeuler4/"/>
    <id>http://charles-webebr.github.io/2024/07/10/openeuler4/</id>
    <published>2024-07-10T07:22:46.123Z</published>
    <updated>2024-05-05T08:23:57.229Z</updated>
    
    <content type="html"><![CDATA[<h1 id="openeuler4"><a href="#openeuler4" class="headerlink" title="openeuler4"></a>openeuler4</h1><p>运维工具ansible学习</p><h2 id="ansible常见模块与操作"><a href="#ansible常见模块与操作" class="headerlink" title="ansible常见模块与操作"></a>ansible常见模块与操作</h2><p>一次性命令</p><h2 id="剧本playbook-yaml"><a href="#剧本playbook-yaml" class="headerlink" title="剧本playbook-yaml"></a>剧本playbook-yaml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">my</span> <span class="string">first</span> <span class="string">playbook</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">task:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">user</span> <span class="string">exists</span></span><br><span class="line">    <span class="attr">user:</span></span><br><span class="line">     <span class="attr">name:</span> <span class="string">demo</span></span><br><span class="line">     <span class="attr">uid:</span> <span class="number">2000</span></span><br><span class="line">     <span class="attr">group:</span> <span class="string">wheel</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">httpd</span></span><br><span class="line">    <span class="attr">yum:</span></span><br><span class="line">     <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">     <span class="attr">state:</span> <span class="string">lastest</span></span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config</span> <span class="string">repo</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">all</span></span><br><span class="line">    <span class="attr">task:</span>  </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">remove</span> <span class="string">repo</span> <span class="string">files</span></span><br><span class="line">      <span class="attr">file:</span> </span><br><span class="line">        <span class="attr">path:</span> <span class="string">adawdasdaw</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">absent</span> <span class="comment">#删除</span></span><br></pre></td></tr></table></figure><p>不会写找模板</p><h2 id="ansible定义变量"><a href="#ansible定义变量" class="headerlink" title="ansible定义变量"></a>ansible定义变量</h2><h3 id="在playbook中定义变量"><a href="#在playbook中定义变量" class="headerlink" title="在playbook中定义变量"></a>在playbook中定义变量</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">use</span> <span class="string">vars</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">vars:</span> </span><br><span class="line">    <span class="attr">name:</span> <span class="string">bob</span></span><br><span class="line">  <span class="attr">tasks:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">user</span> <span class="string">creat</span></span><br><span class="line">    <span class="attr">user:</span> </span><br><span class="line">      <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; name &#125;&#125;</span>&quot;</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">present</span></span><br></pre></td></tr></table></figure><h3 id="命令行中进行变量定义"><a href="#命令行中进行变量定义" class="headerlink" title="命令行中进行变量定义"></a>命令行中进行变量定义</h3><p>ansible-playbook -e name&#x3D;hary vars.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">manage</span> <span class="string">service</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">vars_files:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">openeuler.yml</span></span><br><span class="line">    </span><br><span class="line">  <span class="attr">tasks:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> &#123;&#123; <span class="string">pkg_name</span> &#125;&#125;</span><br><span class="line">    <span class="attr">yum:</span> </span><br><span class="line">      <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; pkg_name &#125;&#125;</span>&quot;</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">latest</span></span><br><span class="line">      </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">start</span> &#123;&#123;<span class="string">service_name</span> &#125;&#125;</span><br><span class="line">    <span class="attr">service:</span> </span><br><span class="line">      <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; service_name &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">yes</span></span><br><span class="line">            </span><br><span class="line">           </span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ansible-fact-变量"><a href="#ansible-fact-变量" class="headerlink" title="ansible fact 变量"></a>ansible fact 变量</h2><h2 id="ansible魔法变量"><a href="#ansible魔法变量" class="headerlink" title="ansible魔法变量"></a>ansible魔法变量</h2><h2 id="还有循环？"><a href="#还有循环？" class="headerlink" title="还有循环？"></a>还有循环？</h2><h2 id="条件任务语法"><a href="#条件任务语法" class="headerlink" title="条件任务语法"></a>条件任务语法</h2><p>使用when语法</p><h2 id="jinja2模板"><a href="#jinja2模板" class="headerlink" title="jinja2模板"></a>jinja2模板</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;openeuler4&quot;&gt;&lt;a href=&quot;#openeuler4&quot; class=&quot;headerlink&quot; title=&quot;openeuler4&quot;&gt;&lt;/a&gt;openeuler4&lt;/h1&gt;&lt;p&gt;运维工具ansible学习&lt;/p&gt;
&lt;h2 id=&quot;ansible常见模块与</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/openeuler3/"/>
    <id>http://charles-webebr.github.io/2024/07/10/openeuler3/</id>
    <published>2024-07-10T07:22:46.121Z</published>
    <updated>2024-04-22T13:28:19.590Z</updated>
    
    <content type="html"><![CDATA[<h1 id="openeuler3"><a href="#openeuler3" class="headerlink" title="openeuler3"></a>openeuler3</h1><h2 id="文件系统类型"><a href="#文件系统类型" class="headerlink" title="文件系统类型"></a>文件系统类型</h2><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421093549325.png" alt="image-20240421093549325"></p><p>openeuler默认使用ext4</p><h2 id="磁盘及接口"><a href="#磁盘及接口" class="headerlink" title="磁盘及接口"></a>磁盘及接口</h2><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421094202478.png" alt="image-20240421094202478"></p><p>lsblk显示磁盘信息</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421094652907.png" alt="image-20240421094652907"></p><h3 id="分盘操作"><a href="#分盘操作" class="headerlink" title="分盘操作"></a>分盘操作</h3><ol><li><p>lsblk查看磁盘信息</p></li><li><p>磁盘分区方案MBR（最小存储单元是扇区，大小512字节）</p></li></ol><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421095651715.png" alt="image-20240421095651715"></p><p>一个MBR只能存储4个分区盘，但是可以再指向一个新的MBR，逻辑分区加主分区为16个</p><h3 id="GPT"><a href="#GPT" class="headerlink" title="GPT"></a>GPT</h3><p>为了弥补MBR的磁盘空间不足（2tb），我们发明了GPT磁盘存储模式</p><h3 id="创建磁盘命令"><a href="#创建磁盘命令" class="headerlink" title="创建磁盘命令"></a>创建磁盘命令</h3><p>fdisk &#x2F;dev&#x2F;nvme0n1</p><p>输入n进行创建</p><p>输入p显示创建信息</p><p>partprobe&#x2F;&#x2F;刷新磁盘信息</p><p>挂载前要进行<strong>格式化</strong></p><p>格式化命令：mkfs -t ext4 &#x2F;dev&#x2F;nvm0n1p1</p><p>会生成一个UUID信息，每次格式化都会变化，用于挂载（挂载就是给磁盘这个房间加上一个门，属于映射关系）</p><p>临时挂载：mount &#x2F;dev&#x2F;nvm0np1p &#x2F;mnt</p><p>df -h查看挂载信息 </p><p>永久挂载：修改我们的&#x2F;etc&#x2F;fstab（乱改会把系统搞奔溃）</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421104710545.png" alt="image-20240421104710545"></p><p>推荐使用我们的uuid进行挂载，就是为了不把系统搞崩</p><p>挂载选项，也是在etc里面改</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421105824702.png" alt="image-20240421105824702"></p><p>逻辑分区只能在拓展分区的范围中创建</p><h2 id="怎么在线拓展我们的磁盘"><a href="#怎么在线拓展我们的磁盘" class="headerlink" title="怎么在线拓展我们的磁盘"></a>怎么<strong>在线拓展</strong>我们的磁盘</h2><p>使用lvm创建逻辑卷</p><p>将不同的空间映射成一个物理卷，然后再将物理卷加到一个组里面，然后再分为逻辑卷</p><ol><li><p>lsblk</p></li><li><p>分区</p></li><li><p>转换成物理卷（pvcreate pvdisplay pvmove pvck pvchange ）</p></li><li><p>创建成卷组（vgcreate data &#x2F;dev&#x2F;sdb1&#x2F;nvmen0n1p1     vgs      vgdisplay &#x2F;dev&#x2F;data     vgreduce data &#x2F;dev&#x2F;sdb1  vgextend ）</p></li><li><p>管理逻辑卷（lvcvrate -n lv1 -L 5G &#x2F;dev&#x2F;data  如果使用小-l 100就是100个最小逻辑单元pe-size）</p></li><li><p>格式化</p></li><li><p>挂载</p></li></ol><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421115303178.png" alt="image-20240421115303178"></p><h2 id="系统管理"><a href="#系统管理" class="headerlink" title="系统管理"></a>系统管理</h2><p>systemctl status atd</p><p>at-t 202405141314单次进行程序的执行时间 </p><h3 id="周期性进行"><a href="#周期性进行" class="headerlink" title="周期性进行"></a>周期性进行</h3><p>cronb命令</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421142254869.png" alt="image-20240421142254869"></p><p>例子：为了将某个程序在每天的0点执行一遍</p><p>*单个*号表示每1</p><p>*&#x2F;5表示每5</p><p>10-15表示10到15</p><p>10，15表示10号和15号</p><p>单个数字就表示时间</p><p>（5元组是吧）</p><p>可以使用网络上的计算器进行我们的计算</p><h2 id="网络管理"><a href="#网络管理" class="headerlink" title="网络管理"></a>网络管理</h2><p>ip address </p><ul><li><p>en-以太网口</p></li><li><p>en 表示Ethernet</p></li><li><p>wl 表示WLAN</p></li><li><p>ww 表示无线广域网WWAN</p></li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421151314195.png" alt="image-20240421151314195"></p><p>网卡配置文件etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421151800981.png" alt="image-20240421151800981"></p><p>网卡最小配置文件配置</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240421151856590.png" alt="image-20240421151856590"></p><p>不是哥们谁记这个啊</p><p>能补全的命令就是好命令</p><p>nmcilli connection reload</p><p>awdawd&amp;&amp;awdawda，前面命令执行成功后，后面的命令才能执行</p><p>单核cpu同一时间片只能进行一个流程，cpu按时间片来进行，切换时保存进程的状态，放进上下文中</p><p>进程优先级越小越好</p><h2 id="看看cpu使用率"><a href="#看看cpu使用率" class="headerlink" title="看看cpu使用率"></a>看看cpu使用率</h2><p>df -h</p><p>lsblk</p><h2 id="swap空间"><a href="#swap空间" class="headerlink" title="swap空间"></a>swap空间</h2><p>为防止空间占满后进程卡死使用虚拟缓存防止卡死</p><p>划分swap空间</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;openeuler3&quot;&gt;&lt;a href=&quot;#openeuler3&quot; class=&quot;headerlink&quot; title=&quot;openeuler3&quot;&gt;&lt;/a&gt;openeuler3&lt;/h1&gt;&lt;h2 id=&quot;文件系统类型&quot;&gt;&lt;a href=&quot;#文件系统类型&quot; class=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/openeuler1/"/>
    <id>http://charles-webebr.github.io/2024/07/10/openeuler1/</id>
    <published>2024-07-10T07:22:46.119Z</published>
    <updated>2024-04-22T13:39:14.223Z</updated>
    
    <content type="html"><![CDATA[<h1 id="openeuler1"><a href="#openeuler1" class="headerlink" title="openeuler1"></a>openeuler1</h1><p>安装配置不做记录，网上博客有</p><h2 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h2><h3 id="命令语法格式"><a href="#命令语法格式" class="headerlink" title="命令语法格式"></a>命令语法格式</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172007823.png" alt="image-20240330172007823">&lt;这个内容不可以省&gt;</p><h3 id="命令分类"><a href="#命令分类" class="headerlink" title="命令分类"></a>命令分类</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172141445.png" alt="image-20240330172141445"></p><h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><p>修改用户密码命令</p><h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><p>查看登录到系统的用户</p><h3 id="exit"><a href="#exit" class="headerlink" title="exit"></a>exit</h3><p>退出命令</p><h3 id="reboot"><a href="#reboot" class="headerlink" title="reboot"></a>reboot</h3><p>重启命令</p><h3 id="poweroff"><a href="#poweroff" class="headerlink" title="poweroff"></a>poweroff</h3><p>关机命令</p><h3 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h3><p>print working dir</p><p>打印当前工作目录</p><h3 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h3><p>改变当前的工作目录</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172802462.png" alt="image-20240330172802462"></p><h3 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h3><p>列出当前目录下的文件</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172840797.png" alt="image-20240330172840797">&#x2F;&#x2F;-t是按照文件的修改时间先后列出，图片有误</p><h3 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h3><p>创建文件夹</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330173025525.png" alt="image-20240330173025525"></p><p>-p选项是迭代创建目录</p><h3 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h3><ul><li>创建空文件</li><li>修改文件时间戳（<strong>access</strong> <strong>change</strong> <strong>modify</strong>）</li></ul><p><strong>modify是文件内容变换，change是文件属性变化，当Atime在Mtime和Ctime之前才会被修改</strong></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330173312612.png" alt="image-20240330173312612"></p><h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><p>复制文件</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330173345910.png" alt="image-20240330173345910"></p><h3 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h3><p>移动文件命令（当移动的目录不变时就是重命名操作）</p><h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><p>最刑的命令（rm -rf&#x2F;*）</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330173733120.png" alt="image-20240330173733120"></p><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><p>读取文件内容，将文件合并</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330173840578.png" alt="image-20240330173840578"></p><h3 id="head和tail"><a href="#head和tail" class="headerlink" title="head和tail"></a>head和tail</h3><p>head显示文件前多少行内容，tail显示尾部多少行内容</p><p>选项-n</p><h2 id="常见快捷键"><a href="#常见快捷键" class="headerlink" title="常见快捷键"></a>常见快捷键</h2><h3 id="tab"><a href="#tab" class="headerlink" title="tab"></a>tab</h3><p>可以双击tab键进行命令补齐，快速输入命令或者参数</p><h3 id="history"><a href="#history" class="headerlink" title="history"></a>history</h3><p>查看历史命令，可以用history n执行代码</p><h3 id="上下键"><a href="#上下键" class="headerlink" title="上下键"></a>上下键</h3><p>快速翻阅历史命令</p><h3 id="home和end"><a href="#home和end" class="headerlink" title="home和end"></a>home和end</h3><p>将光标快速移动到行首和行尾</p><h3 id="clear与ctrl-l"><a href="#clear与ctrl-l" class="headerlink" title="clear与ctrl +l"></a>clear与ctrl +l</h3><p>清屏</p><h2 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h2><ul><li><strong>linux下所有都是文件</strong></li><li>树型结构，“&#x2F;”为根目录</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172613773.png" alt="image-20240330172613773"></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172629494.png" alt="image-20240330172629494"></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240330172639188.png" alt="image-20240330172639188"></p><h2 id="较为复杂命令"><a href="#较为复杂命令" class="headerlink" title="较为复杂命令"></a>较为复杂命令</h2><h3 id="more"><a href="#more" class="headerlink" title="more"></a>more</h3><p>按一页一页的显示文件内容，方便我们阅读，space控制下一篇，b上一篇，q退出</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul><li>+n 从第n行开始显示</li><li>-n 定义屏幕大小为n行</li><li>+&#x2F;pattern 搜索字符串</li><li>-c 清屏</li></ul><h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>与more类似，但more会加载整个文件，less不会</p><h3 id="常见操作"><a href="#常见操作" class="headerlink" title="常见操作"></a>常见操作</h3><ul><li><p>&#x2F;字符串：向下搜索“字符串”的功能</p></li><li><p>？字符串：向上搜索‘’‘字符串’</p></li><li><p>q退出less</p></li><li><p>空格 滚动一页()</p></li><li><p>回车 滚动一行</p></li><li><p>[pagedown]： 向下翻动一页</p></li><li><p>[pageup]： 向上翻动一页</p></li></ul><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p>顾名思义就是找我们的文件</p><h4 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h4><ul><li>-name 按文件名查找文件</li><li>-perm 按照文件权限来查找文件 。</li><li>-user 按照文件属主来查找文件 。</li><li>-mtime -n +n 按照文件的更改时间来查找文件</li></ul><p>• 文件类型：<br>▫ d: 目录<br>▫ c: 字型装置文件<br>▫ b: 区块装置文件<br>▫ p: 具名贮列<br>▫ f: 一般文件<br>▫ l: 符号连</p><p>​</p><h3 id="locate"><a href="#locate" class="headerlink" title="locate"></a>locate</h3><p>快速查找文件系统中是否有指定的文件</p><p><strong>使用之前要进行安装</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install mlocate</span><br></pre></td></tr></table></figure><p> -e 将排除在寻找的范围之外。<br> -f 将特定的文件排除在外。<br> -r 使用正规运算式做查找条件。<br> -o 指定文件的名称。<br> -d 指定文件的路径</p><h3 id="which"><a href="#which" class="headerlink" title="which"></a>which</h3><p>which用于搜索命令是工作在哪个文件附录下，例如which ls</p><p>which 命令用于快速地确定外部命令的绝对路径。<br>• 查找范例：<br>▫ which ls 查找ls 命令的绝对路径<br>▫ which -a ls 如果多个目录中都有匹配的文件，则全部显示<br>▫ which cp mv rm 查找多个文件</p><h3 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h3><p>文件压缩与解压缩的命令</p><p> -d或–decompress或—-uncompress 解开压缩文件。<br> -f或–force 强行压缩文件，不理会文件名是否存在以及该文件是否为符号连接。<br> -l或–list 列出压缩文件的相关信息。<br> -r或–recursive 递归处理，将指定目录下的所有文件及子目录一并处理。<br> -v或–verbose 显示指令执行过程。</p><h3 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h3><p>将多个文件加装在同一个包中</p><h4 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h4><p>语法：tar [OPTION…] [FILE]<br> -c 建立新的压缩文件。<br> -x 从压缩的文件中提取文件。<br> -t 显示压缩文件的内容。<br> -z 支持gzip解压文件。<br> -j 支持bzip2解压文件。<br> -v 显示操作过程。</p><h4 id="常用用法："><a href="#常用用法：" class="headerlink" title="常用用法："></a>常用用法：</h4><p>▫ tar cf ball.tar dir1 把目录dir1 及其下所有内容打包<br>▫ tar tf ball.tar 列出包中的内容<br>▫ tar xf ball.tar 把包中的内容解到当前目录<br>▫ tar czf ball.tar.gz dir1 打包然后用gzip压缩<br>▫ tar cjf ball.tar.bz2 dir1 打包然后用bzip2压缩<br>▫ tar cJf ball.tar.xz dir1 打包然后用xz压缩<br>▫ tar xf ball.tar -C &#x2F;tmp 解到&#x2F;tmp 目录下（默认在当前目录）<br>▫ tar xvf ball.tar -v 显示过程</p><h3 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h3><ul><li>用于创建链接文件，(软链接)可以理解成win的桌面上的快捷方式</li><li>linux中有软链接和硬链接两种</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240422213136994.png" alt="image-20240422213136994"></p><p><strong>• ln的功能是为某一个文件在另外一个位置建立一个同步的链接.当我们需要在不同的目<br>录，用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，<br>我们只要在某个固定的目录，放上该文件，然后在 其它的目录下用ln命令链接（link）<br>它就可以，不必重复的占用磁盘空间。</strong></p><h4 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h4><p><strong>默认创建的是硬链接</strong></p><p>语法：ln [ -f | -n] [ -s ] SourceFile [ TargetFile ]<br> -b 删除，覆盖以前建立的链接。<br> -d 允许超级用户制作目录的硬链接。<br> -f 强制执行。<br> -i 交互模式，文件存在则提示用户是否覆盖。<br> -n 把符号链接视为一般目录。<br> -s 软链接(符号链接)</p><h3 id="man"><a href="#man" class="headerlink" title="man"></a>man</h3><p>what can i say!</p><p>类似于帮助手册</p><h3 id="help"><a href="#help" class="headerlink" title="help"></a>help</h3><p>命令打一半参数不会填怎么办？</p><p>快使用无敌的–help</p><p>ls –help</p><p>完</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;openeuler1&quot;&gt;&lt;a href=&quot;#openeuler1&quot; class=&quot;headerlink&quot; title=&quot;openeuler1&quot;&gt;&lt;/a&gt;openeuler1&lt;/h1&gt;&lt;p&gt;安装配置不做记录，网上博客有&lt;/p&gt;
&lt;h2 id=&quot;常见命令&quot;&gt;&lt;a hr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/ict%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%80%83%E6%A0%B8%E6%80%BB%E7%BB%93/"/>
    <id>http://charles-webebr.github.io/2024/07/10/ict%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%80%83%E6%A0%B8%E6%80%BB%E7%BB%93/</id>
    <published>2024-07-10T07:22:46.116Z</published>
    <updated>2024-04-13T06:25:14.118Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ict第一次考核总结"><a href="#ict第一次考核总结" class="headerlink" title="ict第一次考核总结"></a>ict第一次考核总结</h1><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231015232727394.png" alt="image-20231015232727394"></p><h3 id="MSTP配置"><a href="#MSTP配置" class="headerlink" title="MSTP配置"></a>MSTP配置</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231015234903319.png" alt="image-20231015234903319"></p><p>主要问题：</p><ol><li><p>在所有交换机下都要将vlan和实例进行一个绑定</p></li><li><p>再者就是判断根桥，虽然题目可能不会告诉你，但是你要自己判断，本题vlan100走sw1&#x2F;sw2-sw3-sw5，vlan200走sw1&#x2F;sw2-sw4-sw5，差别在于vlan 100只走sw3，所以sw3就是实例10的根桥一样的，vlan 200的sw4就是实例20的根桥</p></li><li><p>链路聚合开销为所有链路开销和的平均数</p></li><li><p>stp region-configuration</p></li><li><p>region-name mstp（改名）</p></li><li><p>revision-level 1（版本）</p></li><li><p>instance 10 vlan 100（vlan 绑定实例）</p></li><li><p>instance 20 vlan 200</p></li><li><p>active regionconfiguration（激活配置）</p></li><li><p>stp instance priority</p></li></ol><h3 id="根桥，根端口，指定端口，替代端口选举原则"><a href="#根桥，根端口，指定端口，替代端口选举原则" class="headerlink" title="根桥，根端口，指定端口，替代端口选举原则"></a>根桥，根端口，指定端口，替代端口选举原则</h3><h4 id="1-根桥的选举（树根）"><a href="#1-根桥的选举（树根）" class="headerlink" title="1.根桥的选举（树根）"></a>1.根桥的选举（树根）</h4><p>判断各个交换机的BID，BID&#x3D;优先级+MAC地址（优先级默认等于32768 ，范围0-65535 ，步长是4096）</p><p><strong>优先级低的成为根，如果优先级相同比较MAC地址，最低的为根。</strong></p><h4 id="2-根端口的选举（距离树根最近的端口，除根桥外，每个交换机都要有一个根端口，且只有一个）"><a href="#2-根端口的选举（距离树根最近的端口，除根桥外，每个交换机都要有一个根端口，且只有一个）" class="headerlink" title="2.根端口的选举（距离树根最近的端口，除根桥外，每个交换机都要有一个根端口，且只有一个）"></a>2.根端口的选举（距离树根最近的端口，除根桥外，每个交换机都要有一个根端口，且只有一个）</h4><p>若第一个相同则比较下一个，若不同则直接得出结论</p><h5 id="比较根路径开销（从根桥到交换机）"><a href="#比较根路径开销（从根桥到交换机）" class="headerlink" title="比较根路径开销（从根桥到交换机）"></a>比较根路径开销（从根桥到交换机）</h5><p>根路径开销低的为根端口 <img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/20210604234616184.png" alt="img"></p><p>GE端口开销是2万，E端口开销是20万</p><p><strong>从根桥出发到交换机的端口进去才是端口的根路径开销</strong></p><p>上图LSW1的GE0&#x2F;0&#x2F;4的根路径开销是2万；LSW1的GE0&#x2F;0&#x2F;1的根路径开销是4万</p><h5 id="比较上行设备BID"><a href="#比较上行设备BID" class="headerlink" title="比较上行设备BID"></a>比较上行设备BID</h5><p>BID&#x3D;优先级+MAC地址（优先级默认等于32768 ，范围0-65535 ，步长是4096）上行设备的优先级低的该端口成为根端口，如果上级设备优先级相同则比较上级设备的MAC地址，最低的该端口为根端口。</p><h5 id="比较上行设备PID"><a href="#比较上行设备PID" class="headerlink" title="比较上行设备PID"></a>比较上行设备PID</h5><p>PID&#x3D;端口优先级+端口标识（端口优先级默认等于128，端口优先级的范围0-255）端口标识是e0&#x2F;0&#x2F;1之类的号码（e0&#x2F;0&#x2F;1比e0&#x2F;0&#x2F;2的端口标识小），先比较端口优先级，低的入选，若端口优先级相同再比较端口标识，低的入选。</p><h4 id="指定端口的选举"><a href="#指定端口的选举" class="headerlink" title="*.指定端口的选举"></a><em><strong>*.指定端口的选举</strong></em></h4><p><em><strong>（每个主干链路上一定要选举一个指定端口，且只有一个，根端口不参与选举，根桥上的端口全为指定端口，）若第一个相同则比较下一个，若不同则直接得出结论*</strong></em></p><h5 id="比较根路径开销"><a href="#比较根路径开销" class="headerlink" title="比较根路径开销"></a>比较根路径开销</h5><h5 id="（从各自当前交换机的根端口到根桥）低的获选"><a href="#（从各自当前交换机的根端口到根桥）低的获选" class="headerlink" title="（从各自当前交换机的根端口到根桥）低的获选"></a>（从各自当前交换机的根端口到根桥）低的获选</h5><h5 id="比较各自本交换机的BID"><a href="#比较各自本交换机的BID" class="headerlink" title="比较各自本交换机的BID"></a>比较各自本交换机的BID</h5><h5 id="比较各自的本端口的PID"><a href="#比较各自的本端口的PID" class="headerlink" title="比较各自的本端口的PID"></a>比较各自的本端口的PID</h5><h4 id="备份端口"><a href="#备份端口" class="headerlink" title="*备份端口*"></a><em><strong>*备份端口*</strong></em></h4><p>既不是根端口也不是指定端口的端口</p><h4 id="端口的几种状态"><a href="#端口的几种状态" class="headerlink" title="端口的几种状态"></a>端口的几种状态</h4><ul><li>Discarding：端口既不转发用户流量也不学习MAC地址；（丢弃）</li><li>Learning：端口不转发用户流量但是学习MAC地址；</li><li>Forwarding：端口既转发用户流量又学习MAC地址。</li></ul><h3 id="DHCP配置"><a href="#DHCP配置" class="headerlink" title="DHCP配置"></a>DHCP配置</h3><p>当初就没用懂，导致实操寄了</p><h4 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h4><ol><li><p>打开dhcp</p></li><li><p>进入端口配置IP</p></li><li><p>通过静态路由或者动态路由使得服务器获得中继DHCP的ip地址（单条链路可以使用默认路由配置）</p></li><li><p>全局创建pool池</p></li><li><p>配置pool池</p></li><li><p>进入端口打开DHCP全局模式</p><p>栗子：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dhcp enable</span><br><span class="line">配IP</span><br><span class="line">ip pool vlan100//pool池创建</span><br><span class="line"> gateway-<span class="built_in">list</span> <span class="number">192.168</span><span class="number">.100</span><span class="number">.254</span> //网关</span><br><span class="line"> network <span class="number">192.168</span><span class="number">.100</span><span class="number">.0</span> mask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> //地址段</span><br><span class="line"> excluded-ip-address <span class="number">192.168</span><span class="number">.100</span><span class="number">.99</span> //保留地址</span><br><span class="line"> lease day <span class="number">0</span> hour <span class="number">3</span> minute <span class="number">0</span> //设置租期</span><br><span class="line"> dns-<span class="built_in">list</span> <span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span> //dns</span><br><span class="line"><span class="built_in">int</span> 端口</span><br><span class="line">DHCP select <span class="keyword">global</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="中继"><a href="#中继" class="headerlink" title="中继"></a>中继</h4><ol><li>打开dhcp</li><li>进入端口配置ip</li><li>选择端口dhcp select relay</li><li>绑定服务器IPdhcp relay server-ip XXXX</li></ol><p>栗子：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> 端口</span><br><span class="line">ip配置</span><br><span class="line">dhcp select relay</span><br><span class="line">dhcp relay server-ip XXXX</span><br></pre></td></tr></table></figure><h2 id="理论"><a href="#理论" class="headerlink" title="理论"></a>理论</h2><h3 id="私有地址"><a href="#私有地址" class="headerlink" title="私有地址"></a>私有地址</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019115628358.png" alt="image-20231019115628358"></p><p>A类：10.0.0.0到10.255.255.255是私有地址</p><p>B类：172.16.0.0到172.31.255.255是私有地址</p><p>C类：192.168.0.0到192.168.255.255是私有地址。</p><p><strong>注意看这里D是192.162.10.3不是192.168.10.3</strong></p><h3 id="广播地址"><a href="#广播地址" class="headerlink" title="广播地址"></a>广播地址</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019120106587.png" alt="image-20231019120106587"></p><p>将255.255.255.240展开可得1111 1111 1111 1111 1111 1111 1111 0000</p><p>将132.119.100.200展开可得132.119.100.1100 1000，将最后得1000替换成1111，得到11001111&#x3D;207</p><h3 id="DHCP中继和DHCP服务器之间交互的报文为？"><a href="#DHCP中继和DHCP服务器之间交互的报文为？" class="headerlink" title="DHCP中继和DHCP服务器之间交互的报文为？"></a>DHCP中继和DHCP服务器之间交互的报文为？</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019121228700.png" alt="image-20231019121228700"></p><p>抓个包发现使用的是unicast报文</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019121442316.png" alt="image-20231019121442316"></p><p>1.单播（unicast）：网络节点之间的通信就好像是人们之间的对话一样。如果一个人对另外一个人说话，那么用网络技术的术语来描述就是“单播”，此时信息的接收和传递只在两个节点之间进行。单播在网络中得到了广泛的应用，网络上绝大部分的数据都是以单播的形式传输的，只是一般网络用户不知道而已。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、Web服务器建立连接<strong>，此时使用的就是单播数据传输方式。但是通常使用“点对点通信”（Point to Point）代替“单播”</strong>，因为“单播”一般与“多播”和“广播”相对应使用。</p><p>2.多播（multicast）：“<strong>多播”也可以称为“组播”</strong>，在网络技术的应用并不是很多，<strong>网上视频会议、网上视频点播特别适合采用多播方式</strong>。因为如果采用单播方式，逐个节点传输，有多少个目标节点，就会有多少次传送过程，这种方式显然效率极低，是不可取的；如果采用不区分目标、全部发送的广播方式，虽然一次可以传送完数据，但是显然达不到区分特定数据接收对象的目的。采用多播方式，既可以实现一次传送所有目标节点的数据，也可以达到只对特定对象传送数据的目的。 　　<strong>IP网络的多播一般通过多播IP地址来实现。多播IP地址就是D类IP地址，即224.0.0.0至239.255.255.255之间的IP地址。Windows 2000中的DHCP管理器支持多播IP地址的自动分配。</strong> </p><p>3.广播（broadcast）：“广播”在网络中的应用较多，<strong>如客户机通过DHCP自动获得IP地址的过程就是通过广播来实现的</strong>。但是同单播和多播相比，广播几乎占用了子网内网络的所有带宽。拿开会打一个比方吧，在会场上只能有一个人发言，想象一下如果所有的人同时都用麦克风发言，那会场上就会乱成一锅粥。集线器由于其工作原理决定了不可能过滤广播风暴，一般的交换机也没有这一功能，不过现在有的网络交换机（如全向的QS系列交换机）也有过滤广播风暴功能了，路由器本身就有隔离广播风暴的作用。 　　广播风暴不能完全杜绝，但是只能在同一子网内传播，就好像喇叭的声音只能在同一会场内传播一样，因此在由几百台甚至上千台电脑构成的大中型局域网中，一般进行子网划分，就像将一个大厅用墙壁隔离成许多小厅一样，以达到隔离广播风暴的目的。 　　在IP网络中，广播地址用IP地址“255.255.255.255”来表示，这个IP地址代表同一子网内所有的IP地址。</p><ol start="4"><li>任播：Anycast 是一种为一组端点提供多个路由路径的技术，<strong>每个端点都分配有相同的 IP 地址</strong>。 组中的每个设备在网络上通告相同的地址，路由协议用于选择最佳目的地。<strong>Anycast 主要可以用于扩展无状态服务，例如 DNS 或 HTTP，方法是将多个节点放在同一 IP 地址后面，并使用等价多路径 (ECMP) 路由来引导这些节点之间的流量。</strong> 任播与单播不同，单播中每个端点都有自己独立的 IP 地址。</li></ol><h3 id="osi七层模型及其功能"><a href="#osi七层模型及其功能" class="headerlink" title="osi七层模型及其功能"></a>osi七层模型及其功能</h3><p>物理层-数据链路层-网络层-传输层-会话层-表达层-应用层</p><h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><h5 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h5><p><strong>规定通信设备的机械的、电气的、功能的和过程的特性，用以建立、维护和拆除物理链路连接</strong>。具体地讲，机械 特性规定了网络连接时所需接插件的规格尺寸、引脚数量和排列情况等;电气特性规定了在物理连接上传输bit流时线路上信号电平的大小、阻抗匹配、传输速率 距离限制等;功能特性是指对各个信号先分配确切的信号含义，即定义了DTE和DCE之间各个线路的功能;规程特性定义了利用信号线进行bit流传输的一组 操作规程，是指在物理连接的建立、维护、交换信息是，DTE和DCE双放在各电路上的动作系列。在这一层，数据的单位称为比特(bit)。属于物理层定义的典型规范代表包括：EIA&#x2F;TIA RS-232、EIA&#x2F;TIA RS-449、V.35、RJ-45等。</p><h5 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h5><p>在物理层提供比特流服务的基础上<strong>，建立相邻结点之间的数据链路，通过差错控制提供数据帧(Frame)在信道上无差错的传输，并进行各电路上的动作系列</strong>。数据链路层在不可靠的物理介质上提供可靠的传输。该层的作用包括：物理地址寻址、数据的成帧、流量控制、数据的检错、重发等。在这一层，数据的单位称为帧(frame)。数据链路层协议的代表包括：SDLC、HDLC、PPP、STP、帧中继等。</p><h5 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h5><p>在 计算机网络中进行通信的两个计算机之间可能会经过很多个数据链路，也可能还要经过很多通信子网。<strong>网络层的任务就是选择合适的网间路由和交换结点， 确保数据及时传送</strong>。网络层将数据链路层提供的帧组成数据包，包中封装有网络层包头，其中含有逻辑地址信息- -源站点和目的站点地址的网络地址。如 果你在谈论一个IP地址，那么你是在处理第3层的问题，这是“数据包”问题，而不是第2层的“帧”。IP是第3层问题的一部分，此外还有一些路由协议和地 址解析协议(ARP)。有关路由的一切事情都在这第3层处理。地址解析和路由是3层的重要目的。网络层还可以实现拥塞控制、网际互连等功能。在这一层，数据的单位称为数据包(packet)。网络层协议的代表包括：IP、IPX、RIP、OSPF等。</p><h5 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h5><p>第4层的数据单元也称作数据包(packets)。但是，当你谈论TCP等具体的协议时又有特殊的叫法，TCP的数据单元称为段 (segments)而UDP协议的数据单元称为“数据报(datagrams)”。这<strong>个层负责获取全部信息，因此，它必须跟踪数据单元碎片、乱序到达的 数据包和其它在传输过程中可能发生的危险</strong>。第4层为上层提供端到端(最终用户到最终用户)的透明的、可靠的数据传输服务。所为透明的传输是指在通信过程中 传输层对上层屏蔽了通信传输系统的具体细节。传输层协议的代表包括：TCP、UDP、SPX等。</p><h5 id="会话层"><a href="#会话层" class="headerlink" title="会话层"></a>会话层</h5><p>这一层也可以称为会晤层或对话层，在会话层及以上的高层次中，数据传送的单位不再另外命名，而是统称为报文。<strong>会话层不参与具体的传输，它提供包括访问验证和会话管理在内的建立和维护应用之间通信的机制。</strong><u>如服务器验证用户登录便是由会话层完成的</u></p><h5 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h5><p>它主要负责<strong>数据的格式化、编码、加密解密以及压缩解压缩</strong>等处理，以确<strong>保数据在不同系统之间的可靠传输和正确解析。</strong></p><h5 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h5><p><strong>应用层为操作系统或网络应用程序提供访问网络服务的接口。应用层协议的代表包括：Telnet、FTP、HTTP、SNMP等。</strong></p><h4 id="各层用到的协议"><a href="#各层用到的协议" class="headerlink" title="各层用到的协议"></a>各层用到的协议</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/v2-363018760274c3fc551392010f8f3187_1440w.webp" alt="img"></p><h3 id="交换机路由表学习"><a href="#交换机路由表学习" class="headerlink" title="交换机路由表学习"></a>交换机路由表学习</h3><p>交换机收到一个帧会记录相应的mac地址和接口，vlan id 应该是不会修改或者分配的</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019124501220.png" alt="image-20231019124501220"></p><h3 id="DHCP的工作模式和端口号"><a href="#DHCP的工作模式和端口号" class="headerlink" title="DHCP的工作模式和端口号"></a>DHCP的工作模式和端口号</h3><p><strong>工作模式是UDP，服务器端口号为67，客户端的端口号为68</strong></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20231019124804462.png" alt="image-20231019124804462"></p><p>（false）</p><h3 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019125228430.png" alt="image-20231019125228430"></p><p>不是点分而是冒号16进制</p><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019125316193.png" alt="image-20231019125316193"></p><p><strong>默认端口号是23号</strong></p><h3 id="IGP（内部网关协议）和EDP（外部网关协议）"><a href="#IGP（内部网关协议）和EDP（外部网关协议）" class="headerlink" title="IGP（内部网关协议）和EDP（外部网关协议）"></a>IGP（内部网关协议）和EDP（外部网关协议）</h3><p>IGP：RIP，OSPF，ISIS</p><p>EDP：BGP</p><h3 id="链路聚合"><a href="#链路聚合" class="headerlink" title="链路聚合"></a>链路聚合</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019131130197.png" alt="image-20231019131130197"></p><h4 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h4><p>手工分担，LACP（自动）</p><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>实现增加链路的带宽，提高可靠性，实现负载分担</p><p>DHCP报文（主机—服务器）</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019132115252.png" alt="image-20231019132115252"></p><p>实验抓包发现真是这样</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019132057721.png" alt="image-20231019132057721"></p><p>ip分配过程</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231019132301021.png" alt="image-20231019132301021"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ict第一次考核总结&quot;&gt;&lt;a href=&quot;#ict第一次考核总结&quot; class=&quot;headerlink&quot; title=&quot;ict第一次考核总结&quot;&gt;&lt;/a&gt;ict第一次考核总结&lt;/h1&gt;&lt;h2 id=&quot;实验&quot;&gt;&lt;a href=&quot;#实验&quot; class=&quot;headerli</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/2023017-%E5%BC%A0%E5%81%A5-%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%AC%94%E8%AE%B0/"/>
    <id>http://charles-webebr.github.io/2024/07/10/2023017-%E5%BC%A0%E5%81%A5-%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%AC%94%E8%AE%B0/</id>
    <published>2024-07-10T07:22:46.114Z</published>
    <updated>2023-09-17T07:55:29.950Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第一节：概述"><a href="#第一节：概述" class="headerlink" title="第一节：概述"></a><strong>第一节：概述</strong></h1><h2 id="1-1-计算机网络在信息时代的作用"><a href="#1-1-计算机网络在信息时代的作用" class="headerlink" title="1.1 计算机网络在信息时代的作用"></a>1.1 计算机网络在信息时代的作用</h2><h3 id="1-1-1-定义"><a href="#1-1-1-定义" class="headerlink" title="1.1.1 定义"></a>1.1.1 定义</h3><p>Internet是全球最大的，最重要的计算机网络，是计算机网络的一部分</p><h3 id="1-1-2特点"><a href="#1-1-2特点" class="headerlink" title="1.1.2特点"></a>1.1.2特点</h3><p>1.连通性（connectivity）2.资源共享（sharing）</p><p><img src="/.io//image-20230716125923545.png" alt="image-20230716125923545"></p><h2 id="1-2-互联网概述"><a href="#1-2-互联网概述" class="headerlink" title="1.2 互联网概述"></a>1.2 互联网概述</h2><h3 id="1-2-1-网络的网络"><a href="#1-2-1-网络的网络" class="headerlink" title="1.2.1 网络的网络"></a>1.2.1 网络的网络</h3><p>网络&#x3D;节点（node）+链路（link）</p><p>链路有点抽象</p><p><img src="/.io//image-20230716131517681.png" alt="image-20230716131517681"></p><p>多个网络——》路由器连接——》更大的网络——》网络的网络——》互连网</p><p>更多的互连网覆盖全球连接成互联网</p><p><img src="/.io//image-20230716131956839.png" alt="image-20230716131956839"></p><h3 id="1-2-2-互联网基础结构发展的三个阶段"><a href="#1-2-2-互联网基础结构发展的三个阶段" class="headerlink" title="1.2.2 互联网基础结构发展的三个阶段"></a>1.2.2 互联网基础结构发展的三个阶段</h3><p>第一阶段（1965–1990）：1983年作为互联网的诞生时间，TCP&#x2F;IP协议成为APPANET的标准协议</p><p>第二阶段（1985–1993）：三级结构：主干网，地区网，校园网或者企业网</p><p>第三阶段（1993–至今）： 多层isp结构：主干isp，地区isp，本地isp</p><p>isp就是卖卡的运营商:smile:&#x2F;&#x2F;</p><p>（isp ix：互联网交换点）</p><p><img src="/.io//image-20230716132040781.png" alt="image-20230716132040781"></p><p>cp就是b站这种</p><p><img src="/.io//image-20230716133419473.png" alt="image-20230716133419473"></p><p>*一些历史</p><p><img src="/.io//image-20230716133634489.png" alt="image-20230716133634489"></p><h3 id="1-2-3-互联网的标准化工作"><a href="#1-2-3-互联网的标准化工作" class="headerlink" title="1.2.3 互联网的标准化工作"></a>1.2.3 互联网的标准化工作</h3><p>管理金字塔：<img src="/.io//image-20230716133852203.png" alt="image-20230716133852203"></p><p>发表格式：<img src="/.io//image-20230716133959590.png" alt="image-20230716133959590"></p><p>标准化过程：<img src="/.io//image-20230716134141548.png" alt="image-20230716134141548"></p><h2 id="1-3-互联网的组成"><a href="#1-3-互联网的组成" class="headerlink" title="1.3 互联网的组成"></a>1.3 互联网的组成</h2><h3 id="1-3-1互联网的边缘部分"><a href="#1-3-1互联网的边缘部分" class="headerlink" title="1.3.1互联网的边缘部分"></a>1.3.1互联网的边缘部分</h3><p>工作方式分：</p><p><img src="/.io//image-20230716180923056.png" alt="image-20230716180923056"></p><p>核心（服务</p><p>边缘:终端系统，例如你的手机，电脑，是网络的尽头,不负责转发</p><h4 id="计算机之间的通信："><a href="#计算机之间的通信：" class="headerlink" title="计算机之间的通信："></a>计算机之间的通信：</h4><p>主机a的某个进程与主机b的某个进程进行通信</p><h4 id="通信方式："><a href="#通信方式：" class="headerlink" title="通信方式："></a>通信方式：</h4><p>1.客户-服务器方式（c&#x2F;s方式）</p><p><img src="/.io//image-20230716182252086.png" alt="image-20230716182252086"></p><p>客户主动，服务被动，通信是双向的</p><p>特点：<img src="/.io//image-20230716182549951.png" alt="image-20230716182549951"></p><p>2.对等连接方式（p2p方式–cs升级版）</p><p><img src="/.io//image-20230716193447000.png" alt="image-20230716193447000"></p><p>既能请求又能提供服务，平等对等通信</p><h3 id="1-3-2-互联网的核心部分"><a href="#1-3-2-互联网的核心部分" class="headerlink" title="1.3.2*互联网的核心部分"></a>1.3.2*互联网的核心部分</h3><ul><li><p>复杂部分</p></li><li><p>连接边缘的主机</p><p>路由器（router）–&gt;实现分组交换的关键构件</p></li></ul><h4 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h4><h5 id="三个阶段："><a href="#三个阶段：" class="headerlink" title="三个阶段："></a>三个阶段：</h5><ul><li>建立连接：占用通信资源</li><li>通话：一直占用通信资源</li><li>连接释放：归还通信资源</li></ul><p>！！！要一直占用才算电路交换</p><h5 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h5><ol><li>通信时延小。因为通信线路为通信双方用户专用，数据直达，因此通信时延非常小，当<strong>连续传输大量数据</strong>时，这一优点非常明显。</li><li><strong>有序传输</strong>。因为通信双方之间只有一条专用的通信线路，数据只在这一条线路上传输，因此不存在失序问题。</li></ol><h5 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h5><p>1.<strong>建立连接时间长</strong>。电路交换的平均连接建立时间对计算机通信来说太长。</p><p>2.线路独占，使用<strong>效率低</strong>。电路交换一旦建立连接，物理通路就被通信双方独占，即使通信线路空闲，也不能够供其他用户使用，因而信道利用率很低。 </p><p>3.<strong>灵活性差</strong>。只要连接所建立的物理通路中的任何一点出现了故障，就必须重新拨号建立新的连接，这对十分紧急和重要的通信是很不利的。</p><p>4.难以规格化。电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信，也难以在通信中进行差错控制。</p><h4 id="分组交换："><a href="#分组交换：" class="headerlink" title="分组交换："></a>分组交换：</h4><h5 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h5><ul><li>采用储存转发技术</li></ul><p><img src="/.io//image-20230716200204320.png" alt="image-20230716200204320"></p><h5 id="工作方式"><a href="#工作方式" class="headerlink" title="工作方式"></a>工作方式</h5><p><img src="/.io//image-20230716201153174.png" alt="image-20230716201153174"></p><ul><li>数据段前面添加首部就构成了分组（packet）</li></ul><p><img src="/.io//image-20230716200136812.png" alt="image-20230716200136812"></p><p>这个部分的不同称呼）））</p><p>物理层数据包: 比特流 (bit stream)<br>链路层数据包:帧 (frame)<br>网络层数据包: IP 数据报或分组 (packet)<br>运输层数据包: TCP 报文段 (segment) 或<br>UDP 用户数据报 (datagram)<br>应用层数据包: 报文 (message)</p><p>*首部由不同的协议决定</p><ul><li><p>接收到后去掉首部并且还原</p></li><li><p>每个分组独立选择传输路径</p></li></ul><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><p><img src="/.io//image-20230716201920058.png" alt="image-20230716201920058"></p><p>高效、灵活、迅速、可靠</p><h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><p><img src="/.io//image-20230716202046591.png" alt="image-20230716202046591"></p><p>排队、带宽不确定、开销大</p><p>10个字节利用率为百分之90</p><h4 id="报文交换："><a href="#报文交换：" class="headerlink" title="报文交换："></a>报文交换：</h4><h5 id="优点：-1"><a href="#优点：-1" class="headerlink" title="优点："></a>优点：</h5><ol><li><strong>无需建立连接</strong>。报文交换不需要为通信双方预先建立一条专用的通信线路，不存在建立连接的时延，用户可以随时发送报文。</li><li><strong>动态分配线路</strong>。当发送方把报文传送给节点交换机时，节点交换机先存储整个报文，然后选择一条合适的空闲线路，将报文发送出去。</li><li><strong>可靠性。</strong>如果某条传输路径发送故障，会重新选择另一条路径传输数据，因此提高了传输的可靠性。</li><li><strong>提高线路利用率</strong>。通信双方不是固定占用一条通信线路，而是在不同的时间分段部分占用物理线路，因而大大提高了通信线路的利用率。</li></ol><h5 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h5><ol><li>引起了转发<strong>时延</strong>。这是因为报文在节点交换机上要<em>经历存储转发的过程</em>。</li><li>需要较大的存储缓存空间。这是因为报文交换<strong>对报文的大小没有限制</strong>。</li><li>需要传输额外的信息量。这是因为报文<strong>需要携带目的地址、源地址等信息。</strong></li></ol><p><img src="/.io//image-20230716202236271.png" alt="image-20230716202236271"></p><p>直观体现分组交换的便利快捷</p><p><img src="/.io//image-20230716202442974.png" alt="image-20230716202442974"></p><h2 id="1-4计算机在我国的发展"><a href="#1-4计算机在我国的发展" class="headerlink" title="1.4计算机在我国的发展"></a>1.4计算机在我国的发展</h2><p>*一些历史</p><p><img src="/.io//image-20230717101308796.png" alt="image-20230717101308796"></p><p>cn规模最大的五个计算机网络</p><p><img src="/.io//image-20230717101458456.png" alt="image-20230717101458456"></p><h2 id="1-5-计算机网络的类别"><a href="#1-5-计算机网络的类别" class="headerlink" title="1.5 计算机网络的类别"></a>1.5 计算机网络的类别</h2><h3 id="1-5-1-计算机网络的定义"><a href="#1-5-1-计算机网络的定义" class="headerlink" title="1.5.1 计算机网络的定义"></a>1.5.1 计算机网络的定义</h3><p>未统一定义，有通俗定义（怎么连接？怎么管理？怎么共享？）</p><p><img src="/.io//image-20230717103507953.png" alt="image-20230717103507953"></p><h3 id="1-5-2-几种不同类别的计算机网络"><a href="#1-5-2-几种不同类别的计算机网络" class="headerlink" title="1.5.2 几种不同类别的计算机网络"></a>1.5.2 几种不同类别的计算机网络</h3><ul><li>按作用范围分</li></ul><p><img src="/.io//image-20230717103752857.png" alt="image-20230717103752857"></p><ul><li>按使用者分</li></ul><p>公用网（public）和专用网(private)</p><ul><li>接入网</li></ul><p><img src="/.io//image-20230717104426936.png" alt="image-20230717104426936"></p><h2 id="1-6-计算机网络的性能"><a href="#1-6-计算机网络的性能" class="headerlink" title="1.6*计算机网络的性能"></a>1.6*计算机网络的性能</h2><h3 id="1-6-1-计算机网络的性能指标"><a href="#1-6-1-计算机网络的性能指标" class="headerlink" title="1.6.1* 计算机网络的性能指标"></a>1.6.1* 计算机网络的性能指标</h3><h4 id="1-速率（香农）"><a href="#1-速率（香农）" class="headerlink" title="1.速率（香农）"></a>1.速率（香农）</h4><ul><li>比特是成为信息的基本单位</li><li>速率指的是数据的传送速率，称为数据率或者比特率</li><li>单位：bit&#x2F;s  kbit&#x2F;s  Mbit&#x2F;s  Gbit&#x2F;s（速率的换算为10的三次方，数据量的换算为2的10次方）</li><li>为理想状态额定功率</li></ul><h4 id="2-带宽（bandwidth）"><a href="#2-带宽（bandwidth）" class="headerlink" title="2.带宽（bandwidth）"></a>2.带宽（bandwidth）</h4><p>频域与时域（？）</p><p><img src="/.io//image-20230725171202338.png" alt="image-20230725171202338"></p><p>下载速度用字节表示，带宽用比特表示</p><p>指网络系统的通信<strong>链路</strong>（与信道或者传输媒体同意）传输数据的能力，即表征单位时间内从网络中的某一点到另一点所能通过的”<strong>最高数据率</strong>“。单位是bit&#x2F;s</p><h4 id="3-吞吐量（略）"><a href="#3-吞吐量（略）" class="headerlink" title="3.吞吐量（略）"></a>3.吞吐量（略）</h4><p><img src="/.io//image-20230725172027073.png" alt="image-20230725172027073"></p><p><img src="/.io//image-20230725172045324.png" alt="image-20230725172045324"></p><p>吞吐量降低会感觉到时延</p><h4 id="4-时延（delay）"><a href="#4-时延（delay）" class="headerlink" title="4.时延（delay）"></a>4.时延（delay）</h4><h5 id="1-发送时延（终端）"><a href="#1-发送时延（终端）" class="headerlink" title="1.发送时延（终端）"></a>1.发送时延（终端）</h5><p>*数据从电脑等发送到网络上，与数据量和带宽有关(带宽提高发送时延降低)</p><p><img src="/.io//image-20230725175506604.png" alt="image-20230725175506604"></p><p>公式：<br>$$<br>发送时延&#x3D;数据帧长度(bit)&#x2F;发送速率(bit&#x2F;s)<br>$$<br>发射时延与传输距离没有关系</p><h5 id="2-传播时延（线路）"><a href="#2-传播时延（线路）" class="headerlink" title="2.传播时延（线路）"></a>2.传播时延（线路）</h5><p><img src="/.io//image-20230725175843073.png" alt="image-20230725175843073"></p><p>传播时延与传播距离有关，与发送速率无关，因为一般来说速率是固定的</p><h5 id="3-处理时延和排队时延（路由器）"><a href="#3-处理时延和排队时延（路由器）" class="headerlink" title="3.处理时延和排队时延（路由器）"></a>3.处理时延和排队时延（路由器）</h5><p>*排队时延和处理时延是息息相关的</p><p>*当排队时延无限大时，数据会爆，这是很糟糕的情况</p><p>*处理时延是主机或路由器处理分组花的时间</p><p>*排队时延是排队等待处理的时间花费</p><h5 id="4-时延带宽积"><a href="#4-时延带宽积" class="headerlink" title="4.时延带宽积"></a>4.时延带宽积</h5><p><img src="/.io//image-20230725181859712.png" alt="image-20230725181859712"></p><p>带宽是线路的横截面积，时延是长度，单位是比特，表示数据栈排满能装多少数据 （发了，但对方还没接收到的数据量）</p><h5 id="总时延"><a href="#总时延" class="headerlink" title="总时延"></a>总时延</h5><p>总时延&#x3D;发送时延+传播时延+排队时延+处理时延</p><p><img src="/.io//image-20230725181042881.png" alt="image-20230725181042881"></p><h4 id="5-往返时间RTT（round-trip-time）"><a href="#5-往返时间RTT（round-trip-time）" class="headerlink" title="5.往返时间RTT（round-trip time）"></a>5.往返时间RTT（round-trip time）</h4><p>从发送完数据到确认接收完数据的时间</p><p>（传输时延+处理时延+返回时延）</p><p><img src="/.io//image-20230725195443604.png" alt="image-20230725195443604"></p><p>相关公式：<br>$$<br>有效数据率&#x3D;数据长度&#x2F;(发送时间+RTT)&#x3D;数据长度&#x2F;总时延<br>$$</p><h4 id="6-利用率"><a href="#6-利用率" class="headerlink" title="6.利用率"></a>6.利用率</h4><p><img src="/.io//image-20230725200730902.png" alt="image-20230725200730902"></p><p>利用率指的是有多少信道正在被利用</p><p>时延带宽积是指完全使用时有多少空位可以让数据等待</p><ul><li>利用率越大时延越大，不是越大越好，需要一定的容错（一般在30-50%，超过70%认为拥挤）</li></ul><h3 id="1-6-2计算机网络的非性能特征"><a href="#1-6-2计算机网络的非性能特征" class="headerlink" title="1.6.2计算机网络的非性能特征"></a>1.6.2计算机网络的非性能特征</h3><p><img src="/.io//image-20230725202926390.png" alt="image-20230725202926390"></p><h2 id="1-7-计算机的体系结构"><a href="#1-7-计算机的体系结构" class="headerlink" title="1.7*计算机的体系结构"></a>1.7*计算机的体系结构</h2><h4 id="1-7-1计算机网络体系结构的形成"><a href="#1-7-1计算机网络体系结构的形成" class="headerlink" title="1.7.1计算机网络体系结构的形成"></a>1.7.1计算机网络体系结构的形成</h4><p>*因为差别多需要统一的结构便于沟通</p><p>*将大问题通过分层变成若干个小问题</p><p>1983年ISO 7498标准</p><p><strong>OSI</strong></p><p><img src="/.io//image-20230725204046783.png" alt="image-20230725204046783"></p><h4 id="1-7-2协议与划分层次"><a href="#1-7-2协议与划分层次" class="headerlink" title="1.7.2协议与划分层次"></a>1.7.2协议与划分层次</h4><p><img src="/.io//image-20230725204220292.png" alt="image-20230725204220292"></p><p>工作分层，设定规则</p><h5 id="协议（语法、语义、同步-x2F-时序）"><a href="#协议（语法、语义、同步-x2F-时序）" class="headerlink" title="协议（语法、语义、同步&#x2F;时序）"></a>协议（语法、语义、同步&#x2F;时序）</h5><p><img src="/.io//image-20230725204325136.png" alt="image-20230725204325136"></p><p>协议分为文字描述和代码描述</p><h5 id="划分层次（理解不能）"><a href="#划分层次（理解不能）" class="headerlink" title="划分层次（理解不能）"></a>划分层次（理解不能）</h5><h6 id="分层要求"><a href="#分层要求" class="headerlink" title="分层要求"></a>分层要求</h6><ul><li>层次适度</li><li>功能确定</li><li>层次独立</li><li>层次关联</li><li>层次对等</li><li>层次协议</li><li>层次接口</li></ul><h6 id="层次功能"><a href="#层次功能" class="headerlink" title="层次功能"></a>层次功能</h6><ul><li>差错控制</li><li>流量控制</li><li>分段和重装</li><li>复用和分用</li><li>逻辑连接的建立和释放</li></ul><h4 id="1-7-3具有五层协议的体系结构"><a href="#1-7-3具有五层协议的体系结构" class="headerlink" title="1.7.3具有五层协议的体系结构"></a>1.7.3具有五层协议的体系结构</h4><p>osi<strong>不适合市场</strong>因此被淘汰了，取而代之的是由市场选择的<strong>事实上的国际标准</strong>（TCP&#x2F;IP），分为应用层、运输层、互联网层、网络接口层</p><p><img src="/.io//image-20230725210708216.png" alt="image-20230725210708216"></p><p>缺点</p><p><img src="/.io//image-20230725211115327.png" alt="image-20230725211115327"></p><p>实际教学为5层结构</p><p><img src="/.io//image-20230725211349577.png" alt="image-20230725211349577"></p><p>先大体过一下每个层次的功能</p><ul><li>应用层</li></ul><p>用户之间</p><p><img src="/.io//image-20230725211621386.png" alt="image-20230725211621386"></p><ul><li>运输层(TCP&#x2F;UDP)</li></ul><p>进程之间</p><p><img src="/.io//image-20230725211705488.png" alt="image-20230725211705488"></p><ul><li>网络层（IP）</li></ul><p>主机之间</p><p><img src="/.io//image-20230725211812661.png" alt="image-20230725211812661"></p><ul><li>数据链路层</li></ul><p>相邻节点之间</p><p><img src="/.io//image-20230725212835168.png" alt="image-20230725212835168"></p><ul><li><p>物理层</p><p>传比特<img src="/.io//image-20230725213023391.png" alt="image-20230725213023391"></p></li></ul><p>通信示例：<img src="/.io//image-20230725213651601.png" alt="image-20230725213651601"></p><p>（路由器也有应用层这些，但实际应用不使用）</p><h4 id="1-7-4实体、协议、服务和服务访问点"><a href="#1-7-4实体、协议、服务和服务访问点" class="headerlink" title="1.7.4实体、协议、服务和服务访问点"></a>1.7.4实体、协议、服务和服务访问点</h4><p><img src="/.io//image-20230725213905325.png" alt="image-20230725213905325"></p><p> *协议沟通同一层次的实体，对上层透明</p><p>*服务访问点用于相邻两层的实体进行交换信息，本质上是一个逻辑接口</p><p>*服务是垂直的</p><p>*<strong>上层以为他们直接靠协议进行通信，实际上是上层在使用下层的服务，下层对上层来说是透明的</strong></p><h4 id="1-7-5-TCP-x2F-IP的体系结构（实际）"><a href="#1-7-5-TCP-x2F-IP的体系结构（实际）" class="headerlink" title="1.7.5 TCP&#x2F;IP的体系结构（实际）"></a>1.7.5 TCP&#x2F;IP的体系结构（实际）</h4><p><img src="/.io//image-20230725215853688.png" alt="image-20230725215853688"></p><p><img src="/.io//image-20230725215920283.png" alt="image-20230725215920283">核心部分越简单越好</p><h4 id="体系结构对比"><a href="#体系结构对比" class="headerlink" title="体系结构对比"></a>体系结构对比</h4><p><img src="/.io//image-20230802235901147.png" alt="image-20230802235901147"></p><h1 id="第二节：物理层"><a href="#第二节：物理层" class="headerlink" title="第二节：物理层"></a>第二节：物理层</h1><h2 id="2-1-物理层的基本概念"><a href="#2-1-物理层的基本概念" class="headerlink" title="2.1 物理层的基本概念"></a>2.1 物理层的基本概念</h2><ul><li>位置：网络体系结构的最底层（不是具体的传输媒体，也不是连接计算机的具体物理设备</li><li>功能：<img src="/.io//image-20230726202057797.png" alt="image-20230726202057797"></li></ul><p>接收，编码，传输</p><ul><li><p>作用：屏蔽掉不同传输媒体和通信手段的差异（将同一句话说给不同的人）</p></li><li><p>主要任务：确定与传输媒体的接口有关的一些特性</p></li><li><p>物理层协议是DTE和DCE间的约定，具有以下特性：</p></li></ul><ol><li>机械特性（长什么样）</li><li>电气特性（用多少电平，电阻之类）</li><li>功能特性（每根线的作用）</li><li>过程特性（各种事件的出现顺序）</li></ol><h2 id="2-2-数据通信的基础知识"><a href="#2-2-数据通信的基础知识" class="headerlink" title="2.2 数据通信的基础知识"></a>2.2 数据通信的基础知识</h2><h3 id="基本术语"><a href="#基本术语" class="headerlink" title="基本术语:"></a>基本术语:</h3><ol><li>通信：在源点和终点之间传递消息或者信息（消息不等于信息）</li><li>消息：能被通信双方理解而且可以相互传递的文字、符号、数据、语音和图像等</li><li><strong>信息</strong>:消息中的有意义的部分，<strong>消息是信息的载体</strong>(关键)</li><li>数据：运送消息的实体，分为模拟数据和数字数据</li><li>信号：是消息的载体，通信系统中消息通过电信号传递，分为模拟信号和数字信号</li></ol><p>栗子:我发了一段乱码给小米，我们在通信，我发的是消息，但是小明看得懂每个字，但是连在一起就不会了，这段话对他没有意义，他也就没收到信息，乱码中有字母数字等为数据，在路线中通过电信号传递</p><p>画个示意图整理概念：</p><p><strong><img src="/.io//image-20230726213808371.png" alt="image-20230726213808371"></strong></p><h3 id="常见编码方式"><a href="#常见编码方式" class="headerlink" title="常见编码方式"></a>常见编码方式</h3><ul><li><p>不归零制（不确定·比特数）</p></li><li><p>归零制（跳变后归零）</p></li><li><p>曼切斯特编码（由上升沿或者下降沿作为0或1）</p></li><li><p>差分曼切斯特编码（由下一个比特状态确定，下一个是0边缘跳变，否则不变）</p><p><strong>特点</strong></p><p><img src="/.io//image-20230726230337759.png" alt="image-20230726230337759"></p></li></ul><h3 id="基本带通调制方法"><a href="#基本带通调制方法" class="headerlink" title="基本带通调制方法"></a>基本带通调制方法</h3><p><img src="/.io//image-20230726230632971.png" alt="image-20230726230632971"></p><p>调幅：不同信号用不同幅度的波形替代（高低电平幅度不同）</p><p>调频：高低电平频率不同</p><p>调相：高低电平相位不同</p><h3 id="码元"><a href="#码元" class="headerlink" title="码元"></a>码元</h3><p><img src="/.io//image-20230726231645991.png" alt="image-20230726231645991"></p><h3 id="2-2-1-数据通信系统的模型"><a href="#2-2-1-数据通信系统的模型" class="headerlink" title="2.2.1 数据通信系统的模型"></a>2.2.1 数据通信系统的模型</h3><p>  源系统(信源和发送器)</p><p>传输系统</p><p>目的系统(接收器和信宿)</p><p><img src="/.io//image-20230726211024317.png" alt="image-20230726211024317"></p><h3 id="2-2-2-有关信道的几个基本概念"><a href="#2-2-2-有关信道的几个基本概念" class="headerlink" title="2.2.2 有关信道的几个基本概念"></a>2.2.2 有关信道的几个基本概念</h3><ul><li>信道：信号传输的通道（单工、半双工、全双工通信）</li><li>基带信号（未调制，较多低频）</li><li>调制（基带调制和带通调制）</li></ul><p><img src="/.io//image-20230726211736738.png" alt="image-20230726211736738"></p><p>基带调制（编码coding）—改装自行车</p><p>带通调制—自行车放在大货车上、</p><h3 id="2-2-3-信道的极限容量"><a href="#2-2-3-信道的极限容量" class="headerlink" title="2.2.3 信道的极限容量"></a>2.2.3 信道的极限容量</h3><p>信道传输信号会失真</p><p><img src="/.io//image-20230726231845885.png" alt="image-20230726231845885"></p><p>失真原因：</p><p><img src="/.io//image-20230726232158449.png" alt="image-20230726232158449"></p><p><img src="/.io//image-20230726232222015.png" alt="image-20230726232222015"></p><p>信噪比：信号和噪声的比值</p><h4 id="信道的频率范围"><a href="#信道的频率范围" class="headerlink" title="信道的频率范围"></a>信道的频率范围</h4><h4 id="奈氏准则（理想情况）"><a href="#奈氏准则（理想情况）" class="headerlink" title="奈氏准则（理想情况）"></a>奈氏准则（理想情况）</h4><p><img src="/.io//image-20230726232653280.png" alt="image-20230726232653280"></p><p><img src="/.io//image-20230726235024390.png" alt="image-20230726235024390"> </p><h4 id="信噪比"><a href="#信噪比" class="headerlink" title="信噪比"></a>信噪比</h4><p><img src="/.io//image-20230726233449890.png" alt="image-20230726233449890"></p><p>s———signal</p><p>n———noise</p><h4 id="香农公式！！！！"><a href="#香农公式！！！！" class="headerlink" title="香农公式！！！！"></a>香农公式！！！！</h4><p><img src="/.io//image-20230726233652065.png" alt="image-20230726233652065"></p><p>将信噪比考虑进去了，只要速率低于这个值就一定能找到传输方式减少差错</p><p><img src="/.io//image-20230726234017828.png" alt="image-20230726234017828"></p><p><strong>奈氏是上限，香农是下限</strong> </p><p><strong>奈氏考虑码制，香农考虑信噪比</strong></p><h2 id="2-3-物理层下面的传输媒体"><a href="#2-3-物理层下面的传输媒体" class="headerlink" title="2.3 物理层下面的传输媒体"></a>2.3 物理层下面的传输媒体</h2><h3 id="2-3-1-导引型传输媒体"><a href="#2-3-1-导引型传输媒体" class="headerlink" title="2.3.1 导引型传输媒体"></a>2.3.1 导引型传输媒体</h3><p><img src="/.io//image-20230727202119189.png" alt="image-20230727202119189"></p><p>*有线–网线等</p><h4 id="双绞线"><a href="#双绞线" class="headerlink" title="双绞线"></a>双绞线</h4><h5 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h5><p>twist起来可以减少信号辐射</p><p>A&#x2F;D信号都可以传输 </p><p>一般来说默认最高传输距离为100m</p><p>便宜</p><p><img src="/.io//image-20230727202737489.png" alt="image-20230727202737489"></p><h5 id="类别差别"><a href="#类别差别" class="headerlink" title="类别差别"></a>类别差别</h5><p><img src="/.io//image-20230727202810661.png" alt="image-20230727202810661"><strong>屏蔽更安全</strong></p><p><img src="/.io//image-20230727203032556.png" alt="image-20230727203032556"></p><p>F&#x2F;UTP最外层</p><p>U&#x2F;FTP里层</p><p>F&#x2F;FTP双层</p><h5 id="标准"><a href="#标准" class="headerlink" title="标准"></a>标准</h5><p><img src="/.io//image-20230727203754882.png" alt="image-20230727203754882"></p><p>8类线，负责传输电磁波信号</p><p><img src="/.io//image-20230727203910384.png" alt="image-20230727203910384"></p><h4 id="同轴电缆"><a href="#同轴电缆" class="headerlink" title="同轴电缆"></a>同轴电缆</h4><h5 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h5><p>一层包一层</p><p>被双绞线和光纤薄纱</p><p>容易被偷</p><p><img src="/.io//image-20230727204822445.png" alt="image-20230727204822445"></p><h4 id="光缆"><a href="#光缆" class="headerlink" title="光缆"></a>光缆</h4><p><img src="/.io//image-20230727205119550.png" alt="image-20230727205119550"></p><h5 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h5><p>发送端要有光源，不能有电源（发光二极管，半导体激光器等）</p><p>接收端要有光检测器还原出电脉冲</p><h5 id="传输方式"><a href="#传输方式" class="headerlink" title="传输方式"></a>传输方式</h5><p>利用物理相关知识设计使得光以某个入射角入射时，光线一直在线路中进行全反射传播</p><p><img src="/.io//image-20230727205628057.png" alt="image-20230727205628057"></p><h5 id="多模与单模"><a href="#多模与单模" class="headerlink" title="多模与单模"></a>多模与单模</h5><p><img src="/.io//image-20230727205919922.png" alt="image-20230727205919922"></p><p>多模传的多但是距离短（损耗大）</p><p>单模传的少但是长</p><h5 id="使用类别"><a href="#使用类别" class="headerlink" title="使用类别"></a>使用类别</h5><p><img src="/.io//image-20230727210131465.png" alt="image-20230727210131465"></p><h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><p><img src="/.io//image-20230727210212003.png" alt="image-20230727210212003">太脆弱了需要很多保护层</p><h3 id="2-3-2-非导引型传输媒体"><a href="#2-3-2-非导引型传输媒体" class="headerlink" title="2.3.2 非导引型传输媒体"></a>2.3.2 非导引型传输媒体</h3><p><img src="/.io//image-20230727202135018.png" alt="image-20230727202135018"></p><p>*无线–wifi</p><h4 id="无线电微波通信"><a href="#无线电微波通信" class="headerlink" title="无线电微波通信"></a>无线电微波通信</h4><p><img src="/.io//image-20230727211708263.png" alt="image-20230727211708263"></p><p>通过微波接力扩大传输距离（地面和太空）</p><h4 id="同步卫星"><a href="#同步卫星" class="headerlink" title="同步卫星"></a>同步卫星</h4><p><img src="/.io//image-20230727212445803.png" alt="image-20230727212445803"></p><h4 id="近地卫星"><a href="#近地卫星" class="headerlink" title="近地卫星"></a>近地卫星</h4><p><img src="/.io//image-20230727212625219.png" alt="image-20230727212625219"></p><h3 id="2-4-信道复用技术"><a href="#2-4-信道复用技术" class="headerlink" title="2.4 信道复用技术"></a>2.4 信道复用技术</h3><h4 id="2-4-1-频分复用、时分复用和统计时分复用"><a href="#2-4-1-频分复用、时分复用和统计时分复用" class="headerlink" title="2.4.1 频分复用、时分复用和统计时分复用"></a>2.4.1 频分复用、时分复用和统计时分复用</h4><p>信道复用—–传输多个信号，提高信道利用率，降低成本</p><p><img src="/.io//image-20230727213639106.png" alt="image-20230727213639106"></p><h6 id="频分复用（电视同一时间有不同的频道可以观看）"><a href="#频分复用（电视同一时间有不同的频道可以观看）" class="headerlink" title="频分复用（电视同一时间有不同的频道可以观看）"></a>频分复用（电视同一时间有不同的频道可以观看）</h6><p><img src="/.io//image-20230727213835807.png" alt="image-20230727213835807"></p><p>分到哪个就只能用哪个</p><h6 id="频分多址（同一个频道轮流有不同的电视节目）"><a href="#频分多址（同一个频道轮流有不同的电视节目）" class="headerlink" title="频分多址（同一个频道轮流有不同的电视节目）"></a>频分多址（同一个频道轮流有不同的电视节目）</h6><p><img src="/.io//image-20230727214102303.png" alt="image-20230727214102303"></p><h6 id="时分复用"><a href="#时分复用" class="headerlink" title="时分复用"></a>时分复用</h6><p><img src="/.io//image-20230727214404250-1690465445714-1.png" alt="image-20230727214404250"></p><p>一天按一个小时为单位（TDM帧），前20分钟给a用，然后给b用，最后给c用，循环24次</p><p><strong>缺点</strong></p><p>前20分钟不管你用不用，后面的人都得等待，效率低—— </p><h6 id="时分多址"><a href="#时分多址" class="headerlink" title="时分多址"></a>时分多址</h6><p>前20分钟不单单给a用，也可以给a的好朋友efg用</p><p><img src="/.io//image-20230727214859241.png" alt="image-20230727214859241"></p><h5 id="统计时分复用"><a href="#统计时分复用" class="headerlink" title="统计时分复用"></a>统计时分复用</h5><p>前面说了时分复用会让利用率降低，那么统计时分就是在此基础上添加新补丁的版本</p><p> 将原本的TDM帧升级为STDM帧，通过复用器将每个部分进行扫描，有数据则存入STDM中，当帧满时再发送</p><p><img src="/.io//image-20230727224015005.png" alt="image-20230727224015005"></p><h4 id="2-4-2-（光）波分复用"><a href="#2-4-2-（光）波分复用" class="headerlink" title="2.4.2 （光）波分复用"></a>2.4.2 （光）波分复用</h4><p>其实就是光波的频分复用，只不过这里的频率指的是光波的波长</p><p><img src="/.io//image-20230727224336036.png" alt="image-20230727224336036"></p><p><img src="/.io//image-20230727224415679.png" alt="image-20230727224415679"></p><h4 id="2-4-3-码分复用（码分多址）"><a href="#2-4-3-码分复用（码分多址）" class="headerlink" title="2.4.3 码分复用（码分多址）"></a>2.4.3 码分复用（码分多址）</h4><p>前面的时分和波分复用都是固定了时间或者频率范围进行描述的，而码分复用就是要求时间及频率都相同的情况下如何进行码分复用，很简单，就是给不同的游客分发不同的牌证在同一辆车上跑，等下车时看牌分人</p><p><em><img src="/.io//image-20230727225132254.png" alt="image-20230727225132254"></em>*</p><h6 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h6><p><img src="/.io//image-20230727225745816.png" alt="image-20230727225745816"></p><p>将原来的0和1扩展内核变成一个m位的二进制数，例如1101代表1，那么它的反码0010就是表示0</p><p>为了便于计算，码片的0表示成-1，1就是1</p><p><strong>为了能复用传输的东西也扩大了m倍</strong></p><h6 id="如何区分不同码片？"><a href="#如何区分不同码片？" class="headerlink" title="如何区分不同码片？"></a>如何区分不同码片？</h6><p>类比数学上的向量内积</p><p><img src="/.io//image-20230727230407485.png" alt="image-20230727230407485"></p><p><img src="/.io//image-20230727230416910.png" alt="image-20230727230416910"></p><h6 id="怎么从合并信号中分离出单一信号？"><a href="#怎么从合并信号中分离出单一信号？" class="headerlink" title="怎么从合并信号中分离出单一信号？"></a>怎么从合并信号中分离出单一信号？</h6><p><img src="/.io//image-20230727231251326.png" alt="image-20230727231251326"></p><p>首先确定两个码片的波形，然后将两个信号叠加起来（算数），最后将信号分离时需要哪一个信号就将合并的信号与其码片进行内积计算，得到的波形就是我们需要的原信号（这里1代表1，0代表-1）</p><h4 id="各种复用技术的使用条件"><a href="#各种复用技术的使用条件" class="headerlink" title="各种复用技术的使用条件"></a>各种复用技术的使用条件</h4><p>频分复用适用于传输的信号在不同的频带上</p><p>时分复用适用于在不同的时间上传输的信号</p><p>波分复用适用于光信号传播</p><p><strong>码分复用适用于干扰较强时</strong></p><h1 id="第三节-数据链路层概述"><a href="#第三节-数据链路层概述" class="headerlink" title="第三节 数据链路层概述"></a>第三节 数据链路层概述</h1><h2 id="3-1-1-关于数据链路层"><a href="#3-1-1-关于数据链路层" class="headerlink" title="3.1.1 关于数据链路层"></a>3.1.1 关于数据链路层</h2><h3 id="作用："><a href="#作用：" class="headerlink" title="作用："></a>作用：</h3><p>​1.在比特流中找到一组数据的开始以及结束位置</p><p>​2.解决多个设备接收比特流问题</p><p>​3.<strong>解决比特传输错误问题</strong> </p><h3 id="链路、数据链路、层、帧"><a href="#链路、数据链路、层、帧" class="headerlink" title="链路、数据链路、层、帧"></a>链路、数据链路、层、帧</h3><p><img src="/.io//image-20230801160555027.png" alt="image-20230801160555027"></p><p>链路：物理且无源</p><p>数据链路&#x3D;链路+协议</p><p>层：将结点与结点之间通过链路传输帧</p><p>帧：分组交换的单位到了链路层被叫做帧 </p><h3 id="协议栈看数据链路层"><a href="#协议栈看数据链路层" class="headerlink" title="协议栈看数据链路层"></a>协议栈看数据链路层</h3><p><img src="/.io//image-20230801160948245.png" alt="image-20230801160948245"></p><p>层对层，无视下层（透明），服务上层，看做直接传输帧通信</p><p><img src="/.io//image-20230801161140434.png" alt="image-20230801161140434"></p><h3 id="数据链路层的信道类型"><a href="#数据链路层的信道类型" class="headerlink" title="数据链路层的信道类型"></a>数据链路层的信道类型</h3><ol><li>点对点信道（骨干线路）</li></ol><ul><li><input disabled type="checkbox"> 使用协议？</li></ul><p>PPP</p><ol><li>广播通信（边缘线路）</li></ol><ul><li><input disabled type="checkbox"> 使用协议？</li></ul><p>CSMA&#x2F;CD</p><h2 id="3-1-2-三个基本问题"><a href="#3-1-2-三个基本问题" class="headerlink" title="3.1.2 三个基本问题"></a>3.1.2 三个基本问题</h2><h3 id="封装成帧"><a href="#封装成帧" class="headerlink" title="封装成帧"></a>封装成帧</h3><p><strong>比特流前加首部和尾部进行帧定界</strong></p><p><em>数据链路层往上只加首部</em></p><p>MTU（Maximum Transfer Unit）—帧的数据部分最长限制&#x2F;IP数据报长度（图片蓝色部分）</p><p><img src="/.io//image-20230801162117153.png" alt="image-20230801162117153"></p><p>规定原因：（）</p><h4 id="成帧-FRAMING-方式"><a href="#成帧-FRAMING-方式" class="headerlink" title="成帧(FRAMING)方式"></a>成帧(FRAMING)方式</h4><ul><li><strong>字节计数法（无差错情况）</strong></li></ul><p>出错会导致一连串帧的错误</p><p><img src="/.io//image-20230801162707892.png" alt="image-20230801162707892"></p><ul><li><strong>带字节填充的定界符法</strong></li></ul><p>SOH（首部）与EOT（尾部）</p><p>数据部分若有与SOH或EOT相同的部分则会错误判断帧的边界</p><p><img src="/.io//image-20230801163037221.png" alt="image-20230801163037221">升级版：<strong>在有歧义的数据前面加上特殊字节或者字符</strong></p><p><img src="/.io//image-20230801163526670.png" alt="image-20230801163526670"></p><ul><li><strong>带比特填充的定界符法</strong></li><li><img src="/.io//image-20230801164114484.png" alt="image-20230801164114484"></li><li><strong>物理层编码违例</strong></li><li><img src="/.io//image-20230801164129689.png" alt="image-20230801164129689"></li></ul><h3 id="透明传输"><a href="#透明传输" class="headerlink" title="透明传输"></a>透明传输</h3><p>翻译：发送不发生差错</p><p>利用前面的插入方式使得传输正确</p><h3 id="差错控制"><a href="#差错控制" class="headerlink" title="差错控制"></a>差错控制</h3><h4 id="误码率（BER）"><a href="#误码率（BER）" class="headerlink" title="误码率（BER）"></a>误码率（BER）</h4><p>错误的比特占传输比特的总数</p><h4 id="纠错码（改）"><a href="#纠错码（改）" class="headerlink" title="纠错码（改）"></a>纠错码（改）</h4><p>使用于错误发生比较频繁的线路（无线链路）</p><h4 id="检错码（丢）"><a href="#检错码（丢）" class="headerlink" title="检错码（丢）"></a>检错码（丢）</h4><p>用在高可靠、误码率较低的信道上，例如光纤线路（光纤线路）</p><h4 id="循环冗余检验CRC原理"><a href="#循环冗余检验CRC原理" class="headerlink" title="循环冗余检验CRC原理"></a>循环冗余检验CRC<strong>原理</strong></h4><ol><li>在原来的数据部分（k位）加上n位的冗余码（FCS）构成帧</li><li>整体有错丢弃反之接收</li><li>计算方式：<img src="/.io//image-20230801165716585.png" alt="image-20230801165716585"></li><li>栗子：<img src="/.io//image-20230801171636250.png" alt="image-20230801171636250"></li></ol><p>​这种应该是通过代码程序实现<img src="/.io//image-20230801171652908.png" alt="image-20230801171652908"></p><p>国际标准<strong>P</strong></p><p><img src="/.io//image-20230801172010613.png" alt="image-20230801172010613"></p><p><em><strong>FCS不一定由CRC得到</strong></em></p><p>CRC只能做到接收到的帧没有错误，但是顺序问题不能判断</p><h2 id="3-2-点对点协议PPP"><a href="#3-2-点对点协议PPP" class="headerlink" title="3.2 点对点协议PPP"></a>3.2 点对点协议PPP</h2><h3 id="3-2-1-PPP协议的特点"><a href="#3-2-1-PPP协议的特点" class="headerlink" title="3.2.1 PPP协议的特点"></a>3.2.1 PPP协议的特点</h3><h4 id="工作要求"><a href="#工作要求" class="headerlink" title="工作要求"></a>工作要求</h4><p><img src="/.io//image-20230802112600769.png" alt="image-20230802112600769"></p><p><img src="/.io//image-20230802112720563.png" alt="image-20230802112720563"></p><p><strong>PPP不同于广播在于它会进行地址协商</strong></p><h4 id="协议组成"><a href="#协议组成" class="headerlink" title="协议组成"></a>协议组成</h4><p>LCP与NCP</p><p>LCP(Link Control Protocol)：链路控制协议—-用于建立、配置和测试数据链路的链路控制协议，双方可以<strong>协商一些选项</strong>，<strong>最重要****的功能之一是</strong>身份验证**</p><p>NCP（Network Control Protocol）:里面包括了不同的协议，用于不同网络层的数据传输</p><h3 id="3-2-2-PPP协议的帧格式"><a href="#3-2-2-PPP协议的帧格式" class="headerlink" title="3.2.2 PPP协议的帧格式"></a>3.2.2 PPP协议的帧格式</h3><h4 id="帧格式"><a href="#帧格式" class="headerlink" title="帧格式"></a>帧格式</h4><p><img src="/.io//image-20230802113938474.png" alt="image-20230802113938474"></p><h4 id="透明传输方式"><a href="#透明传输方式" class="headerlink" title="透明传输方式"></a>透明传输方式</h4><h5 id="异步传输—字节填充法"><a href="#异步传输—字节填充法" class="headerlink" title="异步传输—字节填充法"></a>异步传输—字节填充法</h5><p><img src="/.io//image-20230802114528795.png" alt="image-20230802114528795"></p><p>IP数据报里面与首位尾部一样的字节(7E)前面填充一个特殊字节，例如7D，然后IP数据报中原来就有的7E改为别的特殊字节例如5E</p><h5 id="同步传输—零比特传输法"><a href="#同步传输—零比特传输法" class="headerlink" title="同步传输—零比特传输法"></a>同步传输—零比特传输法</h5><p><img src="/.io//image-20230802114935943.png" alt="image-20230802114935943"></p><p>标志符是六个一，为了不让IP数据报中出现6个1，在传输数据时当出现连续的5个1时添加一个0（与后面数据无关），接收同理出现连续的五个1则删除接下来的那个比特</p><h4 id="同步异步区别"><a href="#同步异步区别" class="headerlink" title="同步异步区别"></a>同步异步区别</h4><p>*同步面向比特，单位帧，时钟统一，无间隔</p><p>*异步面向字节，单位字符，效率低，高速来南路开销大</p><h3 id="3-2-3-PPP协议的工作状态"><a href="#3-2-3-PPP协议的工作状态" class="headerlink" title="3.2.3 PPP协议的工作状态"></a>3.2.3 PPP协议的工作状态</h3><p><img src="/.io//image-20230802115318053.png" alt="image-20230802115318053"><br>（还是挺清晰的)</p><h2 id="3-3广播通信的数据链路层"><a href="#3-3广播通信的数据链路层" class="headerlink" title="3.3广播通信的数据链路层"></a>3.3广播通信的数据链路层</h2><h3 id="3-3-1-局域网的数据链路层"><a href="#3-3-1-局域网的数据链路层" class="headerlink" title="3.3.1 局域网的数据链路层"></a>3.3.1 局域网的数据链路层</h3><h4 id="优点：-2"><a href="#优点：-2" class="headerlink" title="优点："></a>优点：</h4><p>具有广播功能便于拓展</p><h4 id="局域网拓扑结构"><a href="#局域网拓扑结构" class="headerlink" title="局域网拓扑结构"></a>局域网拓扑结构</h4><p><img src="/.io//image-20230802220608850.png" alt="image-20230802220608850"></p><h5 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h5><p>总线：</p><p>（优点）结构简单布线容易、可靠性较高，易于扩充</p><p>（缺点）所有的数据都需经过总线传送，总线成为整个网络的瓶颈；出现故障诊断较为困难。另外，由于信道共享，连接的节点不宜过多，<strong>总线自身的故障</strong>可以导致系统的崩溃</p><p>星型：</p><p>优点：结构简单、容易实现、便于管理，通常以集线器（Hub）作为中央节点，便于网络维护和网络管理</p><p>缺点：中心结点是全网络的可靠瓶颈，<strong>中心结点出现故障</strong>会导致网络的瘫痪。</p><p>环形结构：</p><p>优点：结构简单，适合使用光纤，传输距离远，传输延迟确定。</p><p>缺点：环网中的每个结点均成为网络可靠性的瓶颈，<strong>任意结点出现故障都会造成网络瘫痪</strong>，另外故障诊断也较困难。最著名的环形结构网络是令牌环网（Token Ring）</p><p>树型结构：</p><p>优点：连结简单，维护方便，适用于汇集信息的应用要求。</p><p>缺点：资源共享能力较低，可靠性不高，任何一<strong>个工作站或链路的故障都会影响整个网络的运行</strong></p><p>网状结构：</p><p>优点：系统可靠性高，比较容易扩展，但是结构复杂，每一结点都与多点进行连结，因此必须采用<strong>路由算法</strong>和<strong>流量控制</strong>方法。<strong>目前广域网基本上采用网状结构。</strong></p><p>缺点： 1、<strong>拓扑结构复杂，其安装和配置都比较困难。</strong> 2、网络控制机制复杂，必须采用路由算法和流量控制机制</p><h4 id="媒体共享技术"><a href="#媒体共享技术" class="headerlink" title="媒体共享技术"></a>媒体共享技术</h4><p>静态划分通道：频分、时分、波分、码分</p><p>（通信量大且稳定，用户少且固定，代价高，不适合局域网）</p><p>动态媒体接入控制（多点接入）：随机接入（以太网）与受控接入（轮询polling）</p><p>*<strong>为解决数据发生冲突的情况，使用动态媒体接入控制</strong></p><h4 id="以太网的两个标准"><a href="#以太网的两个标准" class="headerlink" title="以太网的两个标准"></a>以太网的两个标准</h4><ol><li><p>IEEE 802.3（有LLC协议）</p></li><li><p>DIX Ethernet V2（商用，仅有MAC协议）</p></li></ol><h4 id="适配器"><a href="#适配器" class="headerlink" title="适配器"></a>适配器</h4><p>计算机通过适配器（网卡）来与互联网进行通信</p><p><img src="/.io//image-20230802234920407.png" alt="image-20230802234920407"></p><p>cpu找IP地址，网卡找硬件地址</p><p><strong>作用</strong></p><p><img src="/.io//image-20230802235303986.png" alt="image-20230802235303986"></p><h4 id="以太网的两个重要措施"><a href="#以太网的两个重要措施" class="headerlink" title="以太网的两个重要措施"></a>以太网的两个重要措施</h4><ol><li>采用较为灵活的<strong>无连接的工作方式</strong></li><li>发送使用曼切斯特编码，便于同步</li></ol><h3 id="3-3-2-CSMA-x2F-CD协议-半双工"><a href="#3-3-2-CSMA-x2F-CD协议-半双工" class="headerlink" title="3.3.2 CSMA&#x2F;CD协议(半双工)"></a>3.3.2 CSMA&#x2F;CD协议(半双工)</h3><h4 id="工作方式-1"><a href="#工作方式-1" class="headerlink" title="工作方式"></a>工作方式</h4><p>（先听后发，边听边发，冲突停止，延迟重发） </p><ul><li>多点接入–说明是总线型网络</li><li>载波监听–边发送边监听，发前和发中都要检测</li><li>碰撞检测–判断有没有发生碰撞：检测信道上电压的变化情况，电压摆动值超过一定值认为碰撞</li></ul><h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><ul><li>适配器立即停止发送</li><li>等待随机时间后再次发送</li></ul><h4 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h4><p><img src="https://ts1.cn.mm.bing.net/th/id/R-C.5c28ebc76c618c86e0c3309ea79e095a?rik=lhabvtwyNdbG5Q&riu=http://i2.51cto.com/images/blog/201811/20/c8c74f21e535437a119b5bd613c2d094.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=&ehk=1dMkSemuBsxi73wznIZq51G7JwXktOC7v1JDtg7mPZk=&risl=&pid=ImgRaw&r=0" alt="CSMA/CD原理及流程图-布布扣-bubuko.com"></p><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p><img src="/.io//image-20230803002133229.png" alt="image-20230803002133229"></p><p>监听反应不过来，发生碰撞到终点的时间里不能判断，而此时还在发数据，数据会发生更大的错误</p><p><img src="/.io//image-20230803002420476.png" alt="image-20230803002420476"></p><p><img src="/.io//image-20230803002639512.png" alt="image-20230803002639512"></p><p>确实是:laughing:</p><h4 id="二进制指数退避"><a href="#二进制指数退避" class="headerlink" title="二进制指数退避"></a>二进制指数退避</h4><p><img src="/.io//image-20230803002804614.png" alt="image-20230803002804614"></p><p><img src="/.io//image-20230803002813046.png" alt="image-20230803002813046"></p><ul><li><p>二进制的名字来源于2的k次方-1那里</p></li><li><p>r&#x3D;2*k-1</p></li><li><p>T&#x3D;r*2t</p></li><li><p>k&#x3D;Min[重传次数，10]</p></li><li><p>重传16次丢弃并且高层报告</p></li></ul><p><img src="/.io//image-20230803003354398.png" alt="image-20230803003354398"></p><p>这个64字节有历史遗留:dancer:</p><p>  <em><strong>发生碰撞后线路上的其他用户可能不知道，这时发送站会人工发送信号到线路上通知所有用户发生碰撞</strong></em></p><h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><p><img src="/.io//image-20230803005808940.png" alt="image-20230803005808940"></p><h3 id="3-3-3-使用集线器的星型拓扑"><a href="#3-3-3-使用集线器的星型拓扑" class="headerlink" title="3.3.3 使用集线器的星型拓扑"></a>3.3.3 使用集线器的星型拓扑</h3><ul><li>传统传输媒体发展：粗同轴电缆–细同轴电缆–双绞线</li><li>双绞线对应星型拓扑，相对总线更好组网</li><li>可靠性依靠集线器（hub）</li></ul><p>*每个站到集线器的距离不超过100m</p><p><img src="/.io//image-20230804115517088.png" alt="image-20230804115517088"></p><p>F对应光纤</p><p><strong>特点</strong></p><p><img src="/.io//image-20230804115611779.png" alt="image-20230804115611779"></p><ul><li><p>逻辑上还是总线型</p></li><li><p>共享带宽</p></li><li><p>工作在物理层</p><p>​</p></li></ul><p></p><h3 id="3-3-4-以太网的信道利用率"><a href="#3-3-4-以太网的信道利用率" class="headerlink" title="3.3.4 以太网的信道利用率"></a>3.3.4 以太网的信道利用率</h3><ul><li>多个站可能会发生碰撞</li><li>碰撞后利用率低于100%</li></ul><p>计算公式：<br>$$<br>Smax&#x3D;T0&#x2F;T+t&#x3D;1&#x2F;(1+a)<br>a&#x3D;t&#x2F;T<br>其中t为争用期的一半，T为帧的发送时间<br>$$<br><img src="/.io//image-20230804120238964.png" alt="image-20230804120238964"></p><p>帧长路短就是好（S低于30%过载）</p><h3 id="3-3-5-以太网的MAC层"><a href="#3-3-5-以太网的MAC层" class="headerlink" title="3.3.5 以太网的MAC层"></a>3.3.5 以太网的MAC层</h3><p>*LLC层已经不用了</p><p><img src="/.io//image-20230804120639225.png" alt="image-20230804120639225"></p><p>就类似于你家的经纬度，固定了的</p><p>*一个接口一个网卡一个MAC地址</p><h4 id="结构"><a href="#结构" class="headerlink" title="结构"></a><strong>结构</strong></h4><p><img src="/.io//image-20230804121054951.png" alt="image-20230804121054951"></p><p>厂家就后三个字节自己定义不重复即可 </p><h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p><img src="/.io//image-20230804121255567.png" alt="image-20230804121255567"></p><p>发一个人，发一个组，发一个班</p><p><img src="/.io//image-20230804125654311.png" alt="image-20230804125654311"></p><p><img src="/.io//image-20230804125712343.png" alt="image-20230804125712343"></p><ul><li>适配器收到一个MAC帧会先用硬件检查帧中的MAC地址</li><li>是发送给自己的则接收并处理</li><li>不是发给自己的就丢弃</li><li>以<strong>混杂方式</strong>工作的有帧就收</li></ul><h4 id="MAC的帧格式"><a href="#MAC的帧格式" class="headerlink" title="MAC的帧格式"></a>MAC的帧格式</h4><p><img src="/.io//image-20230804130016505.png" alt="image-20230804130016505"></p><p><img src="/.io//image-20230804130025433.png" alt="image-20230804130025433"></p><p><img src="/.io//image-20230804130203716.png" alt="image-20230804130203716"></p><h4 id="无效MAC帧"><a href="#无效MAC帧" class="headerlink" title="无效MAC帧"></a>无效MAC帧</h4><p><img src="/.io//image-20230804130249583.png" alt="image-20230804130249583"></p><p>无效丢弃，不重传</p><h2 id="3-4-扩展的以太网"><a href="#3-4-扩展的以太网" class="headerlink" title="3.4 扩展的以太网"></a>3.4 扩展的以太网</h2><p>*扩展仍然是一个网络</p><h3 id="3-4-1-在物理层扩展以太网"><a href="#3-4-1-在物理层扩展以太网" class="headerlink" title="3.4.1 在物理层扩展以太网"></a>3.4.1 在物理层扩展以太网</h3><h4 id="使用光纤扩展（距离）"><a href="#使用光纤扩展（距离）" class="headerlink" title="使用光纤扩展（距离）"></a>使用光纤扩展（距离）</h4><p><img src="/.io//image-20230804130815062.png" alt="image-20230804130815062"></p><h4 id="使用集线器进行扩展（用户数量）"><a href="#使用集线器进行扩展（用户数量）" class="headerlink" title="使用集线器进行扩展（用户数量）"></a>使用集线器进行扩展（用户数量）</h4><p><img src="/.io//image-20230804130917492.png" alt="image-20230804130917492"></p><p>限制：双绞线最大距离，集线器接口数</p><p> 图示正好是一个冲突域，扩展越多冲突域越来越大</p><p><strong>优缺点</strong></p><p><img src="/.io//image-20230804131350009.png" alt="image-20230804131350009"></p><p><img src="/.io//image-20230804131358658.png" alt="image-20230804131358658"></p><h3 id="3-4-2-在数据链路层扩展以太网"><a href="#3-4-2-在数据链路层扩展以太网" class="headerlink" title="3.4.2 在数据链路层扩展以太网"></a>3.4.2 在数据链路层扩展以太网</h3><p>早期网桥，现在交换机（多接口网桥）</p><h5 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h5><ul><li><p>两个都是全双工工作方式，解决了共享总线的问题</p></li><li><p>减少了碰撞域（具有并行性 ）</p></li><li><p>接口有存储器</p></li><li><p>即插即用，<strong>交换表通过自学习建立</strong></p></li><li><p>使用专用的交换结构芯片，比使用软件转发的网桥快的一</p></li><li><p>接口独享带宽，支持多类型多速率的接口</p></li></ul><h5 id="自学习"><a href="#自学习" class="headerlink" title="自学习"></a>自学习</h5><p><strong><img src="/.io//image-20230804132613963.png" alt="image-20230804132613963"></strong></p><h5 id="与集线器相连"><a href="#与集线器相连" class="headerlink" title="与集线器相连"></a>与集线器相连</h5><p><img src="/.io//image-20230804132928791.png" alt="image-20230804132928791"></p><p>更新困难，集线器没有交换表，默认广播</p><h5 id="两台交换机相连"><a href="#两台交换机相连" class="headerlink" title="两台交换机相连"></a>两台交换机相连</h5><p><img src="/.io//image-20230804133029794.png" alt="image-20230804133029794"></p><h5 id="多台交换机相连"><a href="#多台交换机相连" class="headerlink" title="多台交换机相连"></a>多台交换机相连</h5><p><img src="/.io//image-20230804133503240.png" alt="image-20230804133503240"></p><p>可能会形成回路，导致广播风暴</p><h5 id="生成树协议"><a href="#生成树协议" class="headerlink" title="生成树协议"></a>生成树协议</h5><p><img src="/.io//image-20230804133842252.png" alt="image-20230804133842252"></p><p>从逻辑上把两条线变成一条线（前两张图）</p><h5 id="从总线到星型以太网"><a href="#从总线到星型以太网" class="headerlink" title="从总线到星型以太网"></a>从总线到星型以太网</h5><p><img src="/.io//image-20230804134709381.png" alt="image-20230804134709381"></p><p>从CSMA&#x2F;CD协议到全双工</p><p><img src="/.io//image-20230804134751497.png" alt="image-20230804134751497"></p><h3 id="3-4-3-虚拟以太网"><a href="#3-4-3-虚拟以太网" class="headerlink" title="3.4.3 虚拟以太网"></a>3.4.3 虚拟以太网</h3><h5 id="以太网的问题"><a href="#以太网的问题" class="headerlink" title="以太网的问题"></a>以太网的问题</h5><p><img src="/.io//image-20230804134815560.png" alt="image-20230804134815560"></p><h5 id="广播域"><a href="#广播域" class="headerlink" title="广播域"></a>广播域</h5><p><img src="/.io//image-20230804135215265.png" alt="image-20230804135215265"></p><p><img src="/.io//image-20230804135227396.png" alt="image-20230804135227396"></p><p>冲突域：相互发信息会冲突的区域</p><p>广播域：发送消息大家都能收到的区域</p><h5 id="安全问题、管理问题"><a href="#安全问题、管理问题" class="headerlink" title="安全问题、管理问题"></a>安全问题、管理问题</h5><p>在一个广播域不想让某些用户接收到消息</p><h5 id="解决方法：虚拟局域网VLAN（Virtual-LAN）"><a href="#解决方法：虚拟局域网VLAN（Virtual-LAN）" class="headerlink" title="解决方法：虚拟局域网VLAN（Virtual LAN）"></a>解决方法：虚拟局域网VLAN（Virtual LAN）</h5><p><img src="/.io//image-20230804135545399.png" alt="image-20230804135545399"></p><p>只是局域网的一种服务，是一种协议，不是新型的局域网</p><p><img src="/.io//image-20230804135807660.png" alt="image-20230804135807660"></p><h5 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h5><p><img src="/.io//image-20230804140138213.png" alt="image-20230804140138213"></p><h5 id="划分标准"><a href="#划分标准" class="headerlink" title="划分标准"></a>划分标准</h5><p><img src="/.io//image-20230804140242934.png" alt="image-20230804140242934"></p><p>一般基于端口</p><h2 id="3-5-高速以太网（介绍）"><a href="#3-5-高速以太网（介绍）" class="headerlink" title="3.5 高速以太网（介绍）"></a>3.5 高速以太网（介绍）</h2><h3 id="3-5-1-100BASE-T-以太网"><a href="#3-5-1-100BASE-T-以太网" class="headerlink" title="3.5.1 100BASE-T 以太网"></a>3.5.1 100BASE-T 以太网</h3><p><img src="/.io//image-20230804140538329.png" alt="image-20230804140538329"></p><p><strong>特点</strong></p><p><img src="/.io//image-20230804140711348.png" alt="image-20230804140711348"></p><h3 id="3-5-2-吉比特以太网"><a href="#3-5-2-吉比特以太网" class="headerlink" title="3.5.2 吉比特以太网"></a>3.5.2 吉比特以太网</h3><p><strong>特点</strong></p><p><img src="/.io//image-20230804140737933.png" alt="image-20230804140737933"></p><h3 id="3-5-3-10吉比特以太网（10GE）和更快的以太网"><a href="#3-5-3-10吉比特以太网（10GE）和更快的以太网" class="headerlink" title="3.5.3 10吉比特以太网（10GE）和更快的以太网"></a>3.5.3 10吉比特以太网（10GE）和更快的以太网</h3><p><strong>特点</strong><img src="/.io//image-20230804140817558.png" alt="image-20230804140817558"></p><h3 id="3-5-4-使用以太网进行宽带接入"><a href="#3-5-4-使用以太网进行宽带接入" class="headerlink" title="3.5.4 使用以太网进行宽带接入"></a>3.5.4 使用以太网进行宽带接入</h3><p><strong>特点</strong></p><p><strong><img src="/.io//image-20230804140849208.png" alt="image-20230804140849208"></strong></p><h1 id="第一次考试纠错"><a href="#第一次考试纠错" class="headerlink" title="第一次考试纠错"></a>第一次考试纠错</h1><p><img src="/.io//image-20230804191349420.png" alt="image-20230804191349420"></p><p>电路交换比其他两种方式实时性都要高，分组交换主要是 时延比报文小</p><p><img src="/.io//image-20230804191638121.png" alt="image-20230804191638121"></p><p>局域网是分组广播式网络，不需要网络层的路由功能</p><p><img src="/.io//image-20230804191934268.png" alt="image-20230804191934268"></p><p>审题！！！这里说的是三层以下，即是1，2层，网桥交换机是数据链路层的，中继器和集线器是物理层的</p><p>三层的是三层交换机</p><p><img src="/.io//image-20230804192126631.png" alt="image-20230804192126631"></p><p>A给B发送消息，<strong>B要回复A是否收到消息了</strong>（题目没说就忽视了）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;第一节：概述&quot;&gt;&lt;a href=&quot;#第一节：概述&quot; class=&quot;headerlink&quot; title=&quot;第一节：概述&quot;&gt;&lt;/a&gt;&lt;strong&gt;第一节：概述&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;1-1-计算机网络在信息时代的作用&quot;&gt;&lt;a href=&quot;#1-1</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/2023017--%E5%BC%A0%E5%81%A5--%E7%AC%AC%E4%B8%89%E6%AC%A1%E7%AC%94%E8%AE%B0/"/>
    <id>http://charles-webebr.github.io/2024/07/10/2023017--%E5%BC%A0%E5%81%A5--%E7%AC%AC%E4%B8%89%E6%AC%A1%E7%AC%94%E8%AE%B0/</id>
    <published>2024-07-10T07:22:46.112Z</published>
    <updated>2023-09-17T09:56:30.822Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第五章-运输层"><a href="#第五章-运输层" class="headerlink" title="第五章 运输层"></a>第五章 运输层</h1><h2 id="5-1-运输层解决的问题"><a href="#5-1-运输层解决的问题" class="headerlink" title="5.1 运输层解决的问题"></a>5.1 运输层解决的问题</h2><h3 id="5-1-1-进程之间的通信"><a href="#5-1-1-进程之间的通信" class="headerlink" title="5.1.1 进程之间的通信"></a>5.1.1 进程之间的通信</h3><ul><li><p>主机间的通信，本质上是两台主机的应用进程之间的通信</p></li><li><p>不同协议使用同一个运输协议叫做复用，从同一协议传输信息到不同进程叫做分用</p></li></ul><p><img src="/.io//image-20230812152945343.png" alt="image-20230812152945343"></p><h3 id="运输层提供的服务"><a href="#运输层提供的服务" class="headerlink" title="运输层提供的服务"></a>运输层提供的服务</h3><ul><li><strong>进程到进程的数据传输</strong></li><li><strong>差错检测</strong></li><li><strong>流量控制和拥塞控制</strong></li></ul><h3 id="5-1-2-运输层的两个重要协议"><a href="#5-1-2-运输层的两个重要协议" class="headerlink" title="5.1.2 运输层的两个重要协议"></a>5.1.2 运输层的两个重要协议</h3><h4 id="可靠信道与不可靠信道"><a href="#可靠信道与不可靠信道" class="headerlink" title="可靠信道与不可靠信道"></a>可靠信道与不可靠信道</h4><p>TCP面向连接的全双工可靠信道</p><p>UDP使用无连接的不可靠信道</p><h4 id="协议传输数据单元（TPDU）"><a href="#协议传输数据单元（TPDU）" class="headerlink" title="协议传输数据单元（TPDU）"></a>协议传输数据单元（TPDU）</h4><p>TCP—-TCP报文段</p><p>UDP–UDP报文段或用户数据报</p><h4 id="二者区别"><a href="#二者区别" class="headerlink" title="二者区别"></a>二者区别</h4><p><img src="/.io//image-20230812153907764.png" alt="image-20230812153907764"></p><p><img src="/.io//image-20230812153925210.png" alt="image-20230812153925210"></p><p>这张图很重要，他会问你哪些应用适用哪个协议 </p><h3 id="5-1-3-运输层的端口"><a href="#5-1-3-运输层的端口" class="headerlink" title="5.1.3 运输层的端口"></a>5.1.3 运输层的端口</h3><h4 id="复用和分用"><a href="#复用和分用" class="headerlink" title="复用和分用"></a>复用和分用</h4><p><img src="/.io//image-20230812154208217.png" alt="image-20230812154208217"></p><h4 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h4><p>全称<strong>协议端口号</strong></p><p><img src="/.io//image-20230812154251939.png" alt="image-20230812154251939"></p><p><img src="/.io//image-20230812154330272.png" alt="image-20230812154330272"></p><p>IP是不能重复的，端口是独立的，是可以重复的</p><p><img src="/.io//image-20230812154428483.png" alt="image-20230812154428483"></p><p>管理部门：IANA</p><ul><li>通信需要知道对方的IP地址和端口（套接字socket&#x3D;（IP地址：端口号），如192.0.0.1：80）</li><li>UDP套接字——&lt;IP地址，端口号&gt;</li><li>TCP套接字——&lt;源IP地址，目的地址，源端口号，目的端口号&gt;</li></ul><h2 id="5-2-用户数据报协议UDP-（单工不连接）"><a href="#5-2-用户数据报协议UDP-（单工不连接）" class="headerlink" title="5.2 用户数据报协议UDP （单工不连接）"></a>5.2 用户数据报协议UDP （单工不连接）</h2><h3 id="5-2-1-UDP概述"><a href="#5-2-1-UDP概述" class="headerlink" title="5.2.1 UDP概述"></a>5.2.1 UDP概述</h3><p>在IP数据报上增加了复用，分用和差错检验</p><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol><li><p><strong>无连接</strong></p></li><li><p><strong>尽最大努力交付</strong></p></li><li><p><strong>面向报文（不拆分）</strong></p></li><li><p><strong>没有拥塞控制</strong></p></li><li><p><strong>支持一对一，一对多，多对一，多对多</strong></p></li><li><p><strong>首部8字节，开销小</strong></p></li></ol><h4 id="适用应用"><a href="#适用应用" class="headerlink" title="适用应用"></a>适用应用</h4><p><img src="/.io//image-20230812155300614.png" alt="image-20230812155300614"></p><h3 id="5-2-2-UDP的首部"><a href="#5-2-2-UDP的首部" class="headerlink" title="5.2.2 UDP的首部"></a>5.2.2 UDP的首部</h3><p><img src="/.io//image-20230812155331566.png" alt="image-20230812155331566"></p><p><strong><u>计算检验和的时候临时将12字节的伪首部计算，计算完成后丢弃</u></strong></p><p><img src="/.io//image-20230812160908216.png" alt="image-20230812160908216"></p><h2 id="5-3-传输控制协议TCP概述（全双工面向连接）"><a href="#5-3-传输控制协议TCP概述（全双工面向连接）" class="headerlink" title="5.3 传输控制协议TCP概述（全双工面向连接）"></a>5.3 传输控制协议TCP概述（全双工面向连接）</h2><h3 id="5-3-1-TCP概述"><a href="#5-3-1-TCP概述" class="headerlink" title="5.3.1 TCP概述"></a>5.3.1 TCP概述</h3><ul><li>面向连接</li><li>提供可靠传输</li><li>支持一对一通信</li><li>全双工通信</li><li>面向字节流，不保留报文边界</li></ul><h3 id="各种面向连接"><a href="#各种面向连接" class="headerlink" title="各种面向连接"></a>各种面向连接</h3><p><img src="/.io//image-20230812155819063.png" alt="image-20230812155819063"></p><h3 id="5-3-2-TCP的首部"><a href="#5-3-2-TCP的首部" class="headerlink" title="5.3.2 TCP的首部"></a>5.3.2 TCP的首部</h3><p><img src="/.io//image-20230812155956746.png" alt="image-20230812155956746"></p><p>20**<u>字节固定首部</u>**</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">源端口和目的端口：各占</span> <span class="number">2</span> <span class="string">字节。端口是运输层与应用层的服务接口。运输层的复用和分用功能通过端口实现。</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">序号：占</span> <span class="number">4</span> <span class="string">字节。TCP</span> <span class="string">连接中传送的数据流中的每一个字节都有一个序号。序号字段的值则指的是本报文段所发送的数据的第一个字节的序号。</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">确认号：占</span> <span class="number">4</span> <span class="string">字节，是期望收到对方的下一个报文段的数据的第一个字节的序号。</span></span><br><span class="line"></span><br><span class="line"><span class="string">若确认号</span> <span class="string">=</span> <span class="string">N，则表明：到序号</span> <span class="string">N</span> <span class="string">–</span> <span class="number">1</span> <span class="string">为止的所有数据都已正确收到。</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">数据偏移（即首部长度）：占</span> <span class="number">4</span> <span class="string">位，指出</span> <span class="string">TCP</span> <span class="string">报文段的数据起始处距离</span> <span class="string">TCP</span> <span class="string">报文段的起始处有多远。单位是</span> <span class="number">32</span> <span class="string">位字（以</span> <span class="number">4</span> <span class="string">字节为计算单位）</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span><span class="string">.</span> <span class="string">保留：占</span> <span class="number">6</span> <span class="string">位，保留为今后使用，但目前应置为</span> <span class="number">0</span><span class="string">。</span></span><br><span class="line"></span><br><span class="line"><span class="number">6</span><span class="string">.</span> <span class="string">紧急</span> <span class="string">URG：控制位。当</span> <span class="string">URG</span> <span class="string">=</span> <span class="number">1</span> <span class="string">时，表明紧急指针字段有效，告诉系统此报文段中有紧急数据，应尽快传送</span> <span class="string">(相当于高优先级的数据)。</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span><span class="string">.</span> <span class="string">确认</span> <span class="string">ACK：控制位。只有当</span> <span class="string">ACK</span> <span class="string">=1</span> <span class="string">时，确认号字段才有效。当</span> <span class="string">ACK</span> <span class="string">=0</span> <span class="string">时，确认号无效。</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span><span class="string">.</span> <span class="string">推送</span> <span class="string">PSH</span> <span class="string">(PuSH)</span> <span class="string">：控制位。接收</span> <span class="string">TCP</span> <span class="string">收到</span> <span class="string">PSH</span> <span class="string">=</span> <span class="number">1</span> <span class="string">的报文段后，就尽快（即“推送”向前）交付接收应用进程，而不再等到整个缓存都填满后再交付。</span></span><br><span class="line"></span><br><span class="line"><span class="number">9</span><span class="string">.</span> <span class="string">复位</span> <span class="string">RST</span> <span class="string">(ReSeT)</span> <span class="string">：控制位。当</span> <span class="string">RST=1</span> <span class="string">时，表明</span> <span class="string">TCP</span> <span class="string">连接中出现严重差错（如主机崩溃或其他原因），必须释放连接，然后再重新建立运输连接。</span></span><br><span class="line"></span><br><span class="line"><span class="number">10</span><span class="string">.</span> <span class="string">同步</span> <span class="string">SYN</span> <span class="string">(SYNchronization)</span> <span class="string">：控制位。同步</span> <span class="string">SYN</span> <span class="string">=</span> <span class="number">1</span> <span class="string">表示这是一个连接请求或连接接受报文。当</span> <span class="string">SYN</span> <span class="string">=</span> <span class="number">1</span><span class="string">，ACK</span> <span class="string">=</span> <span class="number">0</span> <span class="string">时，表明这是一个连接请求报文段。当</span> <span class="string">SYN</span> <span class="string">=</span> <span class="number">1</span><span class="string">，ACK</span> <span class="string">=</span> <span class="number">1</span> <span class="string">时，表明这是一个连接接受报文段。</span></span><br><span class="line"></span><br><span class="line"><span class="number">11</span><span class="string">.</span> <span class="string">终止</span> <span class="string">FIN</span> <span class="string">(FINish)</span> <span class="string">：控制位。用来释放一个连接。FIN=1</span> <span class="string">表明此报文段的发送端的数据已发送完毕，并要求释放运输连接。</span></span><br><span class="line"></span><br><span class="line"><span class="number">12</span><span class="string">.</span> <span class="string">窗口：占</span> <span class="number">2</span> <span class="string">字节。窗口值告诉对方：从本报文段首部中的确认号算起，接收方目前允许对方发送的数据量（以字节为单位）。</span></span><br><span class="line"></span><br><span class="line"><span class="string">窗口字段明确指出了现在允许对方发送的数据量。窗口值经常在动态变化。</span></span><br><span class="line"></span><br><span class="line"><span class="number">13</span><span class="string">.</span> <span class="string">检验和：占</span> <span class="number">2</span> <span class="string">字节。检验和字段检验的范围包括首部和数据这两部分。在计算检验和时，要在</span> <span class="string">TCP</span> <span class="string">报文段的前面加上</span> <span class="number">12</span> <span class="string">字节的伪首部。</span></span><br><span class="line"></span><br><span class="line"><span class="number">14</span><span class="string">.</span> <span class="string">紧急指针：占</span> <span class="number">2</span> <span class="string">字节。在</span> <span class="string">URG</span> <span class="string">=</span> <span class="number">1</span><span class="string">时，指出本报文段中的紧急数据的字节数（紧急数据结束后就是普通数据），指出了紧急数据的末尾在报文段中的位置。</span></span><br><span class="line"></span><br><span class="line"><span class="number">15</span><span class="string">.</span> <span class="string">选项：长度可变，最长可达</span> <span class="number">40</span> <span class="string">字节。</span></span><br><span class="line"></span><br><span class="line"><span class="number">16</span><span class="string">.</span> <span class="string">填充：使整个</span> <span class="string">TCP</span> <span class="string">首部长度是</span> <span class="number">4</span> <span class="string">字节的整数倍。</span></span><br></pre></td></tr></table></figure><h3 id="发送序号和确认序号的含义"><a href="#发送序号和确认序号的含义" class="headerlink" title="发送序号和确认序号的含义"></a>发送序号和确认序号的含义</h3><p>发送序号：数据载荷中第一个字节在字节的序号</p><p>确认号：期望收到的下一个字节的序号 </p><h3 id="最大报文段MSS"><a href="#最大报文段MSS" class="headerlink" title="最大报文段MSS"></a>最大报文段MSS</h3><p><img src="/.io//image-20230812161113341.png" alt="image-20230812161113341"></p><ul><li>太小网络利用率低</li><li>太大分片的开销大</li></ul><h4 id><a href="#" class="headerlink" title></a></h4><h2 id="5-4-可靠传输的工作原理"><a href="#5-4-可靠传输的工作原理" class="headerlink" title="5.4 可靠传输的工作原理"></a>5.4 可靠传输的工作原理</h2><h3 id="5-4-1-停止等待协议"><a href="#5-4-1-停止等待协议" class="headerlink" title="5.4.1 停止等待协议"></a>5.4.1 停止等待协议</h3><ul><li>每发送完一个分组就停止发送，等待对方的确认</li><li>全双工工作方式下既是发送方又是接收方</li></ul><h4 id="无差错情况"><a href="#无差错情况" class="headerlink" title="无差错情况"></a>无差错情况</h4><p><img src="/.io//image-20230812161740264.png" alt="image-20230812161740264"></p><h4 id="分组错误"><a href="#分组错误" class="headerlink" title="分组错误"></a>分组错误</h4><p><img src="/.io//image-20230812161804355.png" alt="image-20230812161804355"></p><p>b接收到M1时检测出错误并且丢弃</p><h4 id="分组丢失"><a href="#分组丢失" class="headerlink" title="分组丢失"></a>分组丢失</h4><p><img src="/.io//image-20230812161821756.png" alt="image-20230812161821756">M1在传输过程中就丢失了，b不知道也什么都不做</p><p><strong><u>解决方法</u></strong>–<strong>超时重传</strong></p><p><img src="/.io//image-20230812162110026.png" alt="image-20230812162110026"><img src="/.io//image-20230812162126132.png" alt="image-20230812162126132"><img src="/.io//image-20230812162932293.png" alt="image-20230812162932293"></p><p>如果确认信息也丢失了？</p><ul><li>确认丢失</li></ul><p><img src="/.io//image-20230812162408674.png" alt="image-20230812162408674"></p><p>丢弃第二次收到的分组，向a发送确认</p><ul><li>确认迟到</li></ul><p><img src="/.io//image-20230812162946549.png" alt="image-20230812162946549"></p><p>双方都只认第一次</p><p>b丢弃第二次收到的M1，并且重新发送确认信息，a丢弃第二次确认</p><h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><ul><li>停止等待</li><li>暂存，为了重传</li><li>编号</li><li>超时重传</li></ul><h4 id="信道利用率"><a href="#信道利用率" class="headerlink" title="信道利用率"></a>信道利用率</h4><p><img src="/.io//image-20230812163432742.png" alt="image-20230812163432742"></p><p><strong>解决方法</strong></p><p><img src="/.io//image-20230812163451290.png" alt="image-20230812163451290"><img src="/.io//image-20230812163519604.png" alt="image-20230812163519604"></p><h3 id="5-4-2-连续ARQ协议"><a href="#5-4-2-连续ARQ协议" class="headerlink" title="5.4.2 连续ARQ协议"></a>5.4.2 连续ARQ协议</h3><p><img src="/.io//image-20230812163929140.png" alt="image-20230812163929140"></p><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p><img src="/.io//image-20230812163959931.png" alt="image-20230812163959931"></p><h4 id="累计确认"><a href="#累计确认" class="headerlink" title="累计确认"></a>累计确认</h4><p><img src="/.io//image-20230812164129206.png" alt="image-20230812164129206"></p><ul><li>优点：容易实现，确认丢失也不需要重传</li><li>缺点：不能向发 送方反应出接收方已经正确收到的</li></ul><h4 id="Go-back-N"><a href="#Go-back-N" class="headerlink" title="Go-back-N"></a>Go-back-N</h4><p><img src="/.io//image-20230812172657080-1691832419155-1.png" alt="image-20230812172657080"></p><h4 id="与停止等待的对比"><a href="#与停止等待的对比" class="headerlink" title="与停止等待的对比"></a>与停止等待的对比</h4><p><img src="/.io//image-20230812172743718.png" alt="image-20230812172743718"></p><h2 id="5-5-TCP可靠运输的实现"><a href="#5-5-TCP可靠运输的实现" class="headerlink" title="5.5 TCP可靠运输的实现"></a>5.5 TCP可靠运输的实现</h2><h3 id="5-5-1-以字节为单位的滑动窗口"><a href="#5-5-1-以字节为单位的滑动窗口" class="headerlink" title="5.5.1 以字节为单位的滑动窗口"></a>5.5.1 以字节为单位的滑动窗口</h3><ul><li>发送方和接收方各维持一个发送窗口和接收窗口</li><li>发送方根据接收方给出的窗口值构建出自己的发送窗口</li><li>发送窗口里面的序号表示允许发送的序号</li><li>窗口只能往序号大的方向移动和扩张</li></ul><p><img src="/.io//image-20230812173419545-1691832859974-3.png" alt="image-20230812173419545"></p><p><strong><img src="/.io//image-20230812173740468.png" alt="image-20230812173740468"></strong></p><h4 id="窗口的滑动"><a href="#窗口的滑动" class="headerlink" title="窗口的滑动"></a>窗口的滑动</h4><p><img src="/.io//image-20230812173845689.png" alt="image-20230812173845689"></p><p>确认号是还没有收到的数据，是期望接收到的数据的序号</p><p>发送方每收到一个接受确认，就将发送窗口向前滑动一个字节的位置  </p><h4 id="发送缓存"><a href="#发送缓存" class="headerlink" title="发送缓存"></a>发送缓存</h4><p><img src="/.io//image-20230812175414815.png" alt="image-20230812175414815"></p><h4 id="接收缓存"><a href="#接收缓存" class="headerlink" title="接收缓存"></a>接收缓存</h4><p><img src="/.io//image-20230812175613916.png" alt="image-20230812175613916"></p><h3 id="5-5-2-超时重传时间的选择"><a href="#5-5-2-超时重传时间的选择" class="headerlink" title="5.5.2 超时重传时间的选择"></a>5.5.2 超时重传时间的选择</h3><h4 id="加权平均往返时间RTTs"><a href="#加权平均往返时间RTTs" class="headerlink" title="加权平均往返时间RTTs"></a>加权平均往返时间RTTs</h4><p><img src="/.io//image-20230812175755674.png" alt="image-20230812175755674"></p><h4 id="超时重传时间RTO"><a href="#超时重传时间RTO" class="headerlink" title="超时重传时间RTO"></a>超时重传时间RTO</h4><p><img src="/.io//image-20230812175920696.png" alt="image-20230812175920696"></p><h4 id="RTT偏差的加权平均值"><a href="#RTT偏差的加权平均值" class="headerlink" title="RTT偏差的加权平均值"></a>RTT偏差的加权平均值</h4><p><img src="/.io//image-20230812180008096.png" alt="image-20230812180008096"></p><h4 id="Karn算法"><a href="#Karn算法" class="headerlink" title="Karn算法"></a>Karn算法</h4><p><img src="/.io//image-20230812180115248.png" alt="image-20230812180115248"></p><h5 id="修正版"><a href="#修正版" class="headerlink" title="修正版"></a>修正版</h5><p><img src="/.io//image-20230812180141017.png" alt="image-20230812180141017"></p><h3 id="5-5-3-选择确认SACK"><a href="#5-5-3-选择确认SACK" class="headerlink" title="5.5.3 选择确认SACK"></a>5.5.3 选择确认SACK</h3><p>一段数据中中间部分数据未传输，怎么只传输这些数据呢？</p><p><img src="/.io//image-20230812180317612.png" alt="image-20230812180317612"></p><p><img src="/.io//image-20230812180327548.png" alt="image-20230812180327548"></p><h2 id="5-6-TCP的流量控制"><a href="#5-6-TCP的流量控制" class="headerlink" title="5.6 TCP的流量控制"></a>5.6 TCP的流量控制</h2><h3 id="5-6-1-利用滑动窗口实现流量控制"><a href="#5-6-1-利用滑动窗口实现流量控制" class="headerlink" title="5.6.1 利用滑动窗口实现流量控制"></a>5.6.1 利用滑动窗口实现流量控制</h3><p><img src="/.io//image-20230812180818607.png" alt="image-20230812180818607"></p><p>按接收方的接受能力来决定发送方的发送能力</p><p><img src="/.io//640.png" alt="图片"></p><h4 id="持续计时器"><a href="#持续计时器" class="headerlink" title="持续计时器"></a>持续计时器</h4><p>只要 TCP 连接的一方收到对方的零窗口通知，就启动该持续计时器。</p><p>若持续计时器设置的时间到期，就发送一个零窗口探测报文段（仅携带 1 字节的数据），对方在确认这个探测报文段时给出当前窗口值。</p><p>若窗口仍然是零，收到这个报文段的一方就重新设置持续计时器。</p><p>若窗口不是零，则死锁的僵局就可以打破了。</p><h3 id="5-6-2-TCP的传输效率"><a href="#5-6-2-TCP的传输效率" class="headerlink" title="5.6.2 TCP的传输效率"></a>5.6.2 TCP的传输效率</h3><ul><li>缓存中数据到达MSS长度就组装成一个TCP报文段发送出去</li><li>按发送方的应用进程要求发送</li><li>发送方的计时器时间到了将当前的缓存数据发送出去</li></ul><h4 id="糊涂窗口综合征"><a href="#糊涂窗口综合征" class="headerlink" title="糊涂窗口综合征"></a>糊涂窗口综合征</h4><p><img src="/.io//image-20230812183202333.png" alt="image-20230812183202333"></p><h2 id="5-7-TCP的拥塞控制"><a href="#5-7-TCP的拥塞控制" class="headerlink" title="5.7 TCP的拥塞控制"></a>5.7 TCP的拥塞控制</h2><h3 id="5-7-1-拥塞控制的一般原理"><a href="#5-7-1-拥塞控制的一般原理" class="headerlink" title="5.7.1 拥塞控制的一般原理"></a>5.7.1 拥塞控制的一般原理</h3><p>拥塞原因：大量分组短时间进入网络，超过网络的处理能力</p><ol><li>节点缓存容量太小</li><li>链路容量不足</li><li>处理机处理速率太慢</li><li>拥塞本身会进一步加剧拥塞</li><li><strong>资源要求大于供给</strong></li></ol><h4 id="理论解决方法"><a href="#理论解决方法" class="headerlink" title="理论解决方法"></a>理论解决方法</h4><p><img src="/.io//image-20230812183924857.png" alt="image-20230812183924857"></p><p><img src="/.io//image-20230812183948388-1691836788840-7.png" alt="image-20230812183948388"></p><h3 id="5-7-2-TCP的拥塞控制方法"><a href="#5-7-2-TCP的拥塞控制方法" class="headerlink" title="5.7.2 TCP的拥塞控制方法"></a>5.7.2 TCP的拥塞控制方法</h3><p><strong><img src="/.io//image-20230812184138229.png" alt="image-20230812184138229"></strong></p><p>出现拥塞将窗口减少，没有拥塞加大窗口</p><p><strong>拥塞发生依据</strong></p><p>超时重传计时器超时</p><p>收到三个重复的确认</p><h4 id="4种拥塞控制算法"><a href="#4种拥塞控制算法" class="headerlink" title="4种拥塞控制算法"></a>4种拥塞控制算法</h4><ol><li><p><strong>慢开始</strong></p></li><li><p><strong>拥塞避免</strong></p></li><li><p><strong>快重传</strong></p></li><li><p><strong>快恢复</strong></p></li></ol><p>ssthresh是标准，是阈值，cwnd是变量</p><h5 id="慢开始"><a href="#慢开始" class="headerlink" title="慢开始"></a>慢开始</h5><ul><li><p>慢开始就是指数增长（2的n次方）</p></li><li><p>cwnd和门限值的关系：</p><p>（1）当 cwnd &lt; ssthresh 时，使用慢开始算法。（指数）</p><p>（2）当 cwnd &gt; ssthresh 时，停止使用慢开始算法，改用拥塞避免算法。（线性）</p><p>（3）当 cwnd &#x3D; ssthresh 时，既可使用慢开始算法，也可使用拥塞避免算法。（线性）</p></li></ul><h5 id="拥塞避免"><a href="#拥塞避免" class="headerlink" title="拥塞避免"></a>拥塞避免</h5><p>这时候cwnd线性增加</p><p><strong>无论在慢开始阶段还是在拥塞避免阶段，只要发送方判断网络出现拥塞（重传定时器超时）：</strong></p><p><strong>（1）ssthresh &#x3D; max (cwnd&#x2F;2，2)</strong></p><p>**（2）cwnd &#x3D;1</p><p>*不能完全避免拥塞，只能减轻</p><h5 id="快重传"><a href="#快重传" class="headerlink" title="快重传"></a>快重传</h5><p>1.目的：让发送方尽早知道发生了个别报文段的丢失。</p><p>2.发送方只要连续收到三个重复的确认，就立即进行重传（即“快重传”），这样就不会出现超时。</p><p>3.使用快重传可以使整个网络的吞吐量提高约 20%。</p><p>4.快重传算法要求接收方立即发送确认，即使收到了失序的报文段，也要立即发出对已收到的报文段的重复确认。</p><h5 id="收到三个确认后会立即进行快恢复！！！（和拥塞避免有一点点差别）"><a href="#收到三个确认后会立即进行快恢复！！！（和拥塞避免有一点点差别）" class="headerlink" title="收到三个确认后会立即进行快恢复！！！（和拥塞避免有一点点差别）"></a><strong>收到三个确认后会立即进行快恢复</strong>！！！（和拥塞避免有一点点差别）</h5><p>1.慢开始门限 ssthresh &#x3D; 当前拥塞窗口 cwnd &#x2F; 2 ；</p><p>2.乘法减小 MD (Multiplicative Decrease) 拥塞窗口。（？）</p><p> <strong>新拥塞窗口 cwnd &#x3D; 慢开始门限 ssthresh</strong> </p><p>3.执行拥塞避免算法，使拥塞窗口缓慢地线性增大（加法增大 AI）。</p><p><img src="/.io//640-1691842192980-9.png" alt="图片"></p><h2 id="-1"><a href="#-1" class="headerlink" title></a><img src="/.io//640.png" alt="图片"></h2><h2 id="5-8-TCP的运输连接管理"><a href="#5-8-TCP的运输连接管理" class="headerlink" title="5.8 TCP的运输连接管理"></a>5.8 TCP的运输连接管理</h2><h3 id="5-8-1-TCP的连接建立"><a href="#5-8-1-TCP的连接建立" class="headerlink" title="5.8.1 TCP的连接建立"></a>5.8.1 TCP的连接建立</h3><p><strong>采用三报文握手：</strong>在客户和服务器之间交换三个 TCP 报文段，以防止已失效的连接请求报文段突然又传送到了服务器，因而产生TCP连接建立错误。</p><p><img src="/.io//640-1691842456653-12.png" alt="图片"></p><h3 id="5-8-2-TCP的连接释放"><a href="#5-8-2-TCP的连接释放" class="headerlink" title="5.8.2 TCP的连接释放"></a>5.8.2 TCP的连接释放</h3><p>数据传输结束后，通信的双方都可释放连接。</p><p>TCP 连接释放过程是<strong>四报文挥手</strong>。</p><p><img src="/.io//640-1691842471842-15.png" alt="图片">等待2MSL的时间的原因：</p><ol><li>保证发送的最后一个ACK报文段能够到达B</li><li>防止以失效的请求报文段出现在连接中（？）</li></ol><p><strong>保活计时器：</strong>防止在TCP连接中出现长时间空闲</p><h1 id="第六章-应用层"><a href="#第六章-应用层" class="headerlink" title="第六章 应用层"></a>第六章 应用层</h1><h2 id="6-1-域名系统DNS"><a href="#6-1-域名系统DNS" class="headerlink" title="6.1 域名系统DNS"></a>6.1 域名系统DNS</h2><h3 id="6-1-1域名系统概述"><a href="#6-1-1域名系统概述" class="headerlink" title="6.1.1域名系统概述"></a>6.1.1域名系统概述</h3><ol><li><p>域名系统 DNS用来把人们使用的机器名字（域名）转换为 IP 地址。</p></li><li><p>域名采用层次树状结构的命名方法</p></li><li><p>DNS 是一个联机分布式数据库系统，采用客户服务器方式。</p></li><li><p>域名到 IP 地址的解析是由若干个域名服务器程序共同完成。</p></li><li><p>域名服务器程序在专设的结点上运行，运行该程序的机器称为域名服务器</p></li></ol><h3 id="6-1-2-互联网的域名系统"><a href="#6-1-2-互联网的域名系统" class="headerlink" title="6.1.2 互联网的域名系统"></a>6.1.2 互联网的域名系统</h3><ol><li><p>命名方法：层次树状结构方法。</p></li><li><p>任何一个连接在互联网上的主机或路由器，都有一个唯一的层次结构的名字，即域名</p></li><li><p><strong>域 (domain)：</strong></p></li></ol><p>（1）名字空间中一个可被管理的划分。</p><p>（2）可以划分为子域，而子域还可继续划分为子域的子域，这样就形成了<strong>顶级域、二级域、三级域</strong>，等等。</p><ol start="4"><li><strong>域名结构：</strong>层次结构。由标号序列组成，各标号之间用点（.）隔开，各标号分别代表不同级别的域名</li></ol><p><img src="/.io//640-1691844012684-18.png" alt="图片"></p><h3 id="6-1-3-域名服务器"><a href="#6-1-3-域名服务器" class="headerlink" title="6.1.3 域名服务器"></a>6.1.3 域名服务器</h3><h4 id="区的不同划分"><a href="#区的不同划分" class="headerlink" title="区的不同划分"></a>区的不同划分</h4><p>区等于域，区小于域</p><p><img src="/.io//image-20230812204224682.png" alt="image-20230812204224682"></p><h4 id="树状结构的域名服务器"><a href="#树状结构的域名服务器" class="headerlink" title="树状结构的域名服务器"></a>树状结构的域名服务器</h4><p><img src="/.io//image-20230812204259630.png" alt="image-20230812204259630"></p><h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><p><img src="/.io//image-20230812204320673.png" alt="image-20230812204320673"></p><h4 id="域名的解析过程"><a href="#域名的解析过程" class="headerlink" title="域名的解析过程"></a>域名的解析过程</h4><p>靠自己&#x2F;靠别人</p><h5 id="递归查询（靠别人）"><a href="#递归查询（靠别人）" class="headerlink" title="递归查询（靠别人）"></a>递归查询（靠别人）</h5><p>通常，主机向本地域名服务器查询时使用，若不知道，就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文。</p><p><img src="/.io//640-1691844285446-21.png" alt="图片"></p><h5 id="迭代查询（靠自己）"><a href="#迭代查询（靠自己）" class="headerlink" title="迭代查询（靠自己）"></a>迭代查询（靠自己）</h5><p>本地域名服务器向根域名服务器查询时使用，要么给出所要查询的 IP 地址，要么告诉下一个要查询的域名服务器的 IP 地址，本地域名服务器继续后续查询</p><p><img src="/.io//640-1691844309746-24.png" alt="图片"></p><h4 id="高速缓存域名服务器"><a href="#高速缓存域名服务器" class="headerlink" title="高速缓存域名服务器"></a>高速缓存域名服务器</h4><p>存放最近用过的名字以及从何处获得名字映射信息的记录。</p><p>作用：大大减轻根域名服务器的负荷，使 DNS 查询请求和回答报文的数量大为减少。</p><h2 id="6-2-文件传送协议FTP"><a href="#6-2-文件传送协议FTP" class="headerlink" title="6.2 文件传送协议FTP"></a>6.2 文件传送协议FTP</h2><p><strong>使用了TCP</strong></p><h3 id="6-2-1-FTP概述"><a href="#6-2-1-FTP概述" class="headerlink" title="6.2.1 FTP概述"></a>6.2.1 FTP概述</h3><p><img src="/.io//image-20230812204746175.png" alt="image-20230812204746175"></p><h4 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h4><p><img src="/.io//image-20230812204817385.png" alt="image-20230812204817385"><img src="/.io//image-20230812204827665.png" alt="image-20230812204827665"></p><h4 id="主进程工作步骤"><a href="#主进程工作步骤" class="headerlink" title="主进程工作步骤"></a>主进程工作步骤</h4><p><img src="/.io//image-20230812205039858.png" alt="image-20230812205039858"></p><h4 id="6-2-3-简单文件传送协议TFTP"><a href="#6-2-3-简单文件传送协议TFTP" class="headerlink" title="6.2.3 简单文件传送协议TFTP"></a>6.2.3 简单文件传送协议TFTP</h4><p><strong>概述</strong></p><p><img src="/.io//image-20230812205255268.png" alt="image-20230812205255268"><strong>特点</strong></p><p><img src="/.io//image-20230812205324981.png" alt="image-20230812205324981"></p><h2 id="6-3-远程终端协议TELNET"><a href="#6-3-远程终端协议TELNET" class="headerlink" title="6.3 远程终端协议TELNET"></a>6.3 远程终端协议TELNET</h2><p>使用TCP</p><p><strong>概述</strong></p><p><strong><img src="/.io//image-20230812205408164.png" alt="image-20230812205408164"></strong></p><p><strong>TELNET使用网络虚拟终端NVT格式</strong></p><h2 id="6-4-万维网www"><a href="#6-4-万维网www" class="headerlink" title="6.4 万维网www"></a>6.4 万维网www</h2><h3 id="6-4-1-万维网概述"><a href="#6-4-1-万维网概述" class="headerlink" title="6.4.1 万维网概述"></a>6.4.1 万维网概述</h3><ol><li><p>万维网 WWW (World Wide Web) 是一个大规模的、联机式的信息储藏所，并非某种特殊的计算机网络</p></li><li><p>访问方法：链接</p></li><li><p>提供分布式服务</p></li><li><p>万维网的工作方式：客户服务器方式</p></li></ol><h3 id="6-4-2-统一资源定位符URL"><a href="#6-4-2-统一资源定位符URL" class="headerlink" title="6.4.2 统一资源定位符URL"></a>6.4.2 统一资源定位符URL</h3><p><strong>URL 的格式：</strong>由以冒号（:）隔开的两大部分组成，对字符大写或小写没有要求</p><p>一般形式：<img src="/.io//640-1691845110901-27.png" alt="图片"></p><h3 id="6-4-3-超文本传送协议http"><a href="#6-4-3-超文本传送协议http" class="headerlink" title="6.4.3 超文本传送协议http"></a>6.4.3 超文本传送协议http</h3><p>HTTP 使用了面向连接的 TCP 作为运输层协议，保证了数据的可靠传输。</p><p>HTTP 协议本身是无连接的。</p><p><strong>代理服务器（万维网高速缓存）：</strong></p><p>它代表浏览器发出 HTTP 请求，使用高速缓存可减少访问互联网服务器的时延。</p><p><strong>类似于高速缓存域名服务器</strong></p><h3 id="6-4-4-万维网的文档"><a href="#6-4-4-万维网的文档" class="headerlink" title="6.4.4 万维网的文档"></a>6.4.4 万维网的文档</h3><p>在一个客户程序主窗口上显示出的万维网文档称为页面 (page)。</p><p>页面制作的标准语言：HTML。</p><p><strong>注：HTML 不是应用层的协议，它只是万维网浏览器使用的一种语言。</strong></p><p><strong>想起了配置博客的痛苦时光</strong></p><h3 id="6-4-5-万维网的信息检索系统"><a href="#6-4-5-万维网的信息检索系统" class="headerlink" title="6.4.5 万维网的信息检索系统"></a>6.4.5 万维网的信息检索系统</h3><p>在万维网中用来进行搜索的程序叫做搜索引擎，分为全文检索搜索和分类目录搜索。</p><h3 id="6-4-6-博客和微博"><a href="#6-4-6-博客和微博" class="headerlink" title="6.4.6 博客和微博"></a>6.4.6 博客和微博</h3><p><img src="/.io//image-20230812210104614.png" alt="image-20230812210104614"></p><p><img src="/.io//image-20230812210133543.png" alt="image-20230812210133543"></p><h3 id="6-4-7-社交网络"><a href="#6-4-7-社交网络" class="headerlink" title="6.4.7 社交网络"></a>6.4.7 社交网络</h3><p><img src="/.io//image-20230812210147387.png" alt="image-20230812210147387"></p><p>栗子：osu</p><h2 id="6-5-电子邮件"><a href="#6-5-电子邮件" class="headerlink" title="6.5 电子邮件"></a>6.5 电子邮件</h2><p>电子邮件 (e-mail)：指使用电子设备交换的邮件及其方法。</p><p><strong>优点：</strong>使用方便，传递迅速，费用低廉，可以传送多种类型的信息（包括：文字信息，声音和图像等）</p><p><strong>电子邮件系统的组成：</strong></p><ol><li><p>用户代理（用户与电子邮件系统的接口，又被称为电子邮件客户端软件）</p></li><li><p>邮件服务器（发送和接收邮件，同时还要向发信人报告邮件传送的情况，又被称为邮件传输代理，按照客户服务器方式工作）</p></li><li><p>邮件发送和读取协议（简单邮件发送协议 SMTP：用于在用户代理向邮件服务器或邮件服务器之间发送邮件。邮局协议 POP3：用于用户代理从邮件服务器读取邮件）</p></li></ol><p><strong>发送和接收电子邮件的步骤：</strong></p><p><img src="/.io//640-1691845352215-30.png" alt="图片"></p><h2 id="6-6-动态主机配置协议DHCP"><a href="#6-6-动态主机配置协议DHCP" class="headerlink" title="6.6 动态主机配置协议DHCP"></a>6.6 动态主机配置协议DHCP</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ol><li><p>动态主机配置协议 DHCP提供了即插即用连网的机制，允许一台计算机加入网络和获取 IP 地址，而不用手工配置。</p></li><li><p>DHCP 使用客户服务器方式，采用请求&#x2F;应答方式工作</p></li><li><p>DHCP 基于 UDP 工作，DHCP 服务器运行在 67 号端口， DHCP客户运行在 68 号端口。</p></li></ol><h3 id="DHCP中继代理"><a href="#DHCP中继代理" class="headerlink" title="DHCP中继代理"></a>DHCP中继代理</h3><p><img src="/.io//640-1691845812347-33.png" alt="图片"></p><p>DHCP 中继代理收到主机广播发送的发现报文后，就以单播方式向 DHCP 服务器转发此报文，并等待其回答，收到 DHCP 服务器回答的提供报文后，DHCP 中继代理再将其发回给主机。</p><ul><li>每个网络上不都需要DHCP服务器</li><li>每一个网络至少有一个DHCP中继代理，它配置了DHCP服务器的IP地址信息</li></ul><h3 id="DHCP协议的工作过程"><a href="#DHCP协议的工作过程" class="headerlink" title="DHCP协议的工作过程"></a>DHCP协议的工作过程</h3><p><img src="/.io//640-1691845964843-36.png" alt="图片"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. DHCP 服务器被动打开 UDP 端口 67，等待客户端发来的报文。</span><br><span class="line"></span><br><span class="line">2. DHCP 客户从 UDP 端口 68 发送 DHCP 发现报文 DHCPDISCOVER。</span><br><span class="line"></span><br><span class="line">3. 凡收到 DHCP 发现报文的 DHCP 服务器都发出 DHCP 提供报文 DHCPOFFER，因此 DHCP 客户可能收到多个 DHCP 提供报文 。</span><br><span class="line"></span><br><span class="line">4. DHCP 客户从几个 DHCP 服务器中选择其中的一个，并向所选择的 DHCP 服务器发送 DHCP 请求报文 DHCPREQUEST。</span><br><span class="line"></span><br><span class="line">5. 被选择的 DHCP 服务器发送确认报文 DHCPACK，DHCP 客户可开始使用得到的临时 IP 地址了，进入已绑定状态。DHCP 客户现在要根据服务器提供的租用期 T 设置两个计时器 T1 和 T2，它们的超时时间分别是 0.5T 和 0.875T。当超时时间到时，就要请求更新租用期。</span><br><span class="line"></span><br><span class="line">6. 租用期过了一半（T1 时间到），DHCP 发送请求报文 DHCPREQUEST，要求更新租用期。</span><br><span class="line"></span><br><span class="line">7. DHCP 服务器若同意，则发回确认报文 DHCPACK。DHCP 客户得到了新的租用期，重新设置计时器。</span><br><span class="line"></span><br><span class="line">8. DHCP 服务器若不同意，则发回否认报 DHCPNACK。这时 DHCP 客户必须立即停止使用原来的 IP 地址，而必须重新申请 IP 地址（回到步骤2）。若 DHCP 服务器不响应步骤6的请求报文 DHCPREQUEST，则在租用期过了 87.5% 时 (T2 时间到)，DHCP 客户必须重新发送请求报文 DHCPREQUEST（重复步骤6），然后又继续后面的步骤。</span><br><span class="line"></span><br><span class="line">9. DHCP 客户可随时提前终止服务器所提供的租用期，这时只需向 DHCP 服务器发送释放报文 DHCPRELEASE 即可。</span><br></pre></td></tr></table></figure><h2 id="6-7-简单网络管理协议SNMP"><a href="#6-7-简单网络管理协议SNMP" class="headerlink" title="6.7 简单网络管理协议SNMP"></a>6.7 简单网络管理协议SNMP</h2><h3 id="6-7-1-网络管理的基本概念"><a href="#6-7-1-网络管理的基本概念" class="headerlink" title="6.7.1 网络管理的基本概念"></a>6.7.1 网络管理的基本概念</h3><p><img src="/.io//image-20230812212126877.png" alt="image-20230812212126877"></p><h4 id="被管对象"><a href="#被管对象" class="headerlink" title="被管对象"></a>被管对象</h4><p><img src="/.io//image-20230812212213600.png" alt="image-20230812212213600"></p><h4 id="网络管理协议"><a href="#网络管理协议" class="headerlink" title="网络管理协议"></a>网络管理协议</h4><p><img src="/.io//image-20230812212251871.png" alt="image-20230812212251871"></p><h3 id="6-7-2-管理信息结构SMI"><a href="#6-7-2-管理信息结构SMI" class="headerlink" title="6.7.2 管理信息结构SMI"></a>6.7.2 管理信息结构SMI</h3><p><img src="/.io//image-20230812212323067.png" alt="image-20230812212323067"></p><p><strong>功能</strong></p><ol><li>被管对象命名</li><li>储存被管对象的数据类型有哪些</li><li>管理数据怎么编码</li></ol><h3 id="6-7-3-管理信息库MIB（略）"><a href="#6-7-3-管理信息库MIB（略）" class="headerlink" title="6.7.3 管理信息库MIB（略）"></a>6.7.3 管理信息库MIB（略）</h3><h3 id="6-7-4-SNMP的协议数据单元和报文"><a href="#6-7-4-SNMP的协议数据单元和报文" class="headerlink" title="6.7.4 SNMP的协议数据单元和报文"></a>6.7.4 SNMP的协议数据单元和报文</h3><p><img src="/.io//image-20230812212513276.png" alt="image-20230812212513276"><img src="/.io//image-20230812212616304.png" alt="image-20230812212616304"></p><h4 id="陷阱"><a href="#陷阱" class="headerlink" title="陷阱"></a>陷阱</h4><p><img src="/.io//image-20230812212646703.png" alt="image-20230812212646703"></p><h4 id="报文格式"><a href="#报文格式" class="headerlink" title="报文格式"></a>报文格式</h4><p><img src="/.io//image-20230812212724355.png" alt="image-20230812212724355"></p><h2 id="6-8-应用进程跨越网络的通信"><a href="#6-8-应用进程跨越网络的通信" class="headerlink" title="6.8 应用进程跨越网络的通信"></a>6.8 应用进程跨越网络的通信</h2><h3 id="6-8-1-系统调用和应用编程接口"><a href="#6-8-1-系统调用和应用编程接口" class="headerlink" title="6.8.1 系统调用和应用编程接口"></a>6.8.1 系统调用和应用编程接口</h3><h4 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h4><p><img src="/.io//image-20230812213014751.png" alt="image-20230812213014751"></p><p><img src="/.io//image-20230812213004210.png" alt="image-20230812213004210"></p><h4 id="应用编程接口"><a href="#应用编程接口" class="headerlink" title="应用编程接口"></a>应用编程接口</h4><p><img src="/.io//image-20230812212915430.png" alt="image-20230812212915430"></p><h5 id="种类"><a href="#种类" class="headerlink" title="种类"></a>种类</h5><p><img src="/.io//image-20230812212933833.png" alt="image-20230812212933833"></p><p><strong>应用进程通过套接字接入到网络</strong></p><h4 id="套接字作用"><a href="#套接字作用" class="headerlink" title="套接字作用"></a>套接字作用</h4><p><img src="/.io//image-20230812213156041.png" alt="image-20230812213156041"></p><h2 id="6-9-P2P应用"><a href="#6-9-P2P应用" class="headerlink" title="6.9 P2P应用"></a>6.9 P2P应用</h2><h3 id="6-9-1-具有集中目录服务器的P2P工作方式（Napster）"><a href="#6-9-1-具有集中目录服务器的P2P工作方式（Napster）" class="headerlink" title="6.9.1 具有集中目录服务器的P2P工作方式（Napster）"></a>6.9.1 具有集中目录服务器的P2P工作方式（Napster）</h3><p>最早的P2P技术</p><h3 id="6-9-2-具有全分布方式结构的P2P文件共享程序（eMule）"><a href="#6-9-2-具有全分布方式结构的P2P文件共享程序（eMule）" class="headerlink" title="6.9.2 具有全分布方式结构的P2P文件共享程序（eMule）"></a>6.9.2 具有全分布方式结构的P2P文件共享程序（eMule）</h3><p>使用分散定位和分散传输技术</p><h3 id="6-9-3-P2P文件分发的分析（略）"><a href="#6-9-3-P2P文件分发的分析（略）" class="headerlink" title="6.9.3 P2P文件分发的分析（略）"></a>6.9.3 P2P文件分发的分析（略）</h3><h1 id="第三次作业改正"><a href="#第三次作业改正" class="headerlink" title="第三次作业改正"></a>第三次作业改正</h1><p><img src="/.io//image-20230812215039154.png" alt="image-20230812215039154"></p><p>第一个报文丢失，b要求a重发这个报文段，而确认号就是b想要的报文段的序号</p><p>所以是100</p><p><img src="/.io//image-20230812215153679.png" alt="image-20230812215153679"></p><p>第一次1</p><p>第二次2</p><p>3–4</p><p>4–8</p><p>5–9</p><p>6–10</p><p>7–1（门限值变成4）</p><p>8–2</p><p>9–4</p><p>10–5</p><p>11–6</p><p>大小为6</p><p><img src="/.io//image-20230812215358639.png" alt="image-20230812215358639"></p><p>贝多芬题</p><p><img src="/.io//image-20230812215432062.png" alt="image-20230812215432062"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;第五章-运输层&quot;&gt;&lt;a href=&quot;#第五章-运输层&quot; class=&quot;headerlink&quot; title=&quot;第五章 运输层&quot;&gt;&lt;/a&gt;第五章 运输层&lt;/h1&gt;&lt;h2 id=&quot;5-1-运输层解决的问题&quot;&gt;&lt;a href=&quot;#5-1-运输层解决的问题&quot; class=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/2023017--%E5%BC%A0%E5%81%A5--%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%AC%94%E8%AE%B0/"/>
    <id>http://charles-webebr.github.io/2024/07/10/2023017--%E5%BC%A0%E5%81%A5--%E7%AC%AC%E4%BA%8C%E6%AC%A1%E7%AC%94%E8%AE%B0/</id>
    <published>2024-07-10T07:22:46.109Z</published>
    <updated>2023-09-17T09:00:29.620Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第四章-网络层"><a href="#第四章-网络层" class="headerlink" title="第四章 网络层"></a>第四章 网络层</h1><h2 id="网络层解决了什么问题"><a href="#网络层解决了什么问题" class="headerlink" title="网络层解决了什么问题"></a>网络层解决了什么问题</h2><p><img src="/.io//image-20230808141049355.png" alt="image-20230808141049355"></p><h2 id="4-1-网络层提供的两种服务"><a href="#4-1-网络层提供的两种服务" class="headerlink" title="4.1 网络层提供的两种服务"></a>4.1 网络层提供的两种服务</h2><p>观点一：网络负责可靠交付（虚电路———逻辑链接）</p><p><img src="/.io//image-20230806211230128.png" alt="image-20230806211230128"></p><p>很容易发生数据的丢失</p><p><img src="/.io//image-20230806211535386.png" alt="image-20230806211535386"></p><p>观点二：网络提供数据报服务</p><p><img src="/.io//image-20230806211626416.png" alt="image-20230806211626416"></p><p><strong>由更高层负责可靠通信（运输层）</strong></p><p>问题是会产生失序问题，但是网络健壮性增强了</p><p><strong>虚电路和数据报服务的对比</strong></p><p> <img src="/.io//image-20230806212312552.png" alt="image-20230806212312552"></p><p><img src="/.io//image-20230806212321164.png" alt="image-20230806212321164"></p><h2 id="4-2-网际协议IP"><a href="#4-2-网际协议IP" class="headerlink" title="4.2 网际协议IP"></a>4.2 网际协议IP</h2><h3 id="4-2-1-虚拟互连网络"><a href="#4-2-1-虚拟互连网络" class="headerlink" title="4.2.1 虚拟互连网络"></a>4.2.1 虚拟互连网络</h3><h4 id="不同网络的差异"><a href="#不同网络的差异" class="headerlink" title="不同网络的差异"></a>不同网络的差异</h4><p><strong><img src="/.io//image-20230806212752293.png" alt="image-20230806212752293"></strong></p><p>通过使用中间设备来互连不同的网络—路由器（网络层）</p><h4 id="各种中间设备"><a href="#各种中间设备" class="headerlink" title="各种中间设备"></a>各种中间设备</h4><p><img src="/.io//image-20230806213117006-1691328677767-1.png" alt="image-20230806213117006"></p><p>中继器和集线器是物理层设备</p><h4 id="IP协议"><a href="#IP协议" class="headerlink" title="IP协议"></a>IP协议</h4><p><img src="/.io//image-20230806213247881.png" alt="image-20230806213247881"></p><p><img src="/.io//image-20230806213257734.png" alt="image-20230806213257734"></p><p>***IGMP？</p><p><img src="/.io//image-20230806213403935.png" alt="image-20230806213403935"></p><p>数据实际上运输会由上往下封装再由下往上解码运输，但是</p><h3 id="4-2-2-IP数据报的格式"><a href="#4-2-2-IP数据报的格式" class="headerlink" title="4.2.2 IP数据报的格式"></a>4.2.2 IP数据报的格式</h3><p><img src="/.io//image-20230806214222431.png" alt="image-20230806214222431"></p><p>IP数据报分为首部和数据两部分，其中首部分为固定部分20字节和可变部分</p><h4 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h4><p>前4个字节是协议版本，例如IPv4</p><h4 id="首部长度"><a href="#首部长度" class="headerlink" title="首部长度"></a>首部长度</h4><p>一比特代表4字节</p><p>为1111时首部长15*4&#x3D;60字节</p><h4 id="区分服务"><a href="#区分服务" class="headerlink" title="区分服务"></a>区分服务</h4><p>一般不用</p><h4 id="总长度"><a href="#总长度" class="headerlink" title="总长度"></a>总长度</h4><p>首部+数据的长度，一比特为一字节</p><p>最大为2的16次方-1字节，但是实际上传输不了这么多—MTU限制总长度，那么就要将数据分片传输</p><h4 id="标识位"><a href="#标识位" class="headerlink" title="标识位"></a>标识位</h4><p>为了将分片的数据能够准确无误的重组</p><p><strong>所有分片都有相同的标识</strong></p><h4 id="标志"><a href="#标志" class="headerlink" title="标志"></a>标志</h4><p>为了将分片的数据能够准确无误的重组</p><p><strong>标志位中有保留位，待开发</strong></p><p>MF位：more fragment（是否最后分片），1表示后面还有分片，反之没有</p><p><img src="/.io//image-20230806220909198.png" alt="image-20230806220909198"></p><p>DF位：don‘t fragment（是否允许分片），1表示没有分片，0表示分片</p><p><img src="/.io//image-20230806220920117.png" alt="image-20230806220920117"></p><h4 id="片偏移"><a href="#片偏移" class="headerlink" title="片偏移"></a>片偏移</h4><p>为了将分片的数据能够准确无误的重组</p><p><strong>判断给数据开🔪的地方在哪里</strong></p><p><strong><u>栗子</u>：</strong></p><p><img src="/.io//image-20230806220507327.png" alt="image-20230806220507327"></p><p>每个MTU里面包括20字节的首部和1480字节的数据，增加了首部开销</p><p>问题：为什么不把分组平均</p><p>答：避免头重脚轻，浪费首部</p><h5 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h5><p><img src="/.io//image-20230806221237407.png" alt="image-20230806221237407"></p><p>数据的尾巴除以8得到偏移量 </p><h4 id="生存时间"><a href="#生存时间" class="headerlink" title="生存时间"></a>生存时间</h4><p>路由器之间传递一次叫<strong>跳</strong></p><p>生存时间就是规定这个跳的次数</p><p>不同的操作系统这个TTL（生存时间）值不同</p><p><em><strong><u>目的是不让数据在网络上无休止的浪费资源</u></strong></em></p><h4 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h4><p>协议负责指出数据部分应该交给上层的哪个部分</p><p><img src="/.io//image-20230806222222105.png" alt="image-20230806222222105"></p><h4 id="首部校验和"><a href="#首部校验和" class="headerlink" title="首部校验和"></a>首部校验和</h4><p>只对首部的部分进行校验，首部变了校验和也发生变化，不用管数据部分，错了让运输层想办法</p><p><img src="/.io//image-20230806222448510.png" alt="image-20230806222448510"></p><h4 id="源地址，目的地址"><a href="#源地址，目的地址" class="headerlink" title="源地址，目的地址"></a>源地址，目的地址</h4><p>一个接口一个IP地址，32位的二进制地址</p><h4 id="可选字段"><a href="#可选字段" class="headerlink" title="可选字段"></a>可选字段</h4><p>不怎么用</p><h4 id="IP协议功能及报头字段总结"><a href="#IP协议功能及报头字段总结" class="headerlink" title="IP协议功能及报头字段总结"></a>IP协议功能及报头字段总结</h4><p><img src="/.io//image-20230806223210166.png" alt="image-20230806223210166"></p><p>以上首部各部分功能</p><h2 id="4-2-3-IP地址"><a href="#4-2-3-IP地址" class="headerlink" title="4.2.3 IP地址"></a>4.2.3 IP地址</h2><p>IP是啥？你家的经纬度~</p><p><img src="/.io//image-20230806223603213.png" alt="image-20230806223603213"></p><p>32位还是少了</p><h5 id="IP地址采用2级结构"><a href="#IP地址采用2级结构" class="headerlink" title="IP地址采用2级结构"></a><strong>IP地址采用2级结构</strong></h5><p><img src="/.io//image-20230806224526292.png" alt="image-20230806224526292"></p><p>哪一个网络的哪一台主机？</p><p><img src="/.io//image-20230806224635807.png" alt="image-20230806224635807"></p><h5 id="分级地址优点"><a href="#分级地址优点" class="headerlink" title="分级地址优点"></a>分级地址优点</h5><p>方便分配和数据转发</p><p><img src="/.io//image-20230806224902585.png" alt="image-20230806224902585"></p><h5 id="点分十进制"><a href="#点分十进制" class="headerlink" title="点分十进制"></a>点分十进制</h5><p><img src="/.io//image-20230806225032707.png" alt="image-20230806225032707"></p><p>一个字节一个部分</p><h4 id="分类的IP地址（old）"><a href="#分类的IP地址（old）" class="headerlink" title="分类的IP地址（old）"></a>分类的IP地址（old）</h4><p><img src="/.io//image-20230806225250534.png" alt="image-20230806225250534"></p><p>类别判断：A类第一个比特是0，B类前两位是10，c类前三位是110；A类网络地址8位，B类16位，C类24位</p><h6 id="以A类地址为例"><a href="#以A类地址为例" class="headerlink" title="以A类地址为例"></a>以A类地址为例</h6><p><img src="/.io//image-20230806225710816.png" alt="image-20230806225710816"></p><p>网络地址除了标识符以外，全1表示用于本地软件环回测试，全0代表本网络（？）</p><p>主机地址全1表示该网络的所有主机（广播），全0代表主机所在的网络地址（84.0.0.0）</p><h6 id="网络大小"><a href="#网络大小" class="headerlink" title="网络大小"></a><strong>网络大小</strong></h6><p>这个网络大小差别太大，可能会取上不足取下有余，分配不灵活</p><p><img src="/.io//image-20230806230132160.png" alt="image-20230806230132160"></p><h6 id="不可分配地址"><a href="#不可分配地址" class="headerlink" title="不可分配地址"></a><strong>不可分配地址</strong></h6><p><img src="/.io//image-20230806230218512.png" alt="image-20230806230218512"></p><h4 id="子网划分（subnetting）"><a href="#子网划分（subnetting）" class="headerlink" title="子网划分（subnetting）"></a>子网划分（subnetting）</h4><p>就是使得划分标准增加以便合理调整网络大小<img src="/.io//image-20230806230730738.png" alt="image-20230806230730738"></p><p>栗子：</p><p><img src="/.io//image-20230806230913588.png" alt="image-20230806230913588"></p><p>这样就能按照用户需求diy网络大小了</p><h6 id="子网掩码（可变VLSM？）"><a href="#子网掩码（可变VLSM？）" class="headerlink" title="子网掩码（可变VLSM？）"></a>子网掩码（可变VLSM？）</h6><p><img src="/.io//image-20230806231804265.png" alt="image-20230806231804265"></p><p>掩码用来计算网络地址</p><p>网络和子网位为1，主机位为0，再把掩码和IP地址AND一下后，仅保留网络地址（路由器要用）</p><h6 id="IP地址是否在同一个网络"><a href="#IP地址是否在同一个网络" class="headerlink" title="IP地址是否在同一个网络"></a>IP地址是否在同一个网络</h6><ul><li><p>子网掩码的位数相等</p></li><li><p>网络地址每一位都相同</p></li></ul><h6 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h6><p><img src="/.io//image-20230806232354376.png" alt="image-20230806232354376"></p><p><strong>解决了网络过大的问题，没有解决网络太小的问题</strong></p><h4 id="无分类编制方法CIDR（new）"><a href="#无分类编制方法CIDR（new）" class="headerlink" title="无分类编制方法CIDR（new）"></a>无分类编制方法CIDR（new）</h4><p><img src="/.io//image-20230806232545705.png" alt="image-20230806232545705"></p><p><strong>网络前缀可以变长度</strong></p><h5 id="CIDR用掩码表示网络前缀的长度"><a href="#CIDR用掩码表示网络前缀的长度" class="headerlink" title="CIDR用掩码表示网络前缀的长度"></a>CIDR用掩码表示网络前缀的长度</h5><p><img src="/.io//image-20230806232941019.png" alt="image-20230806232941019"></p><h5 id="三个特殊地址块"><a href="#三个特殊地址块" class="headerlink" title="三个特殊地址块"></a>三个特殊地址块</h5><p><img src="/.io//image-20230807000645119.png" alt="image-20230807000645119"></p><h5 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h5><ul><li><strong>构造超网</strong></li></ul><p><img src="/.io//image-20230807000813594.png" alt="image-20230807000813594"></p><p><img src="/.io//image-20230807004212535.png" alt="image-20230807004212535"></p><p>分地址块就是把小数点往后面移动，构造超网就是左移（？ ）</p><ul><li><strong>减少路由条目</strong></li></ul><p><img src="/.io//image-20230807004706061.png" alt="image-20230807004706061"></p><p>地址数量也没有增加</p><h3 id="IP地址的特点"><a href="#IP地址的特点" class="headerlink" title="IP地址的特点"></a>IP地址的特点</h3><ul><li>每个IP地址都由网络前缀和主机号两部分组成<img src="/.io//image-20230807005239784.png" alt="image-20230807005239784"></li><li>IP地址是标志一台主机（或路由器）和一条链路的接口</li></ul><p><img src="/.io//image-20230807005258395.png" alt="image-20230807005258395"></p><ul><li>转发器或交换机连起来的若干个局域网仍为一个网络<img src="/.io//image-20230807005354436.png" alt="image-20230807005354436"></li><li>在IP地址中，所有分配到网络前缀的网络都是平等的</li></ul><h2 id="4-3-IP分组的转发"><a href="#4-3-IP分组的转发" class="headerlink" title="4.3 IP分组的转发"></a>4.3 IP分组的转发</h2><h3 id="路由器分组转发算法"><a href="#路由器分组转发算法" class="headerlink" title="路由器分组转发算法"></a>路由器分组转发算法</h3><p><img src="/.io//image-20230807111631247.png" alt="image-20230807111631247">255.255.255.255是广播地址但是发送这个的资源要求太大，一般情况下属于受限地址，只有直接地址可以转发</p><h3 id="4-3-1-基于终点的转发"><a href="#4-3-1-基于终点的转发" class="headerlink" title="4.3.1 基于终点的转发"></a>4.3.1 基于终点的转发</h3><p><img src="/.io//image-20230807101322460.png" alt="image-20230807101322460"></p><h6 id="路由器转发表包含哪些信息？"><a href="#路由器转发表包含哪些信息？" class="headerlink" title="路由器转发表包含哪些信息？"></a><strong>路由器转发表包含哪些信息？</strong></h6><ul><li>终点地址</li><li>下一跳地址</li></ul><p>*都是目的网络地址，为节约路由表空间</p><h6 id="栗子"><a href="#栗子" class="headerlink" title="栗子"></a><strong>栗子</strong></h6><p><img src="/.io//image-20230807103230926.png" alt="image-20230807103230926"></p><h6 id="转发步骤"><a href="#转发步骤" class="headerlink" title="转发步骤"></a>转发步骤</h6><p><img src="/.io//image-20230807103438419.png" alt="image-20230807103438419"></p><h6 id="问题：掩码从哪来？"><a href="#问题：掩码从哪来？" class="headerlink" title="问题：掩码从哪来？"></a>问题：掩码从哪来？</h6><p> IP首部不能更改，但是路由表还可以更改，在转发表地址加一个后缀即可，如128.0.0.12&#x2F;24</p><p>将目的地址和掩码AND后的网络号相同则转发，不同则跳过，比对下一条，全部不匹配则丢弃</p><p><img src="/.io//image-20230808141625182.png" alt="image-20230808141625182"></p><h3 id="4-3-2-最长前缀匹配"><a href="#4-3-2-最长前缀匹配" class="headerlink" title="4.3.2 最长前缀匹配"></a>4.3.2 最长前缀匹配</h3><p>查找转发表的过程就是逐行寻找前缀匹配</p><p>使用CIDR时，<strong>查找转发表时可能会得到不同的匹配结果</strong>，子网掩码越大越精确(网络地址最长)</p><p>一般出现这种情况，网络有包含关系，例如学校的哪一个班</p><p><img src="/.io//image-20230807110520624.png" alt="image-20230807110520624"><strong>前缀最长的排更前面</strong></p><p><strong>特殊路由</strong></p><ul><li>主机路由a.b.c.d&#x2F;32—转发表最前面</li><li>默认路由0.0.0.0&#x2F;0—转发表最后面（兜底）</li></ul><h6 id="二叉线索查找"><a href="#二叉线索查找" class="headerlink" title="二叉线索查找"></a>二叉线索查找</h6><p><img src="/.io//image-20230807141640178.png" alt="image-20230807141640178"></p><h3 id="4-3-3-IP地址与MAC地址"><a href="#4-3-3-IP地址与MAC地址" class="headerlink" title="4.3.3 IP地址与MAC地址"></a>4.3.3 IP地址与MAC地址</h3><p>网络层已经有了IP地址，那么MAC地址还有用吗？</p><p><strong>上层的工作要依靠下层的服务</strong></p><p><img src="/.io//image-20230807141846232.png" alt="image-20230807141846232"></p><h5 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h5><p><img src="/.io//image-20230807142034635.png" alt="image-20230807142034635"></p><p><img src="/.io//image-20230808141221807.png" alt="image-20230808141221807"></p><p>那么怎么知道下一个路由器的MAC地址是多少呢？（由IP得到MAC地址–ARP协议）</p><h3 id="4-3-4-地址解析协议ARP"><a href="#4-3-4-地址解析协议ARP" class="headerlink" title="4.3.4 地址解析协议ARP"></a>4.3.4 地址解析协议ARP</h3><h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><p><img src="/.io//image-20230807142659965.png" alt="image-20230807142659965"></p><p>广播ARP请求</p><p><img src="/.io//image-20230807142749072.png" alt="image-20230807142749072">单播ARP响应</p><p><img src="/.io//image-20230807143004913.png" alt="image-20230807143004913"><strong>流程图</strong></p><h4 id="ARP高速缓存"><a href="#ARP高速缓存" class="headerlink" title="ARP高速缓存"></a>ARP高速缓存</h4><p><img src="/.io//image-20230807143045605.png" alt="image-20230807143045605"></p><p><strong>作用</strong></p><p><img src="/.io//image-20230807143137784.png" alt="image-20230807143137784"></p><p>减少广播通信，节约资源</p><p><u>2台主机在不同的局域网地址ARP时通过路由器来代传输，首先路由器当接收者回应ARP，然后又当发送者发送ARP请求，简称又当爹当妈</u></p><p><img src="/.io//image-20230807143744911.png" alt="image-20230807143744911"></p><p><img src="/.io//image-20230807143753000.png" alt="image-20230807143753000"></p><h4 id="使用ARP的4种情况"><a href="#使用ARP的4种情况" class="headerlink" title="使用ARP的4种情况"></a>使用ARP的4种情况</h4><ul><li>同一局域网的不同主机</li></ul><p><img src="/.io//image-20230807143953144.png" alt="image-20230807143953144"></p><ul><li>不同局域网的不同主机</li></ul><p><img src="/.io//image-20230807144030029.png" alt="image-20230807144030029"></p><ul><li>路由器和主机（近）</li></ul><p><img src="/.io//image-20230807144218044.png" alt="image-20230807144218044"></p><ul><li>路由器和主机（远）</li></ul><p><img src="/.io//image-20230807144251058.png" alt="image-20230807144251058"></p><h4 id="使用IP的原因"><a href="#使用IP的原因" class="headerlink" title="使用IP的原因"></a>使用IP的原因</h4><p><img src="/.io//image-20230807144456071.png" alt="image-20230807144456071"></p><h2 id="4-4-网络控制报文协议ICMP"><a href="#4-4-网络控制报文协议ICMP" class="headerlink" title="4.4 网络控制报文协议ICMP"></a>4.4 网络控制报文协议ICMP</h2><p><u>确保一定的准确性措施</u></p><h3 id="4-4-1-4-4-2-ICMP报文的格式和种类-ICMP的实际运用"><a href="#4-4-1-4-4-2-ICMP报文的格式和种类-ICMP的实际运用" class="headerlink" title="4.4.1|4.4.2 ICMP报文的格式和种类|ICMP的实际运用"></a>4.4.1|4.4.2 ICMP报文的格式和种类|ICMP的实际运用</h3><ul><li>允许主机或者路由器报告差错情况和提供有关异常情况的报告</li><li>由主机和路由器用于网络层的 通信</li><li>是网络层的协议</li></ul><p><img src="/.io//image-20230807151542329.png" alt="image-20230807151542329"></p><h4 id="报文种类"><a href="#报文种类" class="headerlink" title="报文种类"></a>报文种类</h4><p><img src="/.io//image-20230807151607124.png" alt="image-20230807151607124"></p><p>某个问题的细节原因</p><p><img src="/.io//image-20230807151758185.png" alt="image-20230807151758185"></p><p>差错单向，<strong>询问双向</strong></p><h4 id="ICMP差错报文"><a href="#ICMP差错报文" class="headerlink" title="ICMP差错报文"></a>ICMP差错报文</h4><p>在数据丢失的时候产生报文</p><p><img src="/.io//image-20230807152032143.png" alt="image-20230807152032143"></p><h4 id="Traceroute-x2F-Tracert（追踪路由）"><a href="#Traceroute-x2F-Tracert（追踪路由）" class="headerlink" title="Traceroute&#x2F;Tracert（追踪路由）"></a>Traceroute&#x2F;Tracert（追踪路由）</h4><p><img src="/.io//image-20230807152201649.png" alt="image-20230807152201649"></p><p><strong>方法</strong></p><p> <img src="/.io//image-20230807152424539.png" alt="image-20230807152424539"></p><ul><li>源故意发错误信息</li><li>路由器丢弃</li><li>产生ICMP错误报文</li><li>回应，报文暴露路由器IP地址</li></ul><p>但是现在一些重要的路由器IP地址会收到保护无法使用Tracert</p><p><img src="/.io//image-20230808141723742.png" alt="image-20230808141723742"></p><h4 id="不发ICMP的情况"><a href="#不发ICMP的情况" class="headerlink" title="不发ICMP的情况"></a>不发ICMP的情况</h4><p><img src="/.io//image-20230807152745857-1691393271150-1.png" alt="image-20230807152745857"></p><ul><li>ICMP自己错误</li><li>第一个分片错了以后都不发（肯定错）</li><li>多播不发</li><li>特殊地址不发</li></ul><h4 id="ICMP询问报文"><a href="#ICMP询问报文" class="headerlink" title="ICMP询问报文"></a>ICMP询问报文</h4><p><img src="/.io//image-20230807153029924.png" alt="image-20230807153029924"></p><h4 id="PING和ICMP"><a href="#PING和ICMP" class="headerlink" title="PING和ICMP"></a>PING和ICMP</h4><ul><li>用于测试两个主机之间的连通性</li><li>使用了ICMP的回送请求与会送回答报文</li></ul><p><img src="/.io//image-20230807153321359.png" alt="image-20230807153321359"></p><ul><li><strong>疯狂PING一个主机可以把它的资源占用完–DDoS</strong></li></ul><p><img src="/.io//image-20230808141704500.png" alt="image-20230808141704500"></p><ul><li>可以通过返回的TTL<strong>值判断对方的操作系统</strong></li></ul><h2 id="4-5-IPv6"><a href="#4-5-IPv6" class="headerlink" title="4.5 IPv6"></a>4.5 IPv6</h2><h3 id="4-5-1-IPv6协议概述"><a href="#4-5-1-IPv6协议概述" class="headerlink" title="4.5.1 IPv6协议概述"></a>4.5.1 IPv6协议概述</h3><h4 id="出现原因："><a href="#出现原因：" class="headerlink" title="出现原因："></a>出现原因：</h4><ul><li><p>地址不足</p></li><li><p>分类不合理</p></li><li><p>NAT没有完美解决大小问题</p></li><li><p>安全问题</p></li><li><p>移动性支持弱</p></li></ul><h4 id="主要变化"><a href="#主要变化" class="headerlink" title="主要变化"></a>主要变化</h4><p><img src="/.io//image-20230807154601034.png" alt="image-20230807154601034"></p><p><img src="/.io//image-20230807154703967.png" alt="image-20230807154703967"></p><p>看看得了，记不住</p><h4 id="IP数据报的一般形式"><a href="#IP数据报的一般形式" class="headerlink" title="IP数据报的一般形式"></a>IP数据报的一般形式</h4><p><img src="/.io//image-20230807154809377.png" alt="image-20230807154809377"></p><p>基本首部+有效载荷（扩展首部加数据部分）</p><h5 id="基本首部"><a href="#基本首部" class="headerlink" title="基本首部"></a>基本首部</h5><p><img src="/.io//image-20230807154925383.png" alt="image-20230807154925383"></p><h6 id="版本-1"><a href="#版本-1" class="headerlink" title="版本"></a>版本</h6><p>指明协议版本–4位（0110&#x3D;6）</p><h6 id="通信量类"><a href="#通信量类" class="headerlink" title="通信量类"></a>通信量类</h6><p>8位，区分不同类别IPv6数据报或者优先级</p><h6 id="流标号"><a href="#流标号" class="headerlink" title="流标号"></a>流标号</h6><p><img src="/.io//image-20230807155217831.png" alt="image-20230807155217831">感觉有伏笔</p><h6 id="有效载荷长度"><a href="#有效载荷长度" class="headerlink" title="有效载荷长度"></a>有效载荷长度</h6><p>16位，指明有效载荷的字节数（除去基本首部）</p><h6 id="下一个首部"><a href="#下一个首部" class="headerlink" title="下一个首部"></a>下一个首部</h6><p>告知上层该数据之后要交给哪一个协议进行处理</p><h6 id="跳数限制"><a href="#跳数限制" class="headerlink" title="跳数限制"></a>跳数限制</h6><p>类似TTL</p><h5 id="IPv4和IPv6报文对比"><a href="#IPv4和IPv6报文对比" class="headerlink" title="IPv4和IPv6报文对比"></a>IPv4和IPv6报文对比</h5><p><img src="/.io//image-20230807155730602.png" alt="image-20230807155730602"></p><h5 id="扩展首部"><a href="#扩展首部" class="headerlink" title="扩展首部"></a>扩展首部</h5><p><img src="/.io//image-20230807155924524-1691395165160-3.png" alt="image-20230807155924524"></p><h3 id="4-5-2-IPv6的地址"><a href="#4-5-2-IPv6的地址" class="headerlink" title="4.5.2 IPv6的地址"></a>4.5.2 IPv6的地址</h3><ul><li>地址占128位</li><li>三种基本类型：单播、多播、任播–找最近的（广播变任播）</li></ul><h4 id="冒泡十六进制"><a href="#冒泡十六进制" class="headerlink" title="冒泡十六进制"></a>冒泡十六进制</h4><p><img src="/.io//image-20230807160309236.png" alt="image-20230807160309236"></p><p>16个比特转为4位16进制数</p><p><strong>零压缩：一连串的0化简为两个冒号</strong></p><p><img src="/.io//image-20230807160759262.png" alt="image-20230807160759262">这种情况只能简化较为长的一段0，只能压缩一次</p><h5 id="点分十进制后缀"><a href="#点分十进制后缀" class="headerlink" title="点分十进制后缀"></a>点分十进制后缀</h5><p><img src="/.io//image-20230807161315016.png" alt="image-20230807161315016"></p><p><img src="/.io//image-20230808141811108.png" alt="image-20230808141811108"></p><h5 id="前缀的表示方法"><a href="#前缀的表示方法" class="headerlink" title="前缀的表示方法"></a>前缀的表示方法</h5><p><img src="/.io//image-20230807161004686.png" alt="image-20230807161004686"></p><p>子网掩码没了</p><h5 id="分类（略）"><a href="#分类（略）" class="headerlink" title="分类（略）"></a>分类（略）</h5><h5 id="零压缩"><a href="#零压缩" class="headerlink" title="零压缩"></a>零压缩</h5><p><img src="/.io//image-20230808141849205.png" alt="image-20230808141849205"></p><h5 id="地址分配"><a href="#地址分配" class="headerlink" title="地址分配"></a>地址分配</h5><p><img src="/.io//image-20230807161701344.png" alt="image-20230807161701344"></p><p>无地址自动配置就是网络前缀加上你的MAC地址</p><p>ND:邻居发现</p><p>RS：路由器请求报文</p><h3 id="4-5-3-从IPv4到IPv6"><a href="#4-5-3-从IPv4到IPv6" class="headerlink" title="4.5.3 从IPv4到IPv6"></a>4.5.3 从IPv4到IPv6</h3><p>太先进很难适应，现在还在过渡</p><ul><li><p>向后兼容：v6可以兼容v4</p></li><li><p>过渡策略：</p><h4 id="双协议栈"><a href="#双协议栈" class="headerlink" title="双协议栈"></a>双协议栈</h4><p><img src="/.io//image-20230807162407784.png" alt="image-20230807162407784"><img src="/.io//image-20230808142050720.png" alt="image-20230808142050720"></p><h4 id="2-隧道技术"><a href="#2-隧道技术" class="headerlink" title="2.隧道技术"></a>2.隧道技术</h4></li></ul><p><img src="/.io//image-20230807162520160.png" alt="image-20230807162520160"></p><p>给v6套了个皮变成v4了</p><p><img src="/.io//image-20230808142120111.png" alt="image-20230808142120111"></p><h3 id="4-5-4ICMPv6"><a href="#4-5-4ICMPv6" class="headerlink" title="4.5.4ICMPv6"></a>4.5.4ICMPv6</h3><p>升级版！ARP没了</p><p><img src="/.io//image-20230807165514244.png" alt="image-20230807165514244"></p><p><img src="/.io//image-20230807165554884.png" alt="image-20230807165554884"></p><p>ND：临站发现</p><p>MLD：多播听众交付</p><h2 id="4-6-路由选择协议"><a href="#4-6-路由选择协议" class="headerlink" title="4.6 路由选择协议"></a>4.6 路由选择协议</h2><p>路由器怎么智能选择线路进行数据传输？</p><h3 id="4-6-1-路由选择协议概述"><a href="#4-6-1-路由选择协议概述" class="headerlink" title="4.6.1 路由选择协议概述"></a>4.6.1 路由选择协议概述</h3><h4 id="策略分类"><a href="#策略分类" class="headerlink" title="策略分类"></a>策略分类</h4><p><img src="/.io//image-20230807170106633.png" alt="image-20230807170106633"></p><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p><img src="/.io//image-20230807170254095.png" alt="image-20230807170254095"></p><p><strong>采用层次路由</strong></p><p><img src="/.io//image-20230807170345001.png" alt="image-20230807170345001"></p><p><img src="/.io//image-20230807171111130.png" alt="image-20230807171111130"></p><h4 id="自治系统"><a href="#自治系统" class="headerlink" title="自治系统"></a>自治系统</h4><p><img src="/.io//image-20230807170431409.png" alt="image-20230807170431409"></p><p>每一个AS<strong>区域使用单一和一致的路由选择策略</strong></p><p>接下来就介绍这些AS内策略，称为内部网关路由协议（IGP）</p><p>》》》》OSPF，RIP，IS-IS，IGPR，EIGRP</p><p>不同AS之间靠<u>BGP协议</u></p><h3 id="4-6-2内部网关协议RIP"><a href="#4-6-2内部网关协议RIP" class="headerlink" title="4.6.2内部网关协议RIP"></a>4.6.2内部网关协议RIP</h3><p><img src="/.io//image-20230807171135311.png" alt="image-20230807171135311"></p><h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p><img src="/.io//image-20230807171208954.png" alt="image-20230807171208954"></p><ul><li>简单</li><li>基于经过路由器的数量</li><li>距离就是跳数</li><li><img src="/.io//image-20230807171337327.png" alt="image-20230807171337327"></li></ul><p>16这个数字在RIP中意为不可达</p><h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><ul><li>仅和相邻路由器交换信息</li><li>交换路由表</li><li>按<strong>固定时间间隔</strong>交换信息</li></ul><h4 id="RIP路由表的建立"><a href="#RIP路由表的建立" class="headerlink" title="RIP路由表的建立"></a>RIP路由表的建立</h4><ul><li>每个路由器刚开始知道自己的邻居</li><li>接着再告诉自己的其他邻居</li><li>若干次后谁都知道有谁了</li><li>RIP路由表项：目的网络，距离，下一跳</li><li>！！下一跳不变的情况下无脑更新，下一跳不同比较跳数，更新选择跳数小的</li></ul><h4 id="RIP2"><a href="#RIP2" class="headerlink" title="RIP2"></a>RIP2</h4><p>待补充</p><h4 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h4><p>好消息传得快，坏消息传得慢</p><p><img src="/.io//image-20230807173546461.png" alt="image-20230807173546461"></p><h3 id="4-6-3内部网关协议OSPF"><a href="#4-6-3内部网关协议OSPF" class="headerlink" title="4.6.3内部网关协议OSPF"></a>4.6.3内部网关协议OSPF</h3><p> 基于速度来判断</p><h4 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h4><p><img src="/.io//image-20230807174609321.png" alt="image-20230807174609321"></p><p>适用于大网络，使用层次结构的区域划分，加快了收敛速度,减少了网络流量（分主干区域和普通区域）</p><h4 id="度量值"><a href="#度量值" class="headerlink" title="度量值"></a>度量值</h4><p>费用，<strong>带宽</strong>，时延，距离</p><h4 id="区域边界路由器ABR"><a href="#区域边界路由器ABR" class="headerlink" title="区域边界路由器ABR"></a>区域边界路由器ABR</h4><p><img src="/.io//image-20230807175227842.png" alt="image-20230807175227842"></p><p>如图R7</p><h4 id="自治系统边界路由器ASBR"><a href="#自治系统边界路由器ASBR" class="headerlink" title="自治系统边界路由器ASBR"></a>自治系统边界路由器ASBR</h4><p><img src="/.io//image-20230807175330310.png" alt="image-20230807175330310"></p><p>如图R6</p><h4 id="5种分组类型"><a href="#5种分组类型" class="headerlink" title="5种分组类型"></a>5种分组类型</h4><p><img src="/.io//image-20230807175524218.png" alt="image-20230807175524218"></p><h4 id="OSPF分组"><a href="#OSPF分组" class="headerlink" title="OSPF分组"></a>OSPF分组</h4><p><img src="/.io//image-20230807175549576.png" alt="image-20230807175549576">好复杂。。。</p><h4 id="可靠的洪泛法"><a href="#可靠的洪泛法" class="headerlink" title="可靠的洪泛法"></a>可靠的洪泛法</h4><p>待补充</p><h3 id="4-6-4外部网关协议BGP"><a href="#4-6-4外部网关协议BGP" class="headerlink" title="4.6.4外部网关协议BGP"></a>4.6.4外部网关协议BGP</h3><h4 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h4><p><img src="/.io//image-20230807175850277.png" alt="image-20230807175850277"></p><p>BGP发言人（ASBR）</p><p>*感觉就像外交官，主管外国</p><p><img src="/.io//image-20230807180238722.png" alt="image-20230807180238722"></p><p>内部不能通过BGP分享信息</p><h4 id="BGP路由信息"><a href="#BGP路由信息" class="headerlink" title="BGP路由信息"></a>BGP路由信息</h4><p><img src="/.io//image-20230807180705853.png" alt="image-20230807180705853"></p><h4 id="BGP路由选择顺序"><a href="#BGP路由选择顺序" class="headerlink" title="BGP路由选择顺序"></a>BGP路由选择顺序</h4><p><img src="/.io//image-20230807180740690.png" alt="image-20230807180740690"></p><ul><li>不能兜圈子</li><li>AS-PATH中，不允许出现相同的AS号</li></ul><h3 id="4-6-5路由器工作原理"><a href="#4-6-5路由器工作原理" class="headerlink" title="4.6.5路由器工作原理"></a>4.6.5路由器工作原理</h3><p><img src="/.io//image-20230807181339505.png" alt="image-20230807181339505"></p><p>核心功能：控制层面（各种路由协议+转发表）+数据层面（传输IP数据报）</p><h4 id="数据层面"><a href="#数据层面" class="headerlink" title="数据层面"></a>数据层面</h4><p><img src="/.io//image-20230807181613046.png" alt="image-20230807181613046"></p><h4 id="核心层面"><a href="#核心层面" class="headerlink" title="核心层面"></a>核心层面</h4><p><img src="/.io//image-20230807181635738.png" alt="image-20230807181635738"></p><h4 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h4><p><img src="/.io//image-20230807181842439.png" alt="image-20230807181842439"></p><p>有点像交换机</p><h4 id="路由种类优先级"><a href="#路由种类优先级" class="headerlink" title="路由种类优先级"></a>路由种类优先级</h4><p><img src="/.io//image-20230807182009045.png" alt="image-20230807182009045"></p><h4 id="IP报文转发过程"><a href="#IP报文转发过程" class="headerlink" title="IP报文转发过程"></a>IP报文转发过程</h4><ul><li>链路层解封，IP头部校验</li><li>获取报文目的IP地址</li><li>基于IP地址查转发表</li><li>查询失败，丢弃报文</li><li>查询成功–》获取转发出接口和下一跳IP，TTL减一，计算校验和，链路层封装发送</li></ul><h4 id="交换结构"><a href="#交换结构" class="headerlink" title="交换结构"></a>交换结构</h4><p><img src="/.io//image-20230807182454857.png" alt="image-20230807182454857"></p><h2 id="4-7-IP多播"><a href="#4-7-IP多播" class="headerlink" title="4.7 IP多播"></a>4.7 IP多播</h2><p><img src="/.io//image-20230807182649216.png" alt="image-20230807182649216"></p><p><strong>应用</strong></p><p><img src="/.io//image-20230807182725459.png" alt="image-20230807182725459"></p><p><strong>实现步骤</strong></p><ul><li>确定多播组成员</li></ul><p><img src="/.io//image-20230807182825052.png" alt="image-20230807182825052"></p><ul><li>多播路由</li></ul><p><img src="/.io//image-20230807182936016.png" alt="image-20230807182936016"></p><p>转发多播数据的三种方法</p><p><img src="/.io//image-20230807183421026.png" alt="image-20230807183421026"></p><h2 id="4-8-VPN和NAT"><a href="#4-8-VPN和NAT" class="headerlink" title="4.8 VPN和NAT"></a>4.8 VPN和NAT</h2><h4 id="4-8-1-VPN"><a href="#4-8-1-VPN" class="headerlink" title="4.8.1 VPN"></a>4.8.1 VPN</h4><p><img src="/.io//image-20230807183641376.png" alt="image-20230807183641376"></p><h4 id="4-8-2-NAT"><a href="#4-8-2-NAT" class="headerlink" title="4.8.2 NAT"></a>4.8.2 NAT</h4><p><img src="/.io//image-20230807183802714.png" alt="image-20230807183802714"></p><h5 id="NAPT"><a href="#NAPT" class="headerlink" title="NAPT"></a>NAPT</h5><p><img src="/.io//image-20230807183840227.png" alt="image-20230807183840227"></p><p>为了让公有网络进入私有网络能够分辨给哪个主机（一定程度上保护了私有网络）</p><h5 id="优缺点-2"><a href="#优缺点-2" class="headerlink" title="优缺点"></a>优缺点</h5><p><img src="/.io//image-20230807184107243.png" alt="image-20230807184107243"></p><h2 id="4-9-MPLS-简化路由表"><a href="#4-9-MPLS-简化路由表" class="headerlink" title="4.9 MPLS(简化路由表)"></a>4.9 MPLS(简化路由表)</h2><p><img src="/.io//image-20230807184225019.png" alt="image-20230807184225019"></p><ul><li>打标签</li><li>在链路层硬件转发</li></ul><p><strong>格式</strong></p><p><img src="/.io//image-20230807184601827.png" alt="image-20230807184601827"></p><h2 id="4-10-软件定义网络SDN"><a href="#4-10-软件定义网络SDN" class="headerlink" title="4.10 软件定义网络SDN"></a>4.10 软件定义网络SDN</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><p><img src="/.io//image-20230807184656953-1691405218125-5.png" alt="image-20230807184656953"></p><p>在路由器的控制层面工作，将每一个路由器各自计算路由升级成统一管理，路由器就只有查表转发了，效率增加了</p><p><img src="/.io//image-20230807184919702.png" alt="image-20230807184919702"></p><p><img src="/.io//image-20230807185050656.png" alt="image-20230807185050656"></p><p>openflow–数据层面：流表（匹配加动作）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;第四章-网络层&quot;&gt;&lt;a href=&quot;#第四章-网络层&quot; class=&quot;headerlink&quot; title=&quot;第四章 网络层&quot;&gt;&lt;/a&gt;第四章 网络层&lt;/h1&gt;&lt;h2 id=&quot;网络层解决了什么问题&quot;&gt;&lt;a href=&quot;#网络层解决了什么问题&quot; class=&quot;head</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/2024ict%E5%AF%92%E5%81%87%E4%BB%BB%E5%8A%A1/"/>
    <id>http://charles-webebr.github.io/2024/07/10/2024ict%E5%AF%92%E5%81%87%E4%BB%BB%E5%8A%A1/</id>
    <published>2024-07-10T07:22:46.106Z</published>
    <updated>2024-03-30T08:38:37.438Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024ict寒假任务"><a href="#2024ict寒假任务" class="headerlink" title="2024ict寒假任务"></a>2024ict寒假任务</h1><h2 id="ensp部分"><a href="#ensp部分" class="headerlink" title="ensp部分"></a>ensp部分</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224012013720.png" alt="image-20240224012013720"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//命令历史</span></span><br><span class="line">vlan batch <span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span> <span class="number">71</span> <span class="number">61</span> <span class="number">72</span> <span class="number">62</span> <span class="number">100</span> <span class="number">200</span></span><br><span class="line">  <span class="comment">//链路聚合  </span></span><br><span class="line">  <span class="type">int</span> Eth-Trunk <span class="number">1</span></span><br><span class="line">  trunkport GigabitEthernet <span class="number">0</span>/<span class="number">0</span>/<span class="number">6</span></span><br><span class="line">  trunkport GigabitEthernet <span class="number">0</span>/<span class="number">0</span>/<span class="number">7</span></span><br><span class="line">    <span class="comment">//接入层设置链路类型</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">    port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">40</span></span><br><span class="line">        <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">3</span></span><br><span class="line">    port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">40</span></span><br><span class="line">        <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">    port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">40</span></span><br><span class="line">    <span class="comment">//汇聚层设置链路类型（注意vlan 20 和30可以互通）</span></span><br><span class="line">    <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">     port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">10</span></span><br><span class="line">        <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">     port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">20</span> <span class="number">30</span></span><br><span class="line">    <span class="comment">//聚合链路设置</span></span><br><span class="line">    </span><br><span class="line">interface Eth-Trunk1</span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span> <span class="number">200</span></span><br><span class="line"><span class="comment">//服务器的交换机链路状态</span></span><br><span class="line">    sw8:</span><br><span class="line">vlan batch <span class="number">17</span> <span class="number">77</span></span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">77</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">3</span></span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">17</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">  port link-type access</span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    sw7:</span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">3</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">  port link-type trunk</span><br><span class="line">  port trunk allow-pass vlan <span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span> <span class="number">200</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  port link-type access</span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">200</span></span><br><span class="line"><span class="comment">//stp配置</span></span><br><span class="line">  <span class="comment">//sw5</span></span><br><span class="line">  stp region-configuration</span><br><span class="line">  region-name monika</span><br><span class="line">  instance <span class="number">10</span> vlan <span class="number">10</span></span><br><span class="line">  instance <span class="number">20</span> vlan <span class="number">20</span> <span class="number">30</span></span><br><span class="line">  instance <span class="number">40</span> vlan <span class="number">40</span></span><br><span class="line">  instance <span class="number">1</span> vlan <span class="number">100</span></span><br><span class="line">  active region-configuration</span><br><span class="line"><span class="comment">//根桥设置,sw1-4和sw7不配置</span></span><br><span class="line">sw5：</span><br><span class="line">stp instance <span class="number">2</span> root secondary</span><br><span class="line">stp instance <span class="number">10</span> root primary</span><br><span class="line">stp instance <span class="number">20</span> root primary</span><br><span class="line">stp instance <span class="number">40</span> root secondary</span><br><span class="line">    sw6：</span><br><span class="line">      stp instance <span class="number">2</span> root pri</span><br><span class="line">stp instance <span class="number">10</span> root secondary</span><br><span class="line">stp instance <span class="number">20</span> root secondary</span><br><span class="line">stp instance <span class="number">40</span> root pri</span><br><span class="line">      <span class="comment">//虚拟接口设置</span></span><br><span class="line">  <span class="type">int</span> vlanif <span class="number">40</span></span><br><span class="line">  ip ad <span class="number">192.168</span><span class="number">.40</span><span class="number">.5</span> <span class="number">24</span></span><br><span class="line">  dis th</span><br><span class="line">  <span class="type">int</span> vlanif <span class="number">200</span></span><br><span class="line">  ip ad <span class="number">192.168</span><span class="number">.200</span><span class="number">.5</span> <span class="number">24</span></span><br><span class="line">  <span class="type">int</span> vlanif <span class="number">61</span></span><br><span class="line">  ip ad <span class="number">192.168</span><span class="number">.61</span><span class="number">.5</span> <span class="number">24</span></span><br><span class="line">  <span class="type">int</span> vlanif <span class="number">71</span></span><br><span class="line">  ip ad <span class="number">192.168</span><span class="number">.71</span><span class="number">.5</span> <span class="number">24</span></span><br><span class="line"><span class="comment">//路由器配置ip</span></span><br><span class="line">      ar7：</span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.71</span><span class="number">.7</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.72</span><span class="number">.7</span> <span class="number">24</span></span><br><span class="line">       <span class="type">int</span> g3/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.67</span><span class="number">.7</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.78</span><span class="number">.7</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g4/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.77</span><span class="number">.7</span> <span class="number">24</span></span><br><span class="line">      </span><br><span class="line">        ar6：</span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.62</span><span class="number">.6</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.61</span><span class="number">.6</span> <span class="number">24</span></span><br><span class="line">       <span class="type">int</span> g3/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.67</span><span class="number">.6</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.68</span><span class="number">.6</span> <span class="number">24</span></span><br><span class="line">      <span class="type">int</span> g4/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">      ip ad <span class="number">192.168</span><span class="number">.17</span><span class="number">.6</span> <span class="number">24</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment">//配置vrrp</span></span><br><span class="line"> interface Vlanif10</span><br><span class="line"> vrrp vrid <span class="number">10</span> virtual-ip <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span></span><br><span class="line">      。。。。。</span><br><span class="line">      <span class="comment">//配置dhcp</span></span><br><span class="line">      <span class="comment">//服务器</span></span><br><span class="line">      ip pool vlan10</span><br><span class="line"> gateway-<span class="built_in">list</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span> </span><br><span class="line"> network <span class="number">192.168</span><span class="number">.10</span><span class="number">.0</span> mask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> </span><br><span class="line"> excluded-ip-address <span class="number">192.168</span><span class="number">.10</span><span class="number">.5</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.6</span> </span><br><span class="line">      ip pool vlan40</span><br><span class="line"> gateway-<span class="built_in">list</span> <span class="number">192.168</span><span class="number">.40</span><span class="number">.254</span> </span><br><span class="line"> network <span class="number">192.168</span><span class="number">.40</span><span class="number">.0</span> mask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> </span><br><span class="line"> excluded-ip-address <span class="number">192.168</span><span class="number">.40</span><span class="number">.5</span> <span class="number">192.168</span><span class="number">.40</span><span class="number">.6</span> </span><br><span class="line">      <span class="comment">//中继</span></span><br><span class="line">      dhcp en</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">10</span></span><br><span class="line">        dhcp select relay</span><br><span class="line">  dhcp relay server-ip <span class="number">192.168</span><span class="number">.200</span><span class="number">.55</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">20</span></span><br><span class="line">        dhcp select relay</span><br><span class="line">  dhcp relay server-ip <span class="number">192.168</span><span class="number">.200</span><span class="number">.55</span></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">30</span></span><br><span class="line">        dhcp select relay</span><br><span class="line">  dhcp relay server-ip <span class="number">192.168</span><span class="number">.200</span><span class="number">.55</span></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">40</span></span><br><span class="line">        dhcp select relay</span><br><span class="line">  dhcp relay server-ip <span class="number">192.168</span><span class="number">.200</span><span class="number">.55</span></span><br><span class="line"><span class="comment">//ospf配置</span></span><br><span class="line">      <span class="comment">//交换机5，6</span></span><br><span class="line">      ospf</span><br><span class="line">      ar <span class="number">0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.62</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.72</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">            ar <span class="number">10</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.10</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  ar <span class="number">20</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.20</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  ar <span class="number">30</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.30</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  ar <span class="number">40</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.40</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">//路由器r7</span></span><br><span class="line">      ospf</span><br><span class="line">      ar <span class="number">0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.71</span><span class="number">.7</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.72</span><span class="number">.7</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">        network <span class="number">192.168</span><span class="number">.67</span><span class="number">.7</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.78</span><span class="number">.7</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.87</span><span class="number">.7</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">//路由器r6</span></span><br><span class="line">      ospf</span><br><span class="line">      ar <span class="number">0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.61</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.62</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">        network <span class="number">192.168</span><span class="number">.67</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.68</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.86</span><span class="number">.6</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      <span class="comment">//交换机8</span></span><br><span class="line">                      ospf</span><br><span class="line">      ar <span class="number">0</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.87</span><span class="number">.8</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.86</span><span class="number">.8</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      ar <span class="number">100</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.100</span><span class="number">.8</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      <span class="comment">//ar8</span></span><br><span class="line">      ospf</span><br><span class="line">      ar <span class="number">0</span></span><br><span class="line">       network <span class="number">192.168</span><span class="number">.78</span><span class="number">.8</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">      network <span class="number">192.168</span><span class="number">.68</span><span class="number">.8</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">   </span><br><span class="line">      ip route-<span class="type">static</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> <span class="number">0</span> <span class="number">114.114</span><span class="number">.114</span><span class="number">.9</span> preference <span class="number">120</span></span><br><span class="line">      ip route-<span class="type">static</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> <span class="number">0</span> <span class="number">114.114</span><span class="number">.115</span><span class="number">.9</span></span><br><span class="line">      <span class="comment">//bfd配置</span></span><br><span class="line">      <span class="comment">//sw6</span></span><br><span class="line"> bfd tor8 bind peer-ip <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span> source-ip <span class="number">6.6</span><span class="number">.6</span><span class="number">.6</span></span><br><span class="line"> discriminator local <span class="number">66</span></span><br><span class="line"> discriminator remote <span class="number">68</span></span><br><span class="line"> min-tx-interval <span class="number">100</span></span><br><span class="line"> min-rx-interval <span class="number">100</span></span><br><span class="line"> commit</span><br><span class="line">      <span class="comment">//r8</span></span><br><span class="line">            bfd tosw5 bind peer-ip <span class="number">5.5</span><span class="number">.5</span><span class="number">.5</span> source-ip <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"> discriminator local <span class="number">58</span></span><br><span class="line"> discriminator remote <span class="number">55</span></span><br><span class="line"> min-tx-interval <span class="number">100</span></span><br><span class="line"> min-rx-interval <span class="number">100</span></span><br><span class="line"> commit</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">      <span class="comment">//vrrp联动bfd</span></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">10</span></span><br><span class="line">  vrrp vrid <span class="number">10</span> track bfd-session <span class="number">55</span> reduced <span class="number">30</span></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">20</span></span><br><span class="line">  vrrp vrid <span class="number">20</span> track bfd-session <span class="number">55</span> reduced <span class="number">30</span></span><br><span class="line">  <span class="type">int</span> vlan <span class="number">30</span></span><br><span class="line">  vrrp vrid <span class="number">30</span> track bfd-session <span class="number">55</span> reduced <span class="number">30</span></span><br><span class="line"><span class="comment">//三层安全，pc1不允许互通其他</span></span><br><span class="line">  acl <span class="number">2001</span></span><br><span class="line">  rule <span class="number">5</span> deny source <span class="number">192.168</span><span class="number">.10</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  traffic-filter outbound acl <span class="number">2001</span></span><br><span class="line"><span class="comment">//pc2和3不能访问pc4</span></span><br><span class="line">       acl <span class="number">2002</span></span><br><span class="line">  rule deny source <span class="number">192.168</span><span class="number">.20</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">       rule deny source <span class="number">192.168</span><span class="number">.30</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  traffic-filter outbound acl <span class="number">2002</span></span><br><span class="line">      <span class="comment">//pc2-4不能访问外网</span></span><br><span class="line">      <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">      undo traffic-filter outbound acl <span class="number">2001</span></span><br><span class="line">  acl <span class="number">2001</span></span><br><span class="line">  rule <span class="number">10</span> deny source <span class="number">114.114</span><span class="number">.116</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  traffic-filter outbound acl <span class="number">2001</span></span><br><span class="line"><span class="comment">//telnet配置</span></span><br><span class="line">      telnet server enable</span><br><span class="line">      user-interface vty <span class="number">0</span> <span class="number">4</span></span><br><span class="line">      authentication-mode aaa</span><br><span class="line">      user privilege level <span class="number">15</span></span><br><span class="line">      q</span><br><span class="line">      aaa</span><br><span class="line">        local-user monika password cipher <span class="number">357159</span></span><br><span class="line"> </span><br><span class="line"> local-user monika privilege level <span class="number">15</span></span><br><span class="line"> local-user monika service-type telnet</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>rule 5 permit source 192.168.10.0 0.0.0.255<br> rule 10 deny</p><p>vlan设计：</p><p>访客区规划到单独的vlan</p><p>营销和行政属于不同vlan</p><p>研发属于不同vlan</p><p>明确放行哪些vlan，不能all</p><p>配置管理vlan</p><p>二层消除环路：</p><p>使用mstp技术实现防环，域名为jian</p><p>根桥集中在汇聚层，vrrp的master和根桥一样</p><p>互连的两条使用e-thunk（图）</p><p>三层网络设计:</p><p>ip和vlan对应</p><p>大部分ip由dhcp服务器分配</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224002655473.png" alt="image-20240224002655473"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224002945881.png" alt="image-20240224002945881"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224003518089.png" alt="image-20240224003518089"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224011722302.png" alt="image-20240224011722302"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224011820990.png"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240224011855910.png" alt="image-20240224011855910"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240225124544740.png" alt="image-20240225124544740"></p><h2 id="Linux部分"><a href="#Linux部分" class="headerlink" title="Linux部分"></a>Linux部分</h2><h3 id="任务一：创建一个Linux用户"><a href="#任务一：创建一个Linux用户" class="headerlink" title="任务一：创建一个Linux用户"></a>任务一：创建一个Linux用户</h3><h4 id="1-新增用户"><a href="#1-新增用户" class="headerlink" title="1.新增用户"></a>1.新增用户</h4><h5 id="1-1-adduser"><a href="#1-1-adduser" class="headerlink" title="1.1 adduser"></a>1.1 adduser</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">创建命令：sudo adduser monika</span><br><span class="line">删除命令：sudo deluser monika</span><br></pre></td></tr></table></figure><p><strong>结果截图</strong></p><p>*要求输入一堆信息</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240222213429728.png" alt="image-20240222213429728"><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240222213811715.png" alt="image-20240222213811715"></p><h5 id="1-2-useradd"><a href="#1-2-useradd" class="headerlink" title="1.2 useradd"></a>1.2 useradd</h5><p>*不会创建主目录和指定shell版本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">创建命令：sudo useradd yuri</span><br><span class="line">删除命令：sudo userdel yuri</span><br><span class="line">为用户指定登录密码：sudo passwd <span class="number">123456</span></span><br><span class="line"><span class="comment">//需要自己命令指定目录和shell</span></span><br><span class="line">为用户指定命令解释程序(通常为/bin/bash)：sudo usermod -s /bin/bash yuri</span><br><span class="line">为用户指定用户主目录：sudo useradd -d /home/yuri yuri -m</span><br></pre></td></tr></table></figure><p><strong>带参数的useradd命令</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-d： 指定用户的主目录</span><br><span class="line"></span><br><span class="line">-m： 如果存在不再创建，但是此目录并不属于新创建用户；如果主目录不存在，则强制创建； -m和-d一块使用。</span><br><span class="line"></span><br><span class="line">-s： 指定用户登录时的shell版本</span><br><span class="line"></span><br><span class="line">-M： 不创建主目录</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>栗子：<img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240222164042914.png" alt="image-20240222164042914"></p><p><strong>结果截图</strong></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240222213916686.png" alt="image-20240222213916686"></p><h5 id="2-删除用户"><a href="#2-删除用户" class="headerlink" title="2.删除用户"></a>2.删除用户</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//deluser</span></span><br><span class="line">只删除用户：sudo deluser tt</span><br><span class="line">连同用户的主目录和邮箱一起删除：sudo deluser --remove-home tt</span><br><span class="line">连同用户拥有的所有文件删除：sudo deluser --remove-all-files tt</span><br><span class="line"><span class="comment">//userdel</span></span><br><span class="line">只删除用户：sudo userdel tt</span><br><span class="line">连同用户主目录一起删除：sudo derlser -r tt</span><br></pre></td></tr></table></figure><h3 id="任务二：爱心代码"><a href="#任务二：爱心代码" class="headerlink" title="任务二：爱心代码"></a>任务二：爱心代码</h3><p>请看vcr</p><h3 id="任务三：-安装Linux版本的HDFS分布式存储并设置伪分布式集群安装（单机运行）"><a href="#任务三：-安装Linux版本的HDFS分布式存储并设置伪分布式集群安装（单机运行）" class="headerlink" title="任务三： 安装Linux版本的HDFS分布式存储并设置伪分布式集群安装（单机运行）"></a>任务三： 安装Linux版本的HDFS分布式存储并设置伪分布式集群安装（单机运行）</h3><h4 id="cat一份文件"><a href="#cat一份文件" class="headerlink" title="cat一份文件"></a>cat一份文件</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240223104714710.png" alt="image-20240223104714710"></p><h4 id="查看Datanode的工作状态"><a href="#查看Datanode的工作状态" class="headerlink" title="查看Datanode的工作状态"></a>查看Datanode的工作状态</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240223105018889.png" alt="image-20240223105018889"></p><p>modify是文件内容变换，change是文件属性变化，当Atime在Mtime和Ctime之前才会被修改</p><p>access</p><p>change</p><p>modify</p><h2 id="拷打环节"><a href="#拷打环节" class="headerlink" title="拷打环节"></a>拷打环节</h2><h3 id="vrrp（网络层，ip报文封装，112）"><a href="#vrrp（网络层，ip报文封装，112）" class="headerlink" title="vrrp（网络层，ip报文封装，112）"></a>vrrp（网络层，ip报文封装，112）</h3><ul><li><p>VRRP路由器（VRRP Router）：运行VRRP协议的设备，它可能属于一个或多个虚拟路由器。</p></li><li><p>虚拟路由器（Virtual Router）：又称VRRP备份组，由一个Master设备和多个Backup设备组成，被当作一个共享局域网内主机的缺省网关。</p></li><li><p>Master路由器（Virtual Router Master）：承担转发报文任务的VRRP设备。</p></li><li><p>Backup路由器（Virtual Router Backup）：一组没有担转发任务的VRRP设备，当Master设备出现故障时，它们将通过竞选成为新的Master设备。</p></li><li><p>VRID：虚拟路由器的标识。</p></li><li><p>虚拟IP地址(Virtual IP Address)：虚拟路由器的IP地址，一个虚拟路由器可以有一个或多个IP地址，由用户配置。</p></li><li><p>IP地址拥有者（IP Address Owner）：如果一个VRRP设备将虚拟路由器IP地址作为真实的接口地址，则该设备被称为IP地址拥有者。如果IP地址拥有者是可用的，通常它将成为Master。</p></li><li><p>虚拟MAC地址（Virtual MAC Address）：虚拟路由器根据虚拟路由器ID生成的MAC地址。一个虚拟路由器拥有一个虚拟MAC地址，<strong>格式为：00-00-5E-00-01-{VRID}(VRRP for IPv4)；00-00-5E-00-02-{VRID}(VRRP for IPv6)。</strong>当虚拟路由器回应ARP请求时，使用虚拟MAC地址，而不是接口的真实MAC地址。</p></li></ul><h4 id="VRRP报文："><a href="#VRRP报文：" class="headerlink" title="VRRP报文："></a>VRRP报文：</h4><p>VRRP协议报文用来将Master设备的优先级和状态通告给同一备份组的所有Backup设备。</p><p>VRRP<strong>协议报文封装在IP报文</strong>中，发送到分配给VRRP的IP组播地址。在IP报文头中，源地址为发送报文接口的主IP地址（不是虚拟IP地址），<strong>目的地址是224.0.0.18，TTL是255，协议号是112。</strong></p><h4 id="VRRP状态机："><a href="#VRRP状态机：" class="headerlink" title="VRRP状态机："></a>VRRP状态机：</h4><p>VRRP协议中定义了三种状态机：初始状态（Initialize）、活动状态（Master）、备份状态（Backup）。其中，只有处于Master状态的设备才可以转发那些发送到虚拟IP地址的报文。</p><h4 id="VRRP的工作过程："><a href="#VRRP的工作过程：" class="headerlink" title="VRRP的工作过程："></a>VRRP的工作过程：</h4><p>VRRP备份组中的设备根据优先级选举出Master。Master设备通过发送<strong>免费ARP报文</strong>，将虚拟MAC地址通知给与它连接的设备或者主机，从而承担报文转发任务。</p><p>Master设备周期性向备份组内所有Backup设备<strong>发送VRRP通告报文，以公布其配置信息（优先级等）和工作状况。</strong><br>如果Master设备出现故障，VRRP备份组中的Backup设备将根据优先级重新选举新的Master。</p><p>VRRP<strong>备份组状态切换时</strong>，Master设备由一台设备切换为另外一台设备，新的Master设备会立即发送携带虚拟路由器的虚拟MAC地址和虚拟IP地址信息的<strong>免费ARP报文</strong>，刷新与它连接的主机或设备中的MAC表项，从而把用户流量引到新的Master设备上来，整个过程对用户完全透明。</p><p>原Master设备故障恢复时，若该设备为IP地址拥有者（优先级为255），将直接切换至Master状态。若该设备优先级小于255，将首先切换至Backup状态，且其优先级恢复为故障前配置的优先级。</p><p>Backup设备的优先级高于Master设备时，由Backup设备的工作方式（抢占方式和非抢占方式）决定是否重新选举Master。</p><p><strong>抢占模式：在抢占模式下，如果Backup设备的优先级比当前Master设备的优先级高，则主动将自己切换成Master。</strong></p><p><strong>非抢占模式：在非抢占模式下，只要Master设备没有出现故障，Backup设备即使随后被配置了更高的优先级也不会成为Master设备。</strong></p><h3 id="traffic-filter"><a href="#traffic-filter" class="headerlink" title="traffic-filter"></a>traffic-filter</h3><h4 id="acl分类"><a href="#acl分类" class="headerlink" title="acl分类"></a>acl分类</h4><ul><li>基本acl，2000-2999</li><li>高级acl，3000-3999</li><li>二层acl，4000-4999</li><li>用户自定义acl，5000-5999</li><li>用户acl，6000-6999</li></ul><h4 id="traffic-policy对比！！！！"><a href="#traffic-policy对比！！！！" class="headerlink" title="traffic-policy对比！！！！"></a>traffic-policy对比！！！！</h4><ul><li>Traffic Policy：Traffic Policy主要用于对网络中的流量进行管理和控制。Traffic Policy可以设置如下参数：端口带宽、限速、限流、优先级、队列等。通过Traffic Policy，管理员可以按照自己的需求来规划和配置网络带宽资源，以保证业务的正常运行和网络的高效利用。</li><li>Traffic Filter：Traffic Filter主要用于对网络中的数据包进行过滤和拦截。Traffic Filter可以根据IP地址、源端口、目标端口、协议类型等参数对数据包进行匹配，并选择性地允许或者禁止其通过特定的端口或者路由器。Traffic Filter通常用于实现网络安全防护和数据隔离等功能。</li></ul><h4 id="traffic-policy怎么配置！！！"><a href="#traffic-policy怎么配置！！！" class="headerlink" title="traffic-policy怎么配置！！！"></a>traffic-policy怎么配置！！！</h4><h4 id="DHCP中继"><a href="#DHCP中继" class="headerlink" title="DHCP中继"></a>DHCP中继</h4><p> DHCP客户使用IP广播来寻找同一网段上的DHCP服务器。当服务器和客户段处在不同网段，即被路由器分割开来时，路由器是不会转发这样广播包的。因此可能需要在每个网段上设置一个DHCP服务器，虽然DHCP只消耗很小的一部分资源的，但多个 DHCP服务器，毕竟要带来管理上的不方便。DHCP中继的使用使得一个DHCP服务器同时为多个网段服务成为可能，配置DHCP中继的网络设备可以在不同网段上从DHCP总服务器获取IP地址分配给下面的各主机，路由器或者三层交换机都可以充当DHCP中继</p><h4 id="dhcp工作原理"><a href="#dhcp工作原理" class="headerlink" title="dhcp工作原理"></a>dhcp工作原理</h4><ol><li>dhcp discover发现dhcp服务器</li><li>dhcp offer告诉对方可以提供ip</li><li>dhcp request 请求ip</li><li>dhcp ack 给ip</li></ol><p>除此之外还有4种报文</p><p>dhcp nak 服务器拒绝分配ip</p><p>dhcp release 主机不要ip了，给服务器说一声</p><p>dhcp decline 主机说这个ip用不了</p><p>dhcp inform不怎么用</p><h3 id="bfd（应用层协议，封装在udp中，3785）"><a href="#bfd（应用层协议，封装在udp中，3785）" class="headerlink" title="bfd（应用层协议，封装在udp中，3785）"></a>bfd（应用层协议，封装在udp中，3785）</h3><p><strong>BFD在两台网络设备上建立会话，用来检测网络设备间的双向转发路径，为上层应用服务</strong>。会话建立后会周期性地快速发送BFD报文，如果在检测时间内没有收到BFD报文则认为该双向转发路径发生了故障，通知被服务的上层应用进行相应的处理。<br><strong>BFD协议本身没有邻居发现机制，BFD邻居的创建依赖于上层的应用</strong>。根据BFD会话建立过程可以将其分为动态BFD和静态BFD。</p><p><strong>动态BFD</strong>：是通过上层应用(例如OSPF)的邻居发现机制，有上层应用将邻居信息发送到BFD模块，BFD则根据接收到的邻居信息创建会话并建立自己的邻居。<br><strong>静态BFD</strong>：是通过静态配置手动添加对端的邻居信息来创建会话，静态BFD配置完后，会定时发送BFD控制报文。只有对端接口也开启BFD的情况下并对本端的BFD报文做出正确应答后，双方建立邻居信息。</p><p><strong>Echo报文采用UDP封装，目的端口号为3785，目的IP地址为发送接口的地址，源IP地址由配置产生（配置的源IP地址要避免产生ICMP重定向）。</strong></p><h4 id="状态机"><a href="#状态机" class="headerlink" title="状态机"></a>状态机</h4><ul><li><p>BSM_AdminDown   </p></li><li><p>BSM_Down             </p></li><li><p>BSM_Init        </p></li><li><p>BSM_Up</p><p>会话状态变化通过<strong>BFD报文的State字段传递</strong>，系统根据自己本地的会话状态和接收到的对端BFD报文驱动状态改变。</p><p><strong>BFD状态机的建立和拆除都采用三次握手机制。</strong></p><p><img src="https://img-blog.csdnimg.cn/20191019003813753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3MyNjAzODk4MjYw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><ul><li>互发down报文，收到对方的down后，迁移到init状态</li><li>互发init报文，收到对方的init报文后就迁移到UP</li></ul></li></ul><h4 id="mstp（二层协议）"><a href="#mstp（二层协议）" class="headerlink" title="mstp（二层协议）"></a>mstp（二层协议）</h4>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2024ict寒假任务&quot;&gt;&lt;a href=&quot;#2024ict寒假任务&quot; class=&quot;headerlink&quot; title=&quot;2024ict寒假任务&quot;&gt;&lt;/a&gt;2024ict寒假任务&lt;/h1&gt;&lt;h2 id=&quot;ensp部分&quot;&gt;&lt;a href=&quot;#ensp部分&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>云计算</title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E4%BA%91%E8%AE%A1%E7%AE%971/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E4%BA%91%E8%AE%A1%E7%AE%971/</id>
    <published>2024-07-10T07:22:42.528Z</published>
    <updated>2024-07-10T07:35:15.216Z</updated>
    
    <content type="html"><![CDATA[<h1 id="云计算"><a href="#云计算" class="headerlink" title="云计算"></a>云计算</h1><h2 id="云计算定义"><a href="#云计算定义" class="headerlink" title="云计算定义"></a>云计算定义</h2><p>不是技术，而是服务模式以及实现这种模式背后的技术（信息电场）</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240518094918390.png" alt="image-20240518094918390"></p><p><strong>云计算是一种模型，它可以实现随时随地，便捷的，随需求应变地从可配置的计算资源共享此中获取所需的资源，资源能够快速供应并且释放，使得管理资源的工作量与服务商的交互减少到最小限度</strong></p><h2 id="云计算的价值"><a href="#云计算的价值" class="headerlink" title="云计算的价值"></a>云计算的价值</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518110711727.png" alt="image-20240518110711727"></p><ol><li>按需自助服务</li><li>广泛网络接入</li><li>资源池化</li><li>快速部署，弹性扩容</li><li>可计量服务</li></ol><h2 id="服务模式"><a href="#服务模式" class="headerlink" title="服务模式"></a>服务模式</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518113340753.png" alt="image-20240518113340753"></p><p>三类：最高级就是saas，中间级别paas，最低级iaas</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240518113752299.png" alt="image-20240518113752299"></p><h2 id="部署模式"><a href="#部署模式" class="headerlink" title="部署模式"></a>部署模式</h2><ul><li>私有云：单一组织拥有（）</li><li>公有云：运营商所拥有的（）</li><li>混合云：多种云构成的（）</li><li>行业云（社区云）：针对特定行业和人群定制的云（）</li></ul><p>公有云、私有云和混合云这三种云服务模式，由于它们各自的特点和优势，通常会被不同的部门或机构采用。</p><p>以下是一些具体的例子：</p><p><strong>公有云</strong>：</p><ol><li><strong>互联网公司</strong>：这些公司通常需要快速扩展其服务，并且愿意利用第三方提供的可扩展性和成本效益。例如，各种规模的互联网初创公司和App开发商可能会选择使用公有云服务，以便快速部署和扩展其在线服务。</li><li>**中小企业(SMEs)**：对于资源有限的中小企业来说，公有云提供了一个无需大量前期投资即可获得必要IT资源的方案。它们可以按需购买计算资源，而不必自己维护数据中心。</li><li><strong>研究和教育机构</strong>：大学和研究机构可能会使用公有云进行数据存储和处理，特别是在需要大量计算资源进行科学研究时。</li></ol><p><strong>私有云</strong>：</p><ol><li><strong>大型企业</strong>：具有敏感数据的大型企业或那些对数据安全和隐私要求极高的金融机构，如银行、保险公司和律师事务所，更倾向于使用私有云。这是因为私有云提供了更高水平的定制、安全性和控制能力。</li><li><strong>政府部门</strong>：政府机关通常处理机密信息，因此他们更有可能建立私有云来确保数据的安全和符合监管要求。</li><li><strong>医疗保健行业</strong>：医院和医疗机构由于处理患者数据，通常需要符合严格的合规性标准，因此可能会选择私有云解决方案以保护敏感医疗记录。</li></ol><p><strong>混合云</strong>：</p><ol><li><strong>跨国公司</strong>：拥有多个业务单元和遍布全球的办事处的跨国公司可能会同时使用公有云和私有云，以便根据每个业务需求灵活地管理资源和服务。</li><li><strong>需要特殊数据处理的行业</strong>：比如媒体和娱乐行业，可能需要将核心数据和应用程序保留在私有云中，同时使用公有云来进行内容分发等。</li><li><strong>逐渐过渡的组织</strong>：一些组织可能正在从传统的IT基础设施转移到云服务，但出于安全、合规或其他原因并不准备完全放弃对基础设施的控制。对这些组织而言，混合云提供了一种逐步过渡的方法。</li></ol><p><strong>行业云：</strong></p><ul><li><strong>互联网行业</strong>：互联网公司需要快速扩展其服务以适应不断变化的市场需求，行业云可以提供灵活的资源来支持这种快速增长。</li><li><strong>金融行业</strong>：金融行业对数据安全和合规性要求极高，行业云可以为金融机构提供符合法规要求的定制服务。</li><li><strong>政务行业</strong>：政府机构处理大量敏感数据，需要高度的控制权和安全性，行业云能够满足这些需求并提供更好的数据管理和服务。</li><li><strong>制造业</strong>：制造企业可以利用行业云进行数据分析和优化生产流程，同时提高供应链的效率。</li><li><strong>医疗行业</strong>：医疗机构需要存储和共享大量的患者数据，行业云能够提供高效安全的数据处理能力，同时满足HIPAA等医疗法规的要求。</li><li><strong>教育行业</strong>：教育机构可以使用行业云来管理学生信息、课程内容和在线学习平台，提供更好的教育资源和服务。</li><li><strong>交通行业</strong>：交通行业可以利用行业云进行数据分析，优化交通流量和物流管理。</li><li><strong>农业行业</strong>：行业云可以帮助农业企业进行作物监测、天气预测和资源管理，提高农业生产效率。</li><li><strong>媒体行业</strong>：媒体公司需要存储和处理大量的视频和音频文件，行业云提供了高效的存储和快速访问这些大型媒体资产的能力。</li></ul><h2 id="tco"><a href="#tco" class="headerlink" title="tco"></a>tco</h2><p>TCO是<strong>总体拥有成本（Total Cost of Ownership）</strong>，就是7零8怪的钱全加起来</p><h2 id="cpu虚拟化"><a href="#cpu虚拟化" class="headerlink" title="cpu虚拟化"></a>cpu虚拟化</h2><p>一个cpu在同一个时间下只能给一个进程计算，但是我们cpu会有超线程技术，支持一个cpu处理多一个任务，电脑里面说的24核心32线程就是指有八颗芯片支持超线程技术</p><h2 id="“cpu时间管理大师”"><a href="#“cpu时间管理大师”" class="headerlink" title="“cpu时间管理大师”"></a>“cpu时间管理大师”</h2><p>我虽然算得少，但是我算的快啊</p><p><strong>分时复用技术</strong></p><h2 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h2><p>系统是应用在ring0之中的，app是应用在ring1和2中的，但是app里面会用到系统的敏感指令，于是就来骗我们的cpu，方法有三：半虚拟化、虚拟化、硬件辅助</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518160308446.png" alt="image-20240518160308446"></p><p><strong>理论上一台虚拟机的cpu核数最大为线程数（但是一般就是核心数）</strong></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518161830717.png" alt="image-20240518161830717"></p><h2 id="重要概念"><a href="#重要概念" class="headerlink" title="重要概念"></a>重要概念</h2><ul><li>guest OS（虚拟操作系统）</li><li>Guest Machine（虚拟机virtual machine）</li><li>Hypervisor（vmm-virtual machine monitor，虚拟化软件层）</li><li>Host OS（物理操作系统）</li><li>Host Machine（物理机）</li></ul><h2 id="虚拟化的特点"><a href="#虚拟化的特点" class="headerlink" title="虚拟化的特点"></a>虚拟化的特点</h2><ol><li>分区（同一个物理主机可以同时运行多个虚拟机）</li><li>隔离（多个虚拟机之间不会相互影响）</li><li>封装（每个虚拟机就是个文件，方便搬移）</li><li>相对于硬件独立（虚拟机无需修改，即可在服务器上运行）</li></ol><h2 id="虚拟化分类"><a href="#虚拟化分类" class="headerlink" title="虚拟化分类"></a>虚拟化分类</h2><ol><li>裸金属型虚拟化</li></ol><p>裸金属广泛应用于企业应用之中</p><p>优点：性能较好</p><p>缺点：安装使用相对困难，有一定的学习门槛</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518163754071.png" alt="image-20240518163754071"></p><ol start="2"><li>寄主型虚拟化</li></ol><p>寄主适用于个人pc，可以满足虚拟</p><p>应用和普通软件</p><p>优点：简单</p><p>缺点：性能损耗</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518163715518.png" alt="image-20240518163715518"></p><h2 id="vcpu的计算"><a href="#vcpu的计算" class="headerlink" title="vcpu的计算"></a>vcpu的计算</h2><p><strong>系统可用的vCPU总数(逻辑处理器) &#x3D; Socket数（CPU个数）x Core数（内核）x Thread数（超线程</strong>）</p><h2 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h2><ol><li>企业为什么要使用虚拟化（虚拟化对比传统it的优点）</li></ol><p>企业使用虚拟化技术相较于传统IT架构有多方面的优势，具体分析如下：</p><ol><li><strong>资源整合</strong>：虚拟化允许企业在单个物理服务器上创建多个虚拟机（VM），每个VM都可以运行独立的操作系统和应用程序。这样可以更有效地利用硬件资源，提高整体的资源利用率。</li><li><strong>成本节约</strong>：通过虚拟化，企业可以减少对物理硬件的需求，因为可以在现有的硬件上运行更多的虚拟机。这降低了前期投资和长期的维护成本。</li><li><strong>自动配置和集中管理</strong>：虚拟化技术使得IT资源的管理更加自动化和集中化。管理员可以远程完成日常操作，无需逐个处理每个工位上的主机，提高了管理效率。</li><li><strong>灾备恢复</strong>：虚拟化提供了更加灵活和快速的灾难恢复解决方案。通过快照和复制功能，可以快速恢复数据和服务，减少潜在的业务中断时间。</li><li><strong>安全性提升</strong>：虚拟化环境通常提供更强的隔离和安全措施，可以有效防止病毒和恶意软件的传播，保护企业数据不受威胁。</li><li><strong>跨平台支持</strong>：虚拟化技术支持多种操作系统和应用程序在同一硬件上并行运行，这为跨平台应用提供了便利。</li><li><strong>可扩展性和灵活性</strong>：企业可以根据业务需求动态地添加或移除资源，而不需要物理上的调整。这使得企业能够快速响应市场变化。</li><li><strong>高效的资源利用</strong>：由于虚拟化技术可以动态调整资源分配，因此可以避免资源的浪费，确保硬件资源得到充分利用。</li><li><strong>支持创新和测试</strong>：虚拟化环境支持快速部署和拆除实验环境，有助于企业进行新技术的测试和创新。</li></ol><p>综上所述，虚拟化为企业带来了诸多好处，包括资源整合、成本节约、自动配置、灾备恢复、安全性提升、跨平台支持、可扩展性和灵活性、高效的资源利用、集中管理和动态分配以及支持创新和测试等方面。这些价值共同推动了企业在竞争激烈的市场环境中保持领先地位。</p><ol start="2"><li>在电脑中安装vmware 通过软件安装两个系统（专业版）</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518174733847.png" alt="image-20240518174733847"></p><p>安装centos成功</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240518174833181.png" alt="image-20240518174833181">安装windows成功</p><h2 id="裸金属虚拟化"><a href="#裸金属虚拟化" class="headerlink" title="裸金属虚拟化"></a>裸金属虚拟化</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240601141844641.png" alt="image-20240601141844641"></p><p>这个东西只是逻辑上的解决方案，里面的东西才是真的，比如说我们的FusionCompute</p><h3 id="虚拟化套件分类"><a href="#虚拟化套件分类" class="headerlink" title="虚拟化套件分类"></a>虚拟化套件分类</h3><ol><li>FusionCompute：必须有的功能部分，大脑</li></ol><p>FusionCompute是<strong>云操作系统软件</strong>，主要负责硬件资源的虚拟化，以及对虚拟资源、业务资源、用户资源的集中管理。<u>它采用虚拟计算、虚拟存储、虚拟网络等技术，完成计算资源、存储资源、网络资源的虚拟化</u>。同时通过统一的接口， 对这些虚拟资源进行集中调度和管理，从而降低业务的运行成本，保证系统的安全性和可靠性，协助运营商和企业构筑安全、绿色、节能的云数据中心能力。</p><ol start="2"><li>ebackup:保护数据</li></ol><p>eBackup是虚拟化备份软件，配合FusionCompute<strong>快照功能和CBT(Changed Block Tracking)</strong> 备份功能实现FusionSphere的虚拟机数据备份方案。</p><ol start="3"><li>UltraVR：保护业务</li></ol><p>UltraVR是<strong>容灾业务管理软件</strong>，利用底层<strong>SAN存储系统</strong>提供的异步沅程复制特性，提供虚拟机关键数据的数据保护和容灾恢复。</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240601142231647.png" alt="image-20240601142231647"></p><h3 id="FusionSphere的优势"><a href="#FusionSphere的优势" class="headerlink" title="FusionSphere的优势"></a>FusionSphere的优势</h3><p>华为FusionSphere虚拟化套件是业界领先的虚拟化解决方案，能够帮助客户带来如下的价值，从而大幅提升数据中心基础设施的效率。</p><p><strong>· 帮助客户提升数据中心基础设施的<u>资源利用率</u>。</strong>（利用率）<br>**· 帮助客户成倍<u>缩短业务上线周期。</u>**（time）<br><strong>· 帮助客户成倍降低数据中心<u>能耗</u>。</strong>（power）<br><strong>· 利用虚拟化基础设施的高可用和强恢复能力，实现业务<u>快速自动化故障恢复</u>，降低数据中心成本和增加系统应用的正常运行时间。</strong></p><p>FusionSphere虚拟化套件通过在服务器上部署虚拟化软件，使一台物理服务器可以承担多台服务器的工作。通过整合现有的工作负载并利用剩余的服务器以部署新的应用程序和解决方案，实现较高的整合率。</p><h3 id="VRM和CNA"><a href="#VRM和CNA" class="headerlink" title="VRM和CNA"></a>VRM和CNA</h3><p><em>VRM（虚拟资源管理）</em>：VRM是集群的管理者，<strong>管CNA</strong></p><p><strong>功能：</strong></p><p>· 管理集群内的块存储资源。<br><strong>· 管理集群内的网络资源(IP&#x2F;VLAN),为虚拟机分配IP地址。</strong><br>· 管理集群内虚拟机的生命周期以及<strong>虚拟机在计算节点上的分布和迁移。</strong><br>· 管理集群内资源的动态调整。<br>·通过对虚拟资源、用户数据的统一管理，对外提供弹性计算、存储、IP等服务。<br>·通过提供统一的操作维护管理接口，操作维护人员**<u>通过WebUl远程访问FusionCompute对整个系统进行操作维护</u>**，包含资源管理、资源监控、资源报表等。</p><p><em>CNA（计算节点代理）</em>：<strong>虚拟机放在CNA下面</strong>，CNA就管这些虚拟机</p><p><strong>功能：</strong></p><p>· 提供<strong>虚拟计算</strong>功能。</p><p>· <strong>管理</strong>计算节点上的<strong>虚拟机。</strong></p><p><strong>·管理</strong>计算节点上的计算、存储、网络<strong>资源</strong>。</p><p>VRM很好玩啊，你有admin的账号的话，可以看到我们虚拟机的磁盘信息，工作状态等，可以新建用户，改网站名称，贴图等等，懂不懂我们华为的含金量啊</p><h2 id="认识服务器"><a href="#认识服务器" class="headerlink" title="认识服务器"></a>认识服务器</h2><ol><li>电脑主机的加强版</li><li>性能怪兽</li><li>可靠性强99.99%（比电脑强100倍）</li><li>可拓展性（插一万根硬盘）</li><li>支持远程开关机（有一个维护口BMC，连接到这个口就会进入到IPMI、IBMC远程维护系统，其实就是一个web界面）</li><li>拥有虚拟控制台，可以进行远程配置</li></ol><h3 id="装系统"><a href="#装系统" class="headerlink" title="装系统"></a>装系统</h3><p>虚拟控制台直接选择光驱进行安装</p><p>但是我们的网速很慢，我们先远程连接和服务器在一起的主机，把包先丢给这个主机，然后再通过主机传数据包（用远程工具）</p><p>要选择启动方式，有硬盘、光驱、可插拔设备</p><h2 id="RAID-磁盘冗余阵列"><a href="#RAID-磁盘冗余阵列" class="headerlink" title="RAID 磁盘冗余阵列"></a>RAID 磁盘冗余阵列</h2><h3 id="RID-0"><a href="#RID-0" class="headerlink" title="RID 0"></a>RID 0</h3><p>把123456分为135 246两块盘，不能进行冗余，只能储存一份数据，性能好，空间利用率高，快</p><h3 id="RID-1"><a href="#RID-1" class="headerlink" title="RID 1"></a>RID 1</h3><p>两块盘进行冗余，把123456分为123456 123456两块盘</p><h3 id="RID-5"><a href="#RID-5" class="headerlink" title="RID 5"></a>RID 5</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240608105002618.png" alt="image-20240608105002618"></p><ul><li><p>每一行是一个组成部分，称作条带，空一个格子来储存奇偶校验数据</p></li><li><p>至少需要三个盘</p></li><li><p>涉及算法：奇偶校验算法（当每两个数据位上的数据相同时，校验数据为0，校验数据不同时校验数据为1 ）</p></li><li><p>利用率：</p></li></ul><p>$$<br>\frac{n-1}{n}<br>$$</p><h3 id="RAID-1-0"><a href="#RAID-1-0" class="headerlink" title="RAID 1 0"></a>RAID 1 0</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240608112312653.png" alt="image-20240608112312653"></p><p>先做raid 1 4块变成2块</p><p>再做raid 0变成一块</p><p><strong>优点</strong></p><ul><li>更加的安全</li><li>性能接近于RAID 0</li></ul><p><strong>缺点</strong></p><ul><li>至少需要4块盘</li><li>空间利用率低</li></ul><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>请根据RAID10推算为什么行业中不使用RAIDO1？ （复制的数据更多了，两边同时复制和一次复制的区别）<br>请根据RAID10推算RAID5的原理？</p><p>答：</p><ol><li><p>首先，从结构上来看，RAIDO1由于是先进行条带化处理，然后再做镜像，这意味着数据首先被分散存储到两个或多个磁盘上，然后这些已经条带化的磁盘组再被镜像。这种配置下<strong>，一旦条带化的任何一个磁盘出现问题</strong>，整个条带化的磁盘组的数据访问都会受到影响。相比之下，RAID10则是先将数据镜像，保证了数据的冗余备份，然后再对这些镜像的数据进行条带化处理，这样既保证了数据的安全性，也提高了读写性能。</p><p>其次，从性能角度考虑，RAIDO1在理论上虽然也能提供较高的数据读写速度，但由于其结构的局限性，一旦其中一个条带化的磁盘组出现故障，即使其他磁盘正常，整个系统的性能也会大大降低。<strong>而RAID10则没有这个问题，因为它的每一组镜像都独立于其他镜像组，任何一组的故障都不会影响到其他的磁盘组正常工作。</strong></p><p>再者，考虑到容错性和数据安全性，RAIDO1只能容忍单个磁盘的故障，并且一旦发生故障，恢复数据的过程比较复杂，风险较高。<strong>而RAID10配置可以容忍多达一半的硬盘数量同时发生故障</strong>（前提是故障硬盘分布在不同的镜像组中），数据恢复更为简单和安全。</p></li><li><p>RAID5的原理基于数据条带化（RAID0）和奇偶校验技术，旨在提供数据冗余与性能的平衡。具体如下：</p><p><strong>数据条带化</strong>：RAID5继承了RAID0的数据条带化技术，将数据分布在所有成员磁盘上。这种分布可以提高数据的读写速度，因为系统可以同时从多个磁盘读取数据或向多个磁盘写入数据。</p><p><strong>奇偶校验技术</strong>：<strong>与RAID0不同，RAID5增加了奇偶校验功能</strong>，用于提供数据恢复能力。在RAID5的配置中，数据和其对应的奇偶校验信息被分布在不同的磁盘上。如果阵列中的任何一个磁盘出现故障，可以利用剩余磁盘上的数据和奇偶校验信息来重建丢失的数据。</p><p><strong>分布式存储</strong>：RAID5的特点是它的奇偶校验信息不是存储在一个专门的磁盘上，而是分布式地存储在所有磁盘上。这样可以减少任何单一磁盘的过度磨损，并提高整体的数据读写效率。</p><p><strong>数据恢复原理</strong>：在数据恢复时，RAID5通过异或运算重新计算丢失的数据块。例如，<strong>如果有三块磁盘的RAID5配置，其中一块磁盘发生故障，系统会通过对其余两块磁盘上相应的数据块进行异或运算，以计算出故障磁盘上的数据。</strong></p></li></ol><p>就是raid 0 加了一块硬盘作为校验的角色</p><h3 id="raid-50"><a href="#raid-50" class="headerlink" title="raid 50"></a>raid 50</h3><p>性能上得到了提升，但是需要6块盘，利用率还是raid 5的</p><p><strong>先配置raid，再装系统</strong></p><h2 id="安装虚拟化平台"><a href="#安装虚拟化平台" class="headerlink" title="安装虚拟化平台"></a>安装虚拟化平台</h2><h3 id="安装CNA"><a href="#安装CNA" class="headerlink" title="安装CNA"></a>安装CNA</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616094531701.png" alt="image-20240616094531701"></p><p>红色的是管理网口，绿色的是业务网口</p><ol><li><p>登录服务器BMC（管理口）</p></li><li><p>配置服务器raid，建议使用raid1</p></li><li><p>将安装包烧录到我们的主机里面（光驱启动）</p></li><li><p>系统盘选择，密码，时区，主机名等基本配置</p></li><li><p>配置ip地址等网络参数</p></li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616105748769.png" alt="image-20240616105748769"></p><h3 id="安装虚拟机vrm"><a href="#安装虚拟机vrm" class="headerlink" title="安装虚拟机vrm"></a>安装虚拟机vrm</h3><ol><li>打开华为安装工具—fusiion compute 安装工具</li><li><strong>浮动ip</strong>：多个主备机ip不一致，管理起来非常麻烦，所以我们要统一一个ip方便管理员统一管理</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616111150270.png" alt="image-20240616111150270"></p><ol start="3"><li>选择主机：就是选择我们的CNA</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616111312416.png" alt="image-20240616111312416"></p><p>4. </p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616113116571.png" alt="image-20240616113116571"></p><p>本地安装需要安装一个插件，安装非常的慢啊，那么我们先将文件上传到CNA里面再安装不就快很多了吗</p><h3 id="数据存储"><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h3><p>当前cna可以直接使用的存储空间</p><ul><li>服务器上插着的磁盘（要做raid）</li><li>存储设备：CNA可以使用的存储硬件，存储硬件进行格式化后（创建文化系统）还要绑定我们的cna</li></ul><p><strong>windows里面叫分区盘，c盘d盘e盘，新添加的磁盘要初始化建立文件系统才能使用</strong></p><h3 id="QOS策略"><a href="#QOS策略" class="headerlink" title="QOS策略"></a>QOS策略</h3><p>需要集群为了保障关键型虚拟机的业务不被非关键虚拟机抢占，可以通过资源的QOS（服务质量）进行控制</p><h3 id="份额"><a href="#份额" class="headerlink" title="份额"></a>份额</h3><p>当各虚拟机资源抢占时，通过份额等比例分配资源</p><h3 id="预留"><a href="#预留" class="headerlink" title="预留"></a>预留</h3><p>限制虚拟机资源的使用上限</p><h3 id="虚拟交换机（ovs）"><a href="#虚拟交换机（ovs）" class="headerlink" title="虚拟交换机（ovs）"></a>虚拟交换机（ovs）</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616152902583.png" alt="image-20240616152902583"></p><p>真实上的交换机会配置端口的类型，但是虚拟交换机会在web界面配置端口组，类似于脚本</p><h3 id="分布式虚拟交换机"><a href="#分布式虚拟交换机" class="headerlink" title="分布式虚拟交换机"></a>分布式虚拟交换机</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616154153544.png" alt="image-20240616154153544"></p><p>分布式虚拟交换机：是一种逻辑概念，实际不存在，用于管理多个虚拟交换机</p><p>端口组：一组相同端口策略的端口集合，本质上是一个配置集合，包含了端口类型以及其他端口配置，创建虚拟机时，通过选择端口组，系统根据提前预设的端口组策略自动在虚拟交换机上创建一个相同配置的端口并且与虚拟机连接</p><h3 id="上行链路"><a href="#上行链路" class="headerlink" title="上行链路"></a>上行链路</h3><p>虚拟交换机到物理机网卡的一个概念</p><h3 id="精髓来咯"><a href="#精髓来咯" class="headerlink" title="精髓来咯"></a><strong>精髓来咯</strong></h3><p>两个问题</p><ol><li>两个虚拟机不通，排错</li></ol><p>​cna1内部两台vm1vm3不通，那就是ovs1发生故障：地址错了呗，端口组错了呗，acl呗，端口允许的vlan不是我端口组的vlan</p><p>​    cna1内部两台vm1vm2不通，那就是ovs1或者是ovs3发生故障：acl呗，网关设置出错，安全策略</p><ol start="2"><li>大范围虚拟机不通，排错思路：</li></ol><p>​sw物理机出错</p><h2 id="磁盘类型"><a href="#磁盘类型" class="headerlink" title="磁盘类型"></a>磁盘类型</h2><h3 id="精简盘"><a href="#精简盘" class="headerlink" title="精简盘"></a>精简盘</h3><p>不立即分配磁盘空间，上层虚拟机使用时，使用多数，分配多少空间，并即刻对所分配的空间进行“虚拟化文件系统的格式化”（置零）</p><h3 id="普通盘"><a href="#普通盘" class="headerlink" title="普通盘"></a>普通盘</h3><p>立即分配磁盘空间，并立刻对所分配空间进行虚拟化文件系统的格式化操作</p><h3 id="普通延迟置零"><a href="#普通延迟置零" class="headerlink" title="普通延迟置零"></a>普通延迟置零</h3><p>立即分配磁盘空间，但是不立即进行虚拟化文件系统的格式化，第一次向该磁盘写入数据时，在全盘进行虚拟化文件系统的格式化</p><h3 id="性能排行"><a href="#性能排行" class="headerlink" title="性能排行"></a>性能排行</h3><h4 id="写性能"><a href="#写性能" class="headerlink" title="写性能"></a>写性能</h4><p><strong>首次写入</strong>：普通》精简》延迟</p><p><strong>普通写入</strong>：普通&#x3D;延时》精简</p><h4 id="读性能"><a href="#读性能" class="headerlink" title="读性能"></a>读性能</h4><p>一样</p><p>但是精简盘由于不用初始化，创建虚拟机非常快</p><p>独立不能打快照</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240616164401337.png" alt="image-20240616164401337"></p>]]></content>
    
    
    <summary type="html">ict培训云计算</summary>
    
    
    
    
    <category term="云计算" scheme="http://charles-webebr.github.io/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>云服务</title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E4%BA%91%E6%9C%8D%E5%8A%A1/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E4%BA%91%E6%9C%8D%E5%8A%A1/</id>
    <published>2024-07-10T07:22:42.527Z</published>
    <updated>2024-07-10T07:32:31.300Z</updated>
    
    <content type="html"><![CDATA[<h1 id="云服务"><a href="#云服务" class="headerlink" title="云服务"></a>云服务</h1><p>云计算侧重怎么搭建平台和管理</p><p>云服务侧重如何使用公有云平台</p><p>核心是在公有云使用云服务</p><p>云服务是将资源以服务的形式提供，用户仅仅需要在公有云上申请服务就好了</p><p>华为云一个账号下可以有很多用户</p><p>华为云在注册账号时，会按照账号名自动创建一个用户，这个用户为超级管理员</p><p>为了保证后续对系统维护时权限的详细管理，华为云支持iam的管理员创建</p><h2 id="云服务地区"><a href="#云服务地区" class="headerlink" title="云服务地区"></a>云服务地区</h2><ul><li>成本</li><li>不同区域的云服务可能存在硬件上的差别等等</li><li>要选择靠近你业务的区域，可减少延迟，提高访问速度</li></ul><h2 id="1-单个vpc：计算类服务实践"><a href="#1-单个vpc：计算类服务实践" class="headerlink" title="1.单个vpc：计算类服务实践"></a>1.单个vpc：计算类服务实践</h2><ol><li>创建vpc，这个是最大的整体，一个vpc下可以有多台ecs</li><li>创建ecs，这是我们的虚拟机，也是我们的服务器，这个ecs之后可以进行镜像的保存（dew）</li><li>AS的使用，as本质上就是一个服务器的增加和删除的过程，可以设计不同的策略比如说每天0点增加实例，内存使用超过30减少实例等。</li><li>不用的资源记得关掉，不然经费顶不住</li></ol><h2 id="2-多个vpc之间：网络的实践"><a href="#2-多个vpc之间：网络的实践" class="headerlink" title="2.多个vpc之间：网络的实践"></a>2.多个vpc之间：网络的实践</h2><p>一些名称解释：</p><p><strong>虚拟私有云</strong>（Virtual Private Cloud，以下简称VPC），为云服务器、云容器、云数据库等资源构建隔离的、用户自主配置和管理的虚拟网络环境，提升用户云上资源的安全性，简化用户的网络部署。</p><p><strong>安全组</strong>是一个逻辑上的分组，为具有相同安全保护需求并相互信任的云服务器提供访问策略。安全组创建后，用户可以在安全组中定义各种访问规则，当云服务器加入该安全组后，即受到这些访问规则的保护。</p><p><strong>弹性公网IP</strong>（Elastic IP，简称EIP）提供独立的公网IP资源，包括公网IP地址与公网出口带宽服务，以与弹性云服务器、裸金属服务器、虚拟IP、弹性负载均衡、NAT网关等资源灵活地绑定及解绑。</p><p><strong>弹性负载均衡</strong>（Elastic Load Balance，简称ELB）是将访问流量根据分配策略分发到后端多台服务器的流量分发控制服务。弹性负载均衡可以通过流量分发扩展应用系统对外的服务能力，同时通过消除单点故障提升应用系统的可用性。</p><p><strong>对等连接</strong>是指两个VPC之间的网络连接。用户可以使用私有IP地址在两个VPC之间进行通信，就像两个VPC在同一个网络中一样。同一区域内，用户可以在自己的VPC之间创建对等连接，也可以在自己的VPC与其他帐户的VPC之间创建对等连接。不同区域间的VPC之间不能创建对等连接。</p><p><strong>虚拟专用网络</strong>（Virtual Private Network，以下简称VPN），用于在远端用户和虚拟私有云（Virtual Private Cloud，以下简称VPC）之间建立一条安全加密的公网通信隧道。当用户作为远端用户需要访问VPC的业务资源时，可以通过VPN连通VPC。</p><p>本实验介绍网络类服务的使用，包括：同一个VPC内两台ECS默认互通、不同VPC间可以利用VPC对等连接互通，不同区域间的VPC通过VPN互通、验证可以利用安全组控制通信、ECS绑定EIP后可以访问公网、ELB进行流量分发等任务。</p><h3 id="实验配置要求"><a href="#实验配置要求" class="headerlink" title="实验配置要求"></a><strong>实验配置要求</strong></h3><ul><li>在上海一区域创建2个VPC，在北京四区域创建1个VPC，体验VPC的使用。</li><li>l  在上海一区域的同一VPC下验证安全组的控制。</li><li>l  在上海一区域下验证EIP的功能。</li><li>l  在上海一区域的不同VPC下验证VPC对等连接的功能。</li><li>l  在上海一区域和北京四区域间验证VPN的功能。</li><li>l  资源释放</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240707150558784.png" alt="image-20240707150558784"></p><p>实验步骤：</p><ol><li>创建网络环境，*如图所示在A区（上海）创建两个VPC1、VPC2，vpc1中包含两个ecs，进行一个elb负载均衡，eip给到一个公网ip，B区（北京创建一个vpc3包含一个ecs）</li><li><strong>创建服务器的过程在之前已经实现了，详细看手册</strong>，注意的是vpc2和vpc1的网络号不能相同</li><li><strong>同一个vpc下ecs互通：</strong>默认情况下是可以正常通信的，但是如果将安全组的策略全关闭的话就会ping失败，因为ping的动作被拒绝了，重新放行即可ping通</li><li>绑定eip弹性公网地址，在未绑定时还可以使用dns服务找到baidu。com的地址，但是没有公网地址不能通信，在申请并且绑定地址后可以正常通信</li></ol><p><strong>为了确保安全登录设备，可采取密钥对的登录方式，需要使用到putty和puttygen等工具，详细参考手册</strong></p><ol start="5"><li><p>Elb进行流量分发：在ecs上启动http服务，购买配置elb，访问web页面，详细参考手册，<strong>需要注意的是出现告警大部分情况下要在安全组中放行某个网段的流量</strong>，还有ecs没开机也会报警。（访问elb的公网地址：8881可以看见web界面，刷新界面可以看到不同的server文件，说明有负载分担）</p></li><li><p>不同vpc之间的ecs之间进行通信—-对等连接（其实我感觉和数通差不多，就是配个路由指过去），<strong>注意！！vpc1和vpc2的网段不能相同！！！</strong>  <u>如果在已经创建好的对等连接中，继续向本段vpc扩展子网且和目标网段一样，此时不仅对等连接失效，新添加的子网和原来的在同一个vpc也无法通信，但是删除对等连接后又好了</u></p></li><li><p>vpn配置挺贵的。。。   第一步购买vpn网关，其实就是买一个或者两个公网地址用来和对方建立ipsec连接，这点和ensp中的配置类似嘛  第二步就是指明对端网关开始对接  第三步就是建立ipsec连接，注意指明对方的子网，<strong>越详细越好</strong></p></li></ol><h3 id="云的计费模式"><a href="#云的计费模式" class="headerlink" title="云的计费模式"></a>云的计费模式</h3><ul><li>包年&#x2F;月</li></ul><p>预付费模式，拉长周期增加优惠</p><ul><li>按需计费</li></ul><p>后付费模式，按实际使用云服务器的时间进行付费</p><ul><li>竞价计费</li></ul><p>按市场价格进行计费，也是后付费模式，以更低的折扣按实际使用时长计费</p><h3 id="可用区"><a href="#可用区" class="headerlink" title="可用区"></a>可用区</h3><p>可用区是在同一区域下，电力、网络隔离的物理区域，可用区之间内网互通，不同可用区之间物理隔离</p><p>一个区域内可有多个可用区，一个可用区发生故障后不会影响同一区域内下的其他可用区</p><h3 id="随机分配"><a href="#随机分配" class="headerlink" title="随机分配"></a>随机分配</h3><p>随机丢到不同的可用区域</p><h3 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h3><ul><li>公共镜像</li></ul><p>云平台提供的标准的操作系统镜像，正版</p><ul><li>私有镜像</li></ul><p>基于云服务器或者外部镜像文件等方式创建的个人镜像，仅用户自己可见。包含了操作系统、<strong>预装的公共应用</strong>以及用户的<strong>私有应用</strong></p><ul><li>共享镜像</li></ul><p>你可以接收其他用户共享的私有镜像</p><ul><li>市场镜像</li></ul><p>提供预装操作系统、应用环境和各类软件的<strong>优质化第三方镜像</strong>，无需配置，可一键部署，满足建站、应用开发、可视化管理的个性化需求</p><h2 id="3-存储类服务实践"><a href="#3-存储类服务实践" class="headerlink" title="3.存储类服务实践"></a>3.存储类服务实践</h2><p>呜呜呜说是不考喵</p><h3 id="云硬盘evs"><a href="#云硬盘evs" class="headerlink" title="云硬盘evs"></a>云硬盘evs</h3><p>顾名思义就是在云上面跑的硬盘呗</p><p>我们要学会：</p><ul><li>购买硬盘</li><li>挂载硬盘</li><li>初始化硬盘</li><li>使用快照</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240708170856847.png" alt="image-20240708170856847"></p><p>我们需要先在ecs-mp的服务器上挂载-初始化硬盘然后创建一些文件，之后取消挂载再挂载到ecs-test的服务器上面，<strong>结果是这个文件不会消失，除非你再次初始化硬盘</strong></p><ol><li>购买硬盘：参考书很详细，和前面的购买操作类似‘</li><li>初始化硬盘：这个更简单，就和你实体机的操作一样，例如windows就直接在磁盘管理中就可以完成这个操作了</li><li>挂载：<strong>而linux相对复杂，你需要1.fdisk -l看看有哪些可以初始化，2.再对其进行fdisk &#x2F;dev&#x2F;vdb进行分盘，3.输入n进行分区，4.输入p查看信息，5.输入w以保存；6.输入partprobe将新的分区表变更同步到操作系统，7.输入mkfs -t ext4 &#x2F;dev&#x2F;vdb1更改格式8.mkdir &#x2F;mnt&#x2F;sdc创建挂载点9.mount &#x2F;dev&#x2F;vdb1 &#x2F;mnt&#x2F;sdc来进行挂载10.输入df -TH查看挂载情况</strong></li><li>自动挂载：改系统配置文件&#x2F;etc&#x2F;fstab，替换对应的uuid（<strong>blkid &#x2F;dev&#x2F;vdb1以查看设备的uuid</strong>）</li><li><strong>快照</strong>：这个很有意思，你先在硬盘下乱创建一些文件，然后来到网页控制台创建快照，之后呢只要你用这个快照去创建evs再挂载到ecs上你就能发现这个硬盘里面有东西哦，还和之前那个一模一样哦（<strong>相当于给硬盘拍了一张照片</strong>）</li></ol><h3 id="对象存储服务OBS"><a href="#对象存储服务OBS" class="headerlink" title="对象存储服务OBS"></a>对象存储服务OBS</h3><p>如果说evs时是只能给服务器使用的存储服务，那么OBS就是专门给用户进行使用的存储服务，你可以将你windows下的文件夹整个上传到桶里面，等需要的时候再把它拿出来即可</p><p><strong>配置过程</strong></p><ol><li>获取访问密钥AK和SK，在我的凭证下可以进行创建，下载得到一个excel文件里面就放着我们的AK和SK</li><li>下载OBS Browsers+工具，使用AK方式进行登录<img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240709234428735.png" alt="image-20240709234428735"></li><li>创建桶，上传文件或者文件夹</li><li>需要下载文件时选择下载即可</li><li><strong>多版本控制</strong>：开启这个服务后，上传同名文件会同时保留，唯一不同的区别就是<strong>修改时间</strong>，就很像游戏版本这样</li></ol><h3 id="弹性文件服务SFS"><a href="#弹性文件服务SFS" class="headerlink" title="弹性文件服务SFS"></a>弹性文件服务SFS</h3><p>就是说一个NFS文件系统同时给多个服务器进行使用</p><p><strong>配置步骤</strong></p><ol><li>创建虚拟云vpc</li><li>创建一个windows的服务器，一个linux服务器，都绑定一个公网ip</li><li>创建单个文件系统NFV</li><li>在linux挂载该文件系统，并且在该文件系统下创建一个文件</li><li>然后再在windows下绑定该文件系统，<strong>我的服务器不知道为什么没有NFS的客户端角色导致绑定失败</strong>，绑定成功后可以在文件管理中看见我们在linux下创建的文件</li></ol><h3 id="存储类型总结"><a href="#存储类型总结" class="headerlink" title="存储类型总结"></a>存储类型总结</h3><table><thead><tr><th>存储类型</th><th>面向用户</th><th>文件系统</th><th>协议</th><th>应用场景</th></tr></thead><tbody><tr><td>块存储EVS</td><td>硬盘</td><td>由使用者格式化</td><td>scsi</td><td>普通系统用作存放数据</td></tr><tr><td>文件存储SFS</td><td>文件夹</td><td>服务的提供者已经完成格式化</td><td>nfs、cifs</td><td>共享</td></tr><tr><td>对象存储OBS</td><td>桶</td><td>服务的提供者已经完成格式化</td><td>http&#x2F;https</td><td>共享，适合存放大量的<strong>非结构化数据</strong></td></tr></tbody></table><h3 id="自主学习任务"><a href="#自主学习任务" class="headerlink" title="自主学习任务"></a>自主学习任务</h3><ol><li>快照回滚：就是将磁盘的状态保存到某一时间点，当磁盘发生故障或者丢失重要数据的时候就可以使用<strong>快照回滚</strong>功能将磁盘恢复到之前的状态</li><li>obs定时上传：之前那个软件里面有定时上传功能，例子：每天0点把更新的数据发到obs桶中</li><li>云备份CBR和快照回滚很像，是“面向服务器的快照”</li></ol><h3 id="公网带宽"><a href="#公网带宽" class="headerlink" title="公网带宽"></a>公网带宽</h3><ul><li>按带宽计费：指定公网出方向的带宽大小。按带宽计费适用于访问流量大、访问量稳定的场景</li><li>按流量计费：；流量值得深思服务网使用过程中产生的出网流量。按流量计费适用于访问流量低、访问量波动较大的场景，带宽不同计费不变</li><li>加入共享带宽：多ip聚合计费，适用于多业务流量高峰分布于不同的时段，需节约公网成本的场景</li></ul><h3 id="流量分配策略"><a href="#流量分配策略" class="headerlink" title="流量分配策略"></a>流量分配策略</h3><ul><li><strong>加权轮询算法</strong>：根据组内后端服务器设置的权重，依次将请求分发给不同的服务器（转圈圈）</li><li><strong>加权最少连接</strong>：将请求分发给比值最小的后端服务器进行处理（找弱鸡—连接数&#x2F;加权值）</li><li><strong>一致性哈希算法：源ip算法</strong>—对请求的特定字段进行一致性哈希计算，并根据计算的哈希值将请求均匀地分配到后端服务器中。相同哈希值的请求，将会被分发到相同的后端服务器，及时后端服务器个数在发生变化。  源ip算法：根据请求的源ip地址进行哈希计算，源ip相同的请求会被分配到同一台后端服务器（找ip）</li></ul><p><strong>会话保持：在一定时间内用户请求服务响应的服务器不发生变化，即是你刷新页面不会发生另外一台服务器来提供服务的情况</strong></p><p>四层协议支持源ip</p><p>七层协议支持cookie</p><p>如果需要从专线、vpn访问时请选择源ip负载均衡</p><h2 id="4-运维服务实践"><a href="#4-运维服务实践" class="headerlink" title="4.运维服务实践"></a>4.运维服务实践</h2><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240710004732510.png" alt="image-20240710004732510"></p><ul><li><p>CTS：云审计：有一个追踪器，可以监控我们的obs桶，还可以配置关键操作通知，创建主题并且用手机订阅–得到华为云的短信轰炸（<strong>操作审计，用来约束和管理人为操作是否合理</strong>—支持对用户的操作进行全栈式追踪，支持转存和订阅）</p></li><li><p>CES：云监控：需要给服务器安装一个插件，详细看手册或者网站指导，安装之后就可以在控制台看见主机的运行状态和性能参数    <strong>创建告警</strong>：和自动增加减少实例那个例子很像，根据不同的策略来产生告警短信通知你（<strong>服务器监控，记录·设备的工作状态</strong>—自动监控硬件的情况，自动预警，支持订阅）</p></li><li><p>LTS：云日志：就是云上的日志，用来记录系统的一些信息（<strong>系统日志，记录了系统的工作状态</strong>—自动收集系统日志，支持快速查阅，支持转存）</p><pre><code>          1. 创建弹性云服务器日志组和日志流          2. 安装IC agent，网站有教你怎么做，关键点就是AK和SK一定不能搞错，&#123;&#125;这个符号不保留          3. 之后加入到主机组即可，等待一段时间就可以看见日志信息了</code></pre></li></ul><h2 id="5-综合实践-企业网部署到云上"><a href="#5-综合实践-企业网部署到云上" class="headerlink" title="5.综合实践-企业网部署到云上"></a>5.<strong>综合实践-企业网部署到云上</strong></h2><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240710104558085.png" alt="image-20240710104558085"></p><p>这里我们就不去做云审计了，没钱钱了&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;好怪，好多任务都做不完，没做出来，没有感想</p>]]></content>
    
    
    <summary type="html">ict培训云服务</summary>
    
    
    
    
    <category term="云相关" scheme="http://charles-webebr.github.io/tags/%E4%BA%91%E7%9B%B8%E5%85%B3/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A115/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A115/</id>
    <published>2024-07-10T07:22:42.524Z</published>
    <updated>2024-04-29T07:04:17.073Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信15"><a href="#数据通信15" class="headerlink" title="数据通信15"></a>数据通信15</h1><p>[TOC]</p><h2 id="SSL-VPN"><a href="#SSL-VPN" class="headerlink" title="SSL VPN"></a>SSL VPN</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>SSL VPN是采用<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/SSL.html">SSL</a>（Security Socket Layer）&#x2F;TLS（Transport Layer Security）协议来实现远程接入的一种轻量级<a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/VPN.html">VPN</a>技术。</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240327092835589.png" alt="image-20240327092835589"></p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li>基于证书的认证</li><li>ssl协议内置于浏览器中</li><li>构建隧道后即可访问企业内网</li></ul><h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><ol><li>用户访问企业内网时先与SSL VPN服务器之间建立安全<strong>连接隧道</strong></li><li>用户访问SSL VPN服务器，<strong>服务器对用户身份进行认证</strong></li><li>接着SSL服务器将报文转发给特定的内部服务器（web ftp ）</li></ol><h3 id="与ipsec对比优点"><a href="#与ipsec对比优点" class="headerlink" title="与ipsec对比优点"></a>与ipsec对比优点</h3><ul><li><strong>轻量级</strong></li><li><strong>安全性</strong>不输于ipsec vpn</li><li>浏览器登录，便捷性（无需客户端）</li><li><strong>低成本</strong></li><li><strong>只能基于五元组数据流建立IPSec</strong>，无法明确区分出使用某终端接入IPSec的人是否为指定的授权用户，即<strong>管理员无法确知是谁在利用VPN</strong>访问内网资源</li><li>SSL VPN工作在传输层和应用层之间，<strong>不会改变IP报文头和TCP报文头</strong>，不会影响原有网络拓扑。如果网络中部署了防火墙，只需放行传统的HTTPS（443）端口。</li><li>更重要的，相对于IPSec网络层的控制，SSL VPN的所有访问控制都是基于应用层，其<strong>细分程度可以达到URL或文件级别</strong>，可以大大提高企业远程接入的安全级别。</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240327093403440.png" alt="image-20240327093403440"></p><h3 id="访问SSL-VPN服务器的典型步骤"><a href="#访问SSL-VPN服务器的典型步骤" class="headerlink" title="访问SSL VPN服务器的典型步骤"></a>访问SSL VPN服务器的典型步骤</h3><ol><li>打开浏览器，输入https：&#x2F;&#x2F;SSL VPN服务器地址：端口或者https：&#x2F;&#x2F;域名</li><li>可能会显示网站证书有问题，我们选择“继续浏览该网站”</li><li>进入服务器web登录界面，输入用户名和密码，登录成功</li></ol><h3 id="SSL运行机制"><a href="#SSL运行机制" class="headerlink" title="SSL运行机制"></a>SSL运行机制</h3><h4 id="ssl特点"><a href="#ssl特点" class="headerlink" title="ssl特点"></a>ssl特点</h4><p>（1）所有要传输的数据信息都是加密传输，第三方无法解密<br>（2）具有校验机制，信息一旦被篡改，通信双方会立刻发现。<br>（3）配备身份证书，防止身份被冒充。</p><h4 id="ssl协议结构"><a href="#ssl协议结构" class="headerlink" title="ssl协议结构"></a>ssl协议结构</h4><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240327160846755.png" alt="image-20240327160846755"></p><ul><li>握手协议：身份认证、协商加密、交换加密密钥（服务器端将其<strong>公钥告诉客户端</strong>，然后客户端用服务器的<strong>公钥加密信息</strong>，服务器收到密文后，<strong>用自己的私钥解密</strong>。）</li><li>密码变化协议：通知对方将使用新的算法和密钥</li><li>警告协议：发现任何异常通知对方</li></ul><h4 id="ssl打补丁"><a href="#ssl打补丁" class="headerlink" title="ssl打补丁"></a>ssl打补丁</h4><p> （1）公钥如何不被篡改？</p><p>​<u>将服务器公钥放入服务器证书中，由服务器将证书传给客户端</u></p><p> （2）加解密计算量大，如何提升效率？</p><p>​客户端与服务器采用公钥加密法协商出此“会话密钥”，而后续的数据报文都使用此<strong>“会话密钥”</strong>进行加密和解密（即对称加密法）</p><h4 id="ssl四次握手"><a href="#ssl四次握手" class="headerlink" title="ssl四次握手"></a>ssl四次握手</h4><p> <img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240327162630041.png" alt="image-20240327162630041"></p><ol><li>client hello:握手第一步是客户端向服务端发送 Client Hello 消息，这个消息里包含了一个客户端生成的随机数 <strong>Random1</strong>、客户端支持的加密套件（Support Ciphers）和 SSL Version 等信息</li><li>server hello :server从 Client Hello 传过来的 Support Ciphers 里确定一份加密套件，这个套件决定了后续加密和生成摘要时具体使用哪些算法，另外还会生成一份随机数 <strong>Random2</strong>。</li><li>certificate: 发送服务端的证书及其根证书</li><li>Server Key Exchange:服务端交换通信密钥，如图发送了服务端加密公钥和签名算法</li><li>Server Hello Done</li><li>Client Key Exchange: 交换客户端的加密密钥,一个随机数<strong>pre-master-key</strong>，稍后用于生成“会话密钥”</li><li>Application Data Protocol: http-over-tls 业务数据安全传输</li></ol><p><strong><u>为什么是三个随机数呢？</u></strong></p><p><strong>为了增强安全性</strong>，每个随机数都是伪随机，但是元素变三个随机性就加了很多</p><p><strong><u>server hello过程就是不安全网站显示的原因</u></strong></p><p>从第1步骤客户端（远程用户）发起https访问SSL VPN服务器起，SSL协议已开始运行，第2步骤的提示，恰恰可以与SSL握手协议的第②次通信相对应：<strong>此时服务器将自己的本地证书传给了客户端，客户端要对服务器的证书进行认证，客户端发现该证书不可靠</strong></p><h2 id="SSL配置"><a href="#SSL配置" class="headerlink" title="SSL配置"></a>SSL配置</h2><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image001.png" alt="img"></p><p><strong>配置管理ip</strong></p><p>使用默认用户名密码登录命令行</p><table><thead><tr><th>1</th><th>SG-6000#    show interface  #默认e0&#x2F;0所使用的的ip为自动获取</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><strong>配置ip</strong></p><table><thead><tr><th>1</th><th>SG-6000#  configure</th></tr></thead><tbody><tr><td>2</td><td>SG-6000(config)#    interface ethernet0&#x2F;0              2</td></tr><tr><td>3</td><td>SG-6000(config-if-eth0&#x2F;0)#    no ip add dhcp  #删除掉自动获取ip地址配置              3</td></tr><tr><td>4</td><td>SG-6000(config-if-eth0&#x2F;0)#    ip add 192.168.1.199 255.255.255.0               4</td></tr></tbody></table><p><strong>一</strong> <strong>、配置安全域</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image003.jpg" alt="img"></p><p><strong>二、配置****SSLVPN</strong></p><p><strong>1<strong><strong>、添加</strong></strong>sslvpn</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image005.jpg" alt="img"></p><p><strong>配置<strong><strong>sslvpen</strong></strong>认证域</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image007.jpg" alt="img"></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image009.jpg" alt="img"></p><p><strong>配置出接口和服务端口、</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image011.jpg" alt="img"></p><p><strong>配置虚拟接口</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image013.jpg" alt="img"></p><p><strong>配置<strong><strong>dhcp</strong></strong>分配，帮助<strong><strong>vpn</strong></strong>拨号进来用户分配<strong><strong>ip</strong></strong>地址</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image015.jpg" alt="img"></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image016.png" alt="img"></p><p><strong>配置客户端路由信息</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image018.jpg" alt="img"></p><p><strong>高级配置</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image020.jpg" alt="img"></p><p><strong>三、创建用户</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image022.jpg" alt="img"></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image024.jpg" alt="img"></p><p><strong>四、创建流量策略</strong></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image026.jpg" alt="img"></p><p><img src="file:///C:/Users/alex/AppData/Local/Temp/msohtmlclip1/01/clip_image028.jpg" alt="img"></p><h2 id="几类VPN之间的对比"><a href="#几类VPN之间的对比" class="headerlink" title="几类VPN之间的对比"></a>几类VPN之间的对比</h2><h3 id="PPTP"><a href="#PPTP" class="headerlink" title="PPTP"></a>PPTP</h3><p><strong>点对点隧道协议</strong></p><h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><p>PPTP协议使用GRE（Generic Routing Encapsulation）协议来封装数据，通过这种封装方式可以在公共网络上建立一个安全的加密通道。由于PPTP协议较为简单，因此在实现和维护方面相对容易。</p><h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><p>PPTP协议适用于小型企业或个人用户，可以在家庭或小型企业网络中实现安全的远程访问。</p><h3 id="L2TP"><a href="#L2TP" class="headerlink" title="L2TP"></a>L2TP</h3><p><strong>L2TP是一种二层隧道协议</strong>，它可以将数据封装在L2TP协议中，然后通过公共网络进行传输。（pppoe）</p><h4 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h4><p>L2TP协议可以提供更好的安全性，因为<strong>它支持数据加密和身份验证功能</strong>。同时，L2TP协议还支持多隧道和负载均衡功能，可以更好地满足大规模网络的需求。</p><h4 id="应用场景-1"><a href="#应用场景-1" class="headerlink" title="应用场景"></a>应用场景</h4><p>L2TP协议适用于大型企业或服务提供商，可以在广域网或虚拟专用网络中实现安全的远程访问。</p><h3 id="IPSEC"><a href="#IPSEC" class="headerlink" title="IPSEC"></a>IPSEC</h3><p>IPSec是一种<strong>基于IP层的</strong>网络安全协议，它可以为IP数据包提供加密和认证功能</p><h4 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h4><p>IPSec协议可以提供端到端的安全性，因为它可以在数据传输过程中对数据进行加密和身份验证。同时，IPSec协议还支持多种加密算法和认证方式，可以更好地满足不同的安全需求。</p><h4 id="应用场景-2"><a href="#应用场景-2" class="headerlink" title="应用场景"></a>应用场景</h4><p>IPSec协议适用于需要在<strong>不同网络之间实现安全通信的场景</strong>，例如企业网、云服务和虚拟专用网络等。</p><h3 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h3><p>SSL&#x2F;TLS是一种<strong>基于传输层的</strong>网络安全协议，它可以为应用程序提供加密和身份验证功能。</p><h4 id="特点-4"><a href="#特点-4" class="headerlink" title="特点"></a>特点</h4><p>SSL&#x2F;TLS协议可以提供端到端的安全性，数据传输过程被加密，保证了数据的机密性和完整性。此外，SSL&#x2F;TLS协议还<strong>支持双向认证和公钥基础设施（PKI）技术</strong>，增强了通信的安全性。</p><h4 id="应用场景-3"><a href="#应用场景-3" class="headerlink" title="应用场景"></a>应用场景</h4><p>SSL&#x2F;TLS协议广泛应用于Web浏览器和服务器之间的通信、电子邮件、即时消息传输等场景。它可以在不安全的网络环境中为应用程序提供安全通信的能力。</p><h3 id="异同点"><a href="#异同点" class="headerlink" title="异同点"></a>异同点</h3><h4 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h4><p>IPSec VPN：<br>  IPSec协议提供了端到端的安全性，可以确保数据传输过程中的机密性和完整性。它支持多种加密算法和认证方式，提供了更高级别的安全性保障。在网络隔离性方面，IPSec VPN通常只能在相同网络环境中的设备之间建立安全的连接，难以实现不同网络环境之间的安全通信。</p><p>L2TP VPN：<br> L2TP协议可以提供数据加密和身份验证功能，具有一定的安全性。但是相对于IPSec VPN，其安全性较低。在网络隔离性方面，L2TP VPN可以在不同网络环境中的设备之间建立安全的连接，实现较好的网络隔离性。</p><p>SSL VPN：<br>  SSL&#x2F;TLS协议提供了端到端的安全性，可以确保数据传输过程中的机密性和完整性。它还支持双向认证和公钥基础设施（PKI）技术，增强了通信的安全性。在网络隔离性方面，SSL&#x2F;TLS VPN可以实现不同网络环境之间的安全通信，但相对于L2TP VPN，其隔离性可能较弱。</p><p>PPTP VPN：<br> 安全性相对较弱，因为它只提供基本的加密和身份验证功能。对网络隔离性的支持较弱，适用于家庭或小型企业网络环境。</p><p><strong>总而言之，PPTP、L2TP、IPSec和SSL&#x2F;TLS四种VPN技术在协议和技术特点方面存在差异。</strong></p><p><strong>PPTP和L2TP主要应用于远程接入VPN场景，而IPSec和SSL&#x2F;TLS则更适用于虚拟专用网络或云服务的安全通信场景。</strong></p><p><strong>此外，PPTP和L2TP适用于小型或大型企业网络环境，而IPSec和SSL&#x2F;TLS则广泛应用于各种规模的网络环境。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信15&quot;&gt;&lt;a href=&quot;#数据通信15&quot; class=&quot;headerlink&quot; title=&quot;数据通信15&quot;&gt;&lt;/a&gt;数据通信15&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;SSL-VPN&quot;&gt;&lt;a href=&quot;#SSL-VPN&quot; class=&quot;h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A114/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A114/</id>
    <published>2024-07-10T07:22:42.522Z</published>
    <updated>2024-04-13T07:13:00.651Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信14"><a href="#数据通信14" class="headerlink" title="数据通信14"></a>数据通信14</h1><p>[TOC]</p><h2 id="IPsec"><a href="#IPsec" class="headerlink" title="IPsec"></a>IPsec</h2><p><strong>IPsec VPN最经典的应用场景为点到点建立IPsec隧道的场景</strong></p><ul><li>不能走组播</li><li>包含协议：</li><li>安全传输、防止监听</li><li>对等体加密密钥（非对称）</li></ul><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316103753120.png" alt="image-20240316103753120"></p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316103836251.png" alt="image-20240316103836251"></p><h3 id="AH（别用）"><a href="#AH（别用）" class="headerlink" title="AH（别用）"></a>AH（别用）</h3><ul><li>AH头不做加密，只做验证，和NAT矛盾（AH会把NAT报错）</li><li>ESP才进行数据加密&#x2F;解密</li><li>AH用IP协议号51来标识</li></ul><h3 id="ESP"><a href="#ESP" class="headerlink" title="ESP"></a>ESP</h3><ul><li>数据<strong>完整性</strong>，数据**<u>机密性</u>**（HMAC–key？）都有涉猎，比AH好得多</li><li>ip协议号52</li><li>和ah不同，esp可以和ip中的nat协议共存，校验除ip的部分</li></ul><h3 id="协议封装模式"><a href="#协议封装模式" class="headerlink" title="协议封装模式"></a>协议封装模式</h3><ol><li>传输模式（不加上新的ip地址，将ipsec报文插入传输层协议和ip之间）</li><li>隧道模式（原来的ip报文保持，在头部再加上一个新IP报头“总部和总部互连”）</li></ol><h3 id="DH算法"><a href="#DH算法" class="headerlink" title="DH算法"></a>DH算法</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316111337845.png" alt="image-20240316111337845"></p><ul><li>a，b之间共享的p和g分别是17和3（dh-group一般非常大）</li><li>a，b之间选择自己的私钥，a拿15，b拿13</li><li>a计算公钥，3^15 mode p（17）&#x3D;6，发送给对方</li><li>b计算公钥，3^13 mode p（17）&#x3D;12，发送给对方</li><li>a共享密钥计算&#x3D;12^15 mod 17&#x3D;10</li><li>b共享密钥计算&#x3D;6^13 mod 17&#x3D;10</li></ul><h3 id="IKE协商"><a href="#IKE协商" class="headerlink" title="IKE协商"></a>IKE协商</h3><p>为什么要用IKE？为了将<strong>密钥通过自动协商</strong>产生（手动配浪费时间）</p><ul><li>通过地府赫尔曼算法进行密钥协商</li><li>dh-group中放的就是p，g</li></ul><h2 id="安全要素"><a href="#安全要素" class="headerlink" title="安全要素"></a>安全要素</h2><ul><li>机密性</li><li>完整性</li><li>身份验证</li><li>不可抵赖</li></ul><h2 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h2><h3 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h3><p>例子：des加密&#x2F;解密</p><p>密文加密钥（但是密钥要怎么传送给对方？）</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316091706463.png" alt="image-20240316091706463"></p><h3 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h3><p>例子：RSA，分公钥和私钥</p><p>私钥加内容进行加密，只有一个公钥也可以解密出信息</p><p>公钥加密私钥解密，私钥加密公钥解密</p><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316092359455.png" alt="image-20240316092359455"></p><p>缺点：只能用公钥加密，而且速度太慢了</p><h3 id="混合加密"><a href="#混合加密" class="headerlink" title="混合加密"></a>混合加密</h3><p>des加rsa，将des的密钥进行rsa加密</p><h2 id="完整性校验"><a href="#完整性校验" class="headerlink" title="完整性校验"></a>完整性校验</h2><p>ah</p><p>关键元素：哈希值</p><h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><p>将收到的文件和哈希值进行校验</p><h3 id="HMAC"><a href="#HMAC" class="headerlink" title="HMAC"></a>HMAC</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316094929671.png" alt="image-20240316094929671"></p><p>收到信息时再加入一定的数据再计算哈希值</p><h2 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h2><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240316095953073.png" alt="image-20240316095953073"></p><p>可以类比于赛博身份证</p><p>第三方用私钥给a的信息进行加密，然后a给b发信息带上第三方的密文，那么b就可以用第三方的公钥验证a到底是不是a</p><p>display ike sa</p><h2 id="L2TP"><a href="#L2TP" class="headerlink" title="L2TP"></a>L2TP</h2><p>二层VPN，真正使用的是ppp协议，ppp协议外添加l2tp协议再添加ip报头（类似于pppoe协议，只是l2tp变成了pppoe）</p><h2 id="ipsec配置"><a href="#ipsec配置" class="headerlink" title="ipsec配置"></a>ipsec配置</h2><h3 id="网络拓扑图"><a href="#网络拓扑图" class="headerlink" title="网络拓扑图"></a>网络拓扑图</h3><p><img src="C:/Users/alex/AppData/Roaming/Typora/typora-user-images/image-20240327174207628.png" alt="image-20240327174207628"></p><h3 id="配置过程"><a href="#配置过程" class="headerlink" title="配置过程"></a>配置过程</h3><p><strong>二、配置过程</strong></p><p><strong>在FW1上配置IPSec策略，并在接口上应用此IPSec策略。</strong></p><p>a、定义被保护的数据流。配置高级ACL 3000，允许10.1.1.0&#x2F;24网段访问10.1.2.0&#x2F;24网段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] acl 3000</span><br><span class="line">[FW_A-acl-adv-3000] rule 5 permit ip source 10.1.1.0 0.0.0.255 destination 10.1.2.0 0.0.0.255</span><br><span class="line">[FW_A-acl-adv-3000] quit</span><br></pre></td></tr></table></figure><p>b、配置IPSec安全提议，缺省参数可不配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] ipsec proposal tran1</span><br><span class="line">[FW_A-ipsec-proposal-tran1] esp authentication-algorithm sha2-256</span><br><span class="line">[FW_A-ipsec-proposal-tran1] esp encryption-algorithm aes-256</span><br><span class="line">[FW_A-ipsec-proposal-tran1] quit</span><br></pre></td></tr></table></figure><p>c、配置IKE安全提议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] ike proposal 10</span><br><span class="line">[FW_A-ike-proposal-10] authentication-method pre-share</span><br><span class="line">[FW_A-ike-proposal-10] encryption-algorithm aes-256</span><br><span class="line">[FW_A-ike-proposal-10] authentication-algorithm sha2-256</span><br><span class="line">[FW_A-ike-proposal-10] dh group14</span><br><span class="line">[FW_A-ike-proposal-10] quit</span><br></pre></td></tr></table></figure><p>d、配置IKE peer</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] ike peer b</span><br><span class="line">[FW_A-ike-peer-b] ike-proposal 10</span><br><span class="line">[FW_A-ike-peer-b] remote-address 23.1.1.2</span><br><span class="line">[FW_A-ike-peer-b] pre-shared-key Test!1234</span><br><span class="line">[FW_A-ike-peer-b] quit</span><br></pre></td></tr></table></figure><p>e、配置IPSec策略</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] ipsec policy map1 10 isakmp</span><br><span class="line">[FW_A-ipsec-policy-isakmp-map1-10] security acl 3000</span><br><span class="line">[FW_A-ipsec-policy-isakmp-map1-10] proposal tran1</span><br><span class="line">[FW_A-ipsec-policy-isakmp-map1-10] ike-peer b</span><br><span class="line">[FW_A-ipsec-policy-isakmp-map1-10] quit</span><br></pre></td></tr></table></figure><p>f、在接口GE1&#x2F;0&#x2F;1上应用IPSec策略组map1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[FW_A] interface gigabitethernet 1/0/1</span><br><span class="line">[FW_A-GigabitEthernet1/0/1] ipsec policy map1</span><br><span class="line">[FW_A-GigabitEthernet1/0/1] quit</span><br></pre></td></tr></table></figure><p><strong>在FW_B上配置IPSec策略，并在接口上应用此IPSec策略。</strong></p><p>a、配置高级ACL 3000，允许10.1.2.0&#x2F;24网段访问10.1.1.0&#x2F;24网段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] acl 3000</span><br><span class="line">[FW_B-acl-adv-3000] rule 5 permit ip source 10.1.2.0 0.0.0.255 destination 10.1.1.0 0.0.0.255</span><br><span class="line">[FW_B-acl-adv-3000] quit</span><br></pre></td></tr></table></figure><p>b、配置IPSec安全提议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] ipsec proposal tran1</span><br><span class="line">[FW_B-ipsec-proposal-tran1] esp authentication-algorithm sha2-256</span><br><span class="line">[FW_B-ipsec-proposal-tran1] esp encryption-algorithm aes-256</span><br><span class="line">[FW_B-ipsec-proposal-tran1] quit</span><br></pre></td></tr></table></figure><p>c、配置IKE安全提议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] ike proposal 10</span><br><span class="line">[FW_B-ike-proposal-10] authentication-method pre-share</span><br><span class="line">[FW_B-ike-proposal-10] prf hmac-sha2-256</span><br><span class="line">[FW_B-ike-proposal-10] encryption-algorithm aes-256</span><br><span class="line">[FW_B-ike-proposal-10] dh group14</span><br><span class="line">[FW_B-ike-proposal-10] integrity-algorithm hmac-sha2-256 </span><br><span class="line">[FW_B-ike-proposal-10] quit</span><br></pre></td></tr></table></figure><p>d、配置IKE peer</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] ike peer a </span><br><span class="line">[FW_B-ike-peer-a] ike-proposal 10 </span><br><span class="line">[FW_B-ike-peer-a] remote-address 1.1.3.1 </span><br><span class="line">[FW_B-ike-peer-a] pre-shared-key Test!1234 </span><br><span class="line">[FW_B-ike-peer-a] quit</span><br></pre></td></tr></table></figure><p>e、配置IPSec策略</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] ipsec policy map1 10 isakmp </span><br><span class="line">[FW_B-ipsec-policy-isakmp-map1-10] security acl 3000 </span><br><span class="line">[FW_B-ipsec-policy-isakmp-map1-10] proposal tran1 </span><br><span class="line">[FW_B-ipsec-policy-isakmp-map1-10] ike-peer a </span><br><span class="line">[FW_B-ipsec-policy-isakmp-map1-10] quit</span><br></pre></td></tr></table></figure><p>f、在接口GE1&#x2F;0&#x2F;1上应用IPSec策略组map1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[FW_B] interface gigabitethernet 1/0/1</span><br><span class="line">[FW_B-GigabitEthernet1/0/1] ipsec policy map1</span><br><span class="line">[FW_B-GigabitEthernet1/0/1] quit</span><br></pre></td></tr></table></figure><p><strong>二、GRE over IPSEC</strong></p><p>1、修改ACL,重新定义ipsec 感兴趣流</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[FW1]acl number 3000</span><br><span class="line">[FW2-acl-adv-3000]undo rule 5 </span><br><span class="line">  Warning: The ACL is referenced by IPSec, if the data flows to be encrypted are deleted, this may cause service interruption. Are you sure to d ：y</span><br><span class="line">[FW2-acl-adv-3000]rule  5 permit gre </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信14&quot;&gt;&lt;a href=&quot;#数据通信14&quot; class=&quot;headerlink&quot; title=&quot;数据通信14&quot;&gt;&lt;/a&gt;数据通信14&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;IPsec&quot;&gt;&lt;a href=&quot;#IPsec&quot; class=&quot;heade</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A113/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A113/</id>
    <published>2024-07-10T07:22:42.520Z</published>
    <updated>2024-03-16T01:06:51.443Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信13"><a href="#数据通信13" class="headerlink" title="数据通信13"></a>数据通信13</h1><p>[TOC]</p><p>多模模块光纤会有可见光</p><h2 id="双机热备实验"><a href="#双机热备实验" class="headerlink" title="双机热备实验"></a>双机热备实验</h2><h3 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a>拓扑图</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240305111446633.png" alt="image-20240305111446633"></p><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p>为了<strong>规避一台设备故障导致网络业务中断的风险</strong>，可以在网络节点处同时部署两台设备，形成双机热备组网。当其中一台设备出现故障时，业务流量能<strong>平滑地切换到备用设备上</strong>，保证业务不中断，使内外网用户交互的时候感知不到曾经出现过网络故障。</p><ul><li>主备备份</li><li>负载分担</li></ul><h3 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h3><p>一般两个路由器就是使用vrrp，但是用在防火墙上就会产生一些bug，上节课有说，故我们<strong>使用vgmp</strong></p><h3 id="VGMP状态机"><a href="#VGMP状态机" class="headerlink" title="VGMP状态机"></a>VGMP状态机</h3><ul><li>initialize：VGMP管理组处于未启用状态。</li><li>Active：本端VGMP管理组的优先级比对端的VGMP管理组优先级高。</li><li>Standby：本端VGMP管理组的优先级比对端的VGMP管理组优先级低</li></ul><p>（vrrp是initialize和backup，master）</p><h3 id="VGMP主从切换"><a href="#VGMP主从切换" class="headerlink" title="VGMP主从切换"></a>VGMP主从切换</h3><ul><li>每个接口down，VGMP管理组优先级降低2。计算公式为：<strong>VGMP优先级&#x3D;VGMP初始优先级-2*接口宕的个数</strong></li><li>每台设备的VGMP管理组<strong>初始状态由用户指定</strong>（Active或Standby），且用户只能指定状态，<strong>不能指定VGMP组的具体的优先级</strong></li><li>③VGMP管理组的状态决定了该设备的主备状态，也决定了VGMP管理组成员（VRRP备份组成员或接口）的状态。（？）</li></ul><h3 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h3><p><strong>步骤一：配置ip地址</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#FW1</span><br><span class="line">[FW1]<span class="type">int</span> g1/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">[FW1-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]ip address <span class="number">10.1</span><span class="number">.2</span><span class="number">.1</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line">[FW1]<span class="type">int</span> g1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">[FW1-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]ip address <span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line">[FW1]firewall zone trust </span><br><span class="line">[FW1-zone-trust]add interface g1/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line"></span><br><span class="line">[FW1]firewall zone untrust </span><br><span class="line">[FW1-zone-untrust]add interface g1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#FW2</span><br><span class="line">[FW2]<span class="type">int</span> g1/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">[FW2-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]ip address <span class="number">10.1</span><span class="number">.2</span><span class="number">.2</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line">[FW2]<span class="type">int</span> g1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">[FW2-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]ip address <span class="number">10.1</span><span class="number">.1</span><span class="number">.2</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line">[FW2]firewall zone  trust </span><br><span class="line">[FW2-zone-trust]add interface g1/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line"></span><br><span class="line">[FW2]firewall zone untrust </span><br><span class="line">[FW2-zone-untrust]add interface g1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>步骤二：配置区域策略</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#FW1</span><br><span class="line">[FW1]security-policy </span><br><span class="line"></span><br><span class="line">[FW1-policy-security]rule name T2U</span><br><span class="line"></span><br><span class="line">[FW1-policy-security-rule-T2U]source-zone trust </span><br><span class="line"></span><br><span class="line">[FW1-policy-security-rule-T2U]destination-zone untrust </span><br><span class="line"></span><br><span class="line">[FW1-policy-security-rule-T2U]action permit </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#FW2</span><br><span class="line">[FW2]security-policy </span><br><span class="line"></span><br><span class="line">[FW2-policy-security]rule name T2U</span><br><span class="line"></span><br><span class="line">[FW2-policy-security-rule-T2U]source-zone trust </span><br><span class="line"></span><br><span class="line">[FW2-policy-security-rule-T2U]destination-zone untrust </span><br><span class="line"></span><br><span class="line">[FW2-policy-security-rule-T2U]action permit</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>步骤三：配置vrrp</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#FW1</span><br><span class="line">[FW1]int g1/0/1</span><br><span class="line"></span><br><span class="line">[FW1-GigabitEthernet1/0/1]vrrp vrid 1 virtual-ip 10.1.1.254 active </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[FW1]int g1/0/0</span><br><span class="line"></span><br><span class="line">[FW1-GigabitEthernet1/0/0]vrrp vrid 1 virtual-ip 10.1.2.254 active </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#FW2</span><br><span class="line">[FW2]int g1/0/1</span><br><span class="line"></span><br><span class="line">[FW2-GigabitEthernet1/0/1]vrrp vrid 1 virtual-ip 10.1.1.254 standby </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[FW2]int g1/0/0</span><br><span class="line"></span><br><span class="line">[FW2-GigabitEthernet1/0/0]vrrp vrid 1 virtual-ip 10.1.2.254 standby</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>步骤四：配置hrp热备份</strong>!!!!</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[ FW1]hrp enable</span><br><span class="line"></span><br><span class="line">HRP_ S [FW1]hrp interface g1/<span class="number">0</span>/<span class="number">2</span> remote <span class="number">10.1</span><span class="number">.3</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line">[ FW2]hrp enable</span><br><span class="line"></span><br><span class="line">HRP_ S [FW2]hrp interface g1/<span class="number">0</span>/<span class="number">2</span> remote <span class="number">10.1</span><span class="number">.3</span><span class="number">.1</span>HRP_ M[ FW2]hrp standby-device</span><br><span class="line"></span><br><span class="line"><span class="comment">//感觉上就和那个ospf虚连接差不多</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a>VPN</h2><p>&#x2F;&#x2F;科学上网，请勿乱用</p><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p><strong>二层</strong></p><ul><li>l2tp</li><li>pptp(淘汰但简单)</li><li>mpls l2 vpn</li></ul><p><strong>三层</strong></p><ul><li>gre（重点简单）</li><li>ipsec（重点巅峰）</li><li>bgp&#x2F;mpls vpn</li></ul><h3 id="其他vpn"><a href="#其他vpn" class="headerlink" title="其他vpn"></a>其他vpn</h3><ul><li>ssl</li><li>l2f</li><li>dvpn</li><li>基于vlan的vpn</li><li>802.1qinq</li><li>xot</li></ul><h3 id="GRE（ip协议号47）"><a href="#GRE（ip协议号47）" class="headerlink" title="GRE（ip协议号47）"></a>GRE（ip协议号47）</h3><p><strong>虚拟的隧道（Tunnel接口）</strong></p><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>通用路由封装协议（Generic Rrouting Encapsulation），他的作用是<strong>把一种协议的报文封装在另外一种协议的报文中</strong>的技术，是一种隧道技术（只要这样子做，都称为隧道技术）</p><h4 id="报文结构（加封装）"><a href="#报文结构（加封装）" class="headerlink" title="报文结构（加封装）"></a>报文结构（加封装）</h4><p>在原始封装的数据报文字段中<strong>加入新的IP头部</strong>，在<strong>新的IP报头和老的IP报头中间加一个协议</strong>，这就是GRE报头。 </p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240309141300500.png" alt="image-20240309141300500"></p><p><strong>头部</strong></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image7(421).png" alt="img"></p><p>把原本的IP报头当成货物，这个被称为<strong>乘客协议</strong>，GRE负责承载乘客协议的IP报文，<strong>GRE可以理解为车辆</strong>，然后由新的IP报头在公网进行传输，<strong>公网设备只会查看新的IP报头</strong>，然后进行转发。</p><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul><li>支持多种协议</li><li>靠IP做为承载网络</li><li><strong>支持路由协议和IP组播</strong></li><li>配置简单</li></ul><h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul><li>点对点隧道</li><li>静态配置隧道参数</li><li>部署复杂连接时代价大</li><li><strong>不安全</strong></li></ul><h3 id="传输过程"><a href="#传输过程" class="headerlink" title="传输过程"></a>传输过程</h3><ul><li>私网数据报文保留，加上GRE报头和新的IP报头（隧道源和隧道目标）。</li><li><strong>数据报文发送出去后，中途运营商的设备会根据外层的IP报头进行转发。</strong></li><li>目标设备收到数据报文后，进行<strong>解封装</strong>，<strong>看到GRE报文后</strong>，会继续解封装，然后在看到原先发送的数据报文，<strong>发现是私网包头，进行查找路由</strong>，发现有就进行转发，回包也是如此，这就完成通讯。</li></ul><p><strong><u>做GRE时严禁将公网进行ospf宣告</u></strong></p><h3 id="GRE隧道keeplive"><a href="#GRE隧道keeplive" class="headerlink" title="GRE隧道keeplive"></a>GRE隧道keeplive</h3><p>和ospf保持邻居关系、心跳线设置差不多，都是检测对方或者线路有无故障</p><h3 id="GRE实验配置"><a href="#GRE实验配置" class="headerlink" title="GRE实验配置"></a>GRE实验配置</h3><h4 id="拓扑图-1"><a href="#拓扑图-1" class="headerlink" title="拓扑图"></a>拓扑图</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/45599" alt="img"></p><h4 id="配置设备IP地址"><a href="#配置设备IP地址" class="headerlink" title="配置设备IP地址"></a>配置设备IP地址</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">FW1]inter g1/<span class="number">0</span>/<span class="number">2</span> </span><br><span class="line">[FW1-GigabitEthernet1/<span class="number">0</span>/<span class="number">2</span>]ip add <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> </span><br><span class="line"><span class="number">24</span> </span><br><span class="line">[FW1-GigabitEthernet1/<span class="number">0</span>/<span class="number">2</span>]inter g1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"> [FW1-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]ip add <span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span> </span><br><span class="line"><span class="number">24</span> </span><br><span class="line">[Huawei]inter g0/<span class="number">0</span>/<span class="number">0</span> </span><br><span class="line">[Huawei-GigabitEthernet0/<span class="number">0</span>/<span class="number">0</span>]ip add </span><br><span class="line"><span class="number">13.1</span><span class="number">.1</span><span class="number">.3</span> <span class="number">24</span> </span><br><span class="line">[Huawei]inter g0/<span class="number">0</span>/<span class="number">1</span> </span><br><span class="line">[Huawei-GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span>]ip add </span><br><span class="line"><span class="number">23.1</span><span class="number">.1</span><span class="number">.3</span> <span class="number">24</span></span><br><span class="line"><span class="comment">// [Huawei]int lo 0</span></span><br><span class="line"><span class="comment">//[Huawei-Loopback0]ip add 1.1.1.1 24</span></span><br><span class="line">[FW2]inter g1/<span class="number">0</span>/<span class="number">2</span> </span><br><span class="line">[FW2-GigabitEthernet1/<span class="number">0</span>/<span class="number">2</span>]ip add <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> </span><br><span class="line"><span class="number">24</span> </span><br><span class="line">[FW2]inter g1/<span class="number">0</span>/<span class="number">1</span> </span><br><span class="line">[FW2-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]ip add <span class="number">10.1</span><span class="number">.2</span><span class="number">.1</span> </span><br><span class="line"><span class="number">24</span></span><br></pre></td></tr></table></figure><h4 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#FW1</span></span><br><span class="line"> [<span class="meta">FW1</span>]firewall zone untrust </span><br><span class="line">[<span class="meta">FW1-zone-untrust</span>]<span class="keyword">add</span> <span class="keyword">interface</span> <span class="title">g1</span>/0/2 </span><br><span class="line">    </span><br><span class="line">[<span class="title">FW1</span>]<span class="title">firewall</span> <span class="title">zone</span> <span class="title">trust</span> </span><br><span class="line">[<span class="title">FW1</span>-<span class="title">zone</span>-<span class="title">trust</span>]<span class="title">add</span> <span class="title">interface</span> <span class="title">g1</span>/0/1 </span><br><span class="line">    </span><br><span class="line">#<span class="title">FW2</span></span><br><span class="line"> [<span class="title">FW2</span>]<span class="title">firewall</span> <span class="title">zone</span> <span class="title">untrust</span> </span><br><span class="line">[<span class="title">FW2</span>-<span class="title">zone</span>-<span class="title">untrust</span>]<span class="title">add</span> <span class="title">interface</span> <span class="title">g1</span>/0/2 </span><br><span class="line">    </span><br><span class="line">[<span class="title">FW2</span>]<span class="title">firewall</span> <span class="title">zone</span> <span class="title">trust</span> </span><br><span class="line">[<span class="title">FW2</span>-<span class="title">zone</span>-<span class="title">trust</span>]<span class="title">add</span> <span class="title">interface</span> <span class="title">g1</span>/0/1</span><br></pre></td></tr></table></figure><h4 id="配置OSPF"><a href="#配置OSPF" class="headerlink" title="配置OSPF"></a>配置OSPF</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//严禁将公网ip通过ospf进行宣告 </span></span><br><span class="line">[FW1]ospf <span class="number">1</span> </span><br><span class="line">[FW1-ospf<span class="number">-1</span>]area <span class="number">0</span></span><br><span class="line"> [FW1-ospf<span class="number">-1</span>-area<span class="number">-0.0</span><span class="number">.0</span><span class="number">.0</span>]network <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> </span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">    </span><br><span class="line"> [AR3]ospf <span class="number">1</span> </span><br><span class="line">[AR3-ospf<span class="number">-1</span>]area <span class="number">0</span> </span><br><span class="line">[AR3-ospf<span class="number">-1</span>-area<span class="number">-0.0</span><span class="number">.0</span><span class="number">.0</span>]network <span class="number">13.1</span><span class="number">.1</span><span class="number">.0</span> </span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line"> [AR3-ospf<span class="number">-1</span>-area<span class="number">-0.0</span><span class="number">.0</span><span class="number">.0</span>]network <span class="number">23.1</span><span class="number">.1</span><span class="number">.0</span> </span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line"> [AR3-ospf<span class="number">-1</span>-area<span class="number">-0.0</span><span class="number">.0</span><span class="number">.0</span>]network <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span> </span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">    </span><br><span class="line"> [FW2]ospf <span class="number">1</span> </span><br><span class="line">[FW2-ospf<span class="number">-1</span>]area <span class="number">0</span> </span><br><span class="line">[FW2-ospf<span class="number">-1</span>-area<span class="number">-0.0</span><span class="number">.0</span><span class="number">.0</span>]network <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> </span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br></pre></td></tr></table></figure><h4 id="配置NAT"><a href="#配置NAT" class="headerlink" title="配置NAT"></a>配置NAT</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//FW1 安全策略</span></span><br><span class="line">[FW1]security-policy </span><br><span class="line">[FW1-policy-security]rule name T2U</span><br><span class="line"> [FW1-policy-security-rule-T2U]source-zone </span><br><span class="line">trust </span><br><span class="line">[FW1-policy-security-rule-T2U]destination</span><br><span class="line">zone untrust </span><br><span class="line">[FW1-policy-security-rule-T2U]action permit</span><br><span class="line">    </span><br><span class="line"> <span class="comment">//FW1 配置NAT</span></span><br><span class="line"> [FW1]nat-policy </span><br><span class="line">[FW1-policy-nat]rule name all </span><br><span class="line">[FW1-policy-nat-rule-all] source-zone trust</span><br><span class="line"> [FW1-policy-nat-rule-all]egress-interface </span><br><span class="line">GigabitEthernet1/<span class="number">0</span>/<span class="number">2</span><span class="comment">//选择出接口</span></span><br><span class="line"> [FW1-policy-nat-rule-all]action source-nat </span><br><span class="line">easy-ip<span class="comment">//转换ip靠接口</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//FW2 流量策略</span></span><br><span class="line">[FW2]security-policy </span><br><span class="line">[FW2-policy-security]rule name T2U </span><br><span class="line">[FW2-policy-security-rule-T2U]source-zone </span><br><span class="line">trust </span><br><span class="line">[FW2-policy-security-rule-T2U]destination</span><br><span class="line">zone untrust </span><br><span class="line">[FW2-policy-security-rule-T2U]action permit</span><br><span class="line">    </span><br><span class="line"> <span class="comment">//FW2 配置NAT</span></span><br><span class="line"> [FW2]nat-policy </span><br><span class="line">[FW2-policy-nat]rule name all </span><br><span class="line">[FW2-policy-nat-rule-all]source-zone trust </span><br><span class="line">[FW2-policy-nat-rule-all]egress-interface </span><br><span class="line">GigabitEthernet1/<span class="number">0</span>/<span class="number">2</span> </span><br><span class="line">[FW2-policy-nat-rule-all]action source-nat </span><br><span class="line">easy-ip</span><br></pre></td></tr></table></figure><h4 id="配置GRE-VPN"><a href="#配置GRE-VPN" class="headerlink" title="配置GRE VPN"></a>配置GRE VPN</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//FW1</span></span><br><span class="line"> [FW1]interface Tunnel <span class="number">0</span> </span><br><span class="line"><span class="comment">//[FW1-Tunnel0]tunnel-protocol gre </span></span><br><span class="line">[FW1-Tunnel0]source <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> </span><br><span class="line">[FW1-Tunnel0]destination <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> </span><br><span class="line">[FW1-Tunnel0]ip add <span class="number">12.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">24</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">//FW2</span></span><br><span class="line"> [FW2]interface Tunnel <span class="number">0</span></span><br><span class="line"> [FW2-Tunnel0]tunnel-protocol gre </span><br><span class="line">[FW2-Tunnel0]source <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> </span><br><span class="line">[FW2-Tunnel0]destination <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> </span><br><span class="line">[FW2-Tunnel0]ip add <span class="number">12.1</span><span class="number">.1</span><span class="number">.2</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//配置虚拟接口所属区域</span></span><br><span class="line"><span class="comment">//FW1</span></span><br><span class="line"> [FW1]firewall zone untrust </span><br><span class="line">[FW1-zone-untrust]add interface Tunnel <span class="number">0</span></span><br><span class="line"> <span class="comment">//FW2</span></span><br><span class="line"> [FW2]firewall zone untrust </span><br><span class="line">[FW2-zone-untrust]add interface Tunnel <span class="number">0</span></span><br></pre></td></tr></table></figure><h4 id="配置VPN路由"><a href="#配置VPN路由" class="headerlink" title="配置VPN路由"></a>配置VPN路由</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//FW1</span></span><br><span class="line"> [FW1]ip route-<span class="type">static</span> <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> <span class="number">24</span> <span class="number">12.1</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"> <span class="comment">//FW2</span></span><br><span class="line"> [FW2]ip route-<span class="type">static</span> <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> <span class="number">24</span> <span class="number">12.1</span><span class="number">.1</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><h4 id="配置VPN接口的策略"><a href="#配置VPN接口的策略" class="headerlink" title="配置VPN接口的策略"></a>配置VPN接口的策略</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fw1（配置这个的目的是等下做策略要使用的地址）</span></span><br><span class="line"> [FW1]ip address-<span class="built_in">set</span> <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> type object </span><br><span class="line">[FW1-object-address-<span class="built_in">set</span><span class="number">-23.1</span><span class="number">.1</span><span class="number">.2</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> mask <span class="number">32</span></span><br><span class="line"> </span><br><span class="line"> [FW1]ip address-<span class="built_in">set</span> <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> type object </span><br><span class="line">[FW1-object-address-<span class="built_in">set</span><span class="number">-13.1</span><span class="number">.1</span><span class="number">.1</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> mask <span class="number">32</span></span><br><span class="line"> </span><br><span class="line"> [FW1]ip address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> type object </span><br><span class="line">[FW1-object-address-<span class="built_in">set</span><span class="number">-10.1</span><span class="number">.1</span><span class="number">.0</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> mask <span class="number">24</span></span><br><span class="line"></span><br><span class="line"> [FW1]ip address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> type object </span><br><span class="line">[FW1-object-address-<span class="built_in">set</span><span class="number">-10.1</span><span class="number">.2</span><span class="number">.0</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> mask <span class="number">24</span></span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line"> <span class="comment">// 配置策略</span></span><br><span class="line">[FW1]security-policy</span><br><span class="line"> [FW1-policy-security]rule name U2T</span><br><span class="line"> [FW1-policy-security-rule-U2T]  source-zone </span><br><span class="line">untrust</span><br><span class="line"> [FW1-policy-security-rule-U2T]  </span><br><span class="line">destination-zone trust</span><br><span class="line">     </span><br><span class="line"> [FW1-policy-security-rule-U2T]  source</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span></span><br><span class="line"> [FW1-policy-security-rule-U2T]  </span><br><span class="line">destination-address address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span></span><br><span class="line"> [FW1-policy-security-rule-U2T]  action </span><br><span class="line">permit</span><br><span class="line">     </span><br><span class="line"> [FW1-policy-security-rule-U2T] rule name </span><br><span class="line">U2L</span><br><span class="line"> [FW1-policy-security-rule-U2L]  source-zone </span><br><span class="line">untrust</span><br><span class="line"> [FW1-policy-security-rule-U2L]  </span><br><span class="line">destination-zone local</span><br><span class="line">     </span><br><span class="line"> [FW1-policy-security-rule-U2L]  source</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"> [FW1-policy-security-rule-U2L]  </span><br><span class="line">destination-address address-<span class="built_in">set</span> <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line"> [FW1-policy-security-rule-U2L]  action </span><br><span class="line">permit</span><br><span class="line"> <span class="comment">//！！再添加Local to Untrust的策略！！</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">//fw2</span></span><br><span class="line"> [FW2]ip address-<span class="built_in">set</span> <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> type object </span><br><span class="line">[FW2-object-address-<span class="built_in">set</span><span class="number">-13.1</span><span class="number">.1</span><span class="number">.1</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span> mask <span class="number">32</span></span><br><span class="line"> </span><br><span class="line"> [FW2]ip address-<span class="built_in">set</span>  <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> type object </span><br><span class="line">[FW2-object-address-<span class="built_in">set</span><span class="number">-23.1</span><span class="number">.1</span><span class="number">.2</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> mask <span class="number">32</span></span><br><span class="line"></span><br><span class="line"> [FW2]ip address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> type object </span><br><span class="line">[FW2-object-address-<span class="built_in">set</span><span class="number">-10.1</span><span class="number">.1</span><span class="number">.0</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> mask <span class="number">24</span></span><br><span class="line"> </span><br><span class="line"> [FW2]ip address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> type object </span><br><span class="line">[FW2-object-address-<span class="built_in">set</span><span class="number">-10.1</span><span class="number">.2</span><span class="number">.0</span>]address <span class="number">0</span> </span><br><span class="line"><span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> mask <span class="number">24</span></span><br><span class="line"><span class="comment">// 配置策略</span></span><br><span class="line">[FW2]security-policy </span><br><span class="line">[FW2-policy-security]rule name U2T</span><br><span class="line"> [FW2-policy-security-rule-U2T]source-zone </span><br><span class="line">untrust </span><br><span class="line">[FW2-policy-security-rule-U2T]destination</span><br><span class="line">zone trust </span><br><span class="line">     </span><br><span class="line">[FW2-policy-security-rule-U2T]source</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span></span><br><span class="line"> [FW2-policy-security-rule-U2T]destination</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span></span><br><span class="line"> [FW2-policy-security-rule-U2T]action permit </span><br><span class="line">     </span><br><span class="line">[FW2-policy-security]rule name U2L</span><br><span class="line"> [FW2-policy-security-rule-U2L]source-zone </span><br><span class="line">untrust </span><br><span class="line">[FW2-policy-security-rule-U2L]destination</span><br><span class="line">zone local </span><br><span class="line">     </span><br><span class="line">[FW2-policy-security-rule-U2L]source</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">13.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line"> [FW2-policy-security-rule-U2L]destination</span><br><span class="line">address address-<span class="built_in">set</span> <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"> [FW2-policy-security-rule-U2L]action permit </span><br><span class="line"><span class="comment">//！！再添加Local to Untrust的策略！！</span></span><br></pre></td></tr></table></figure><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><h5 id="pc互ping"><a href="#pc互ping" class="headerlink" title="pc互ping"></a>pc互ping</h5><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240309181925871.png" alt="image-20240309181925871"></p><h5 id="虚接口互ping"><a href="#虚接口互ping" class="headerlink" title="虚接口互ping"></a>虚接口互ping</h5><p><strong>加上两条命令</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[FW1-Tunnel1]service-manage ping permit</span><br><span class="line"> [FW2-Tunnel1]service-manage ping permit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240309182133724.png" alt="image-20240309182133724"></p><p>我的结果成功了，但是延迟普遍上了100ms，不知为何</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信13&quot;&gt;&lt;a href=&quot;#数据通信13&quot; class=&quot;headerlink&quot; title=&quot;数据通信13&quot;&gt;&lt;/a&gt;数据通信13&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;多模模块光纤会有可见光&lt;/p&gt;
&lt;h2 id=&quot;双机热备实验&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A112/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A112/</id>
    <published>2024-07-10T07:22:42.518Z</published>
    <updated>2024-03-16T01:07:00.832Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信12"><a href="#数据通信12" class="headerlink" title="数据通信12"></a>数据通信12</h1><p>&#x2F;&#x2F;寒假回来第一次上课</p><p>[TOC]</p><h2 id="信息安全"><a href="#信息安全" class="headerlink" title="信息安全"></a>信息安全</h2><p><strong>目标：</strong></p><ul><li><p>完整性</p></li><li><p>可用性</p></li><li><p>保密性</p></li></ul><p> <strong>攻击类别：</strong></p><ul><li>ddos</li><li>勒索攻击</li><li>dns</li><li>sql注入</li><li>dns隧道</li></ul><h2 id="防火墙web安装"><a href="#防火墙web安装" class="headerlink" title="防火墙web安装"></a>防火墙web安装</h2><ol><li>打开pnet，按如图连接拓扑图</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240305110539550.png" alt="image-20240305110539550"></p><ol start="2"><li>mgmt是管理员端口，进入该端口进行配置</li><li>配置IP（ip add 192.168.32.132  和模拟器在同一个网段）、打开service服务（service-manage all permit）</li><li>接着在浏览器输入地址进入web界面（192.168.32.132：8443    部分浏览器由于版本过高进入不了，使用火狐浏览器并且修改tls解决）</li></ol><h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><h3 id="安全区域"><a href="#安全区域" class="headerlink" title="安全区域"></a>安全区域</h3><p>是一个或者多个接口的集合，是防火墙区别于路由器的主要特性（有点像ospf域）</p><p>DMZ–缓冲区，可以访问untrust区，不可以访问trust区，一般是服务器区</p><p>trust区–办公设备</p><p>untrust–外网</p><h3 id="防火墙策略"><a href="#防火墙策略" class="headerlink" title="防火墙策略"></a>防火墙策略</h3><p>防火墙必备检测命令：display firewall session table verbose source inside x.x.x.x</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240302152031459.png" alt="image-20240302152031459"></p><p>多条策略被同一动作匹配按顺序使用</p><h3 id="状态检测"><a href="#状态检测" class="headerlink" title="状态检测"></a>状态检测</h3><ul><li><p>针对数据的首包</p></li><li><p>如果是一个首包，并且安全策略为允许的话，就会为该流量建立一个会话表，该流量其他的数据包就可以根据会话表而不是安全策略转发了。</p></li></ul><p>例如，如果要配置允许Trust区域PING Untrust区域。则在防火墙策略配置的时候，只需要配置Trust区域到Untrust区域的ICMP协议为允许即可，而不需要考虑ICMP Reply报文需要从Untrust区域发到Trust区域。</p><p>在状态检测机制开启状态下，只有首包通过设备才能建立会话表项，后续包直接匹配会话表项进行转发。在状态检测机制<strong>关闭状态下，<em>即使首包没有经过防火墙</em></strong>，后续包<strong>只需要通过防火墙也可以生成会话表项。</strong></p><p>关闭状态检测命令：undo firewall session link-state check</p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/20190314110851442.png" alt="在这里插入图片描述"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">TCP: SYN ---------首包</span><br><span class="line">​ SYN+ACK</span><br><span class="line">​ ACK</span><br><span class="line"></span><br><span class="line">ICMP echo-request----首包</span><br><span class="line">​ echo-reply</span><br><span class="line"></span><br><span class="line">UDP没有首包概念</span><br></pre></td></tr></table></figure><h3 id="会话机制"><a href="#会话机制" class="headerlink" title="会话机制"></a>会话机制</h3><p><strong>会话表的十三项参数</strong></p><ul><li><p>协议—指明会话的协议</p></li><li><p>VPN—在虚拟防火墙中使用</p></li><li><p>ID—标志唯一的会话</p></li><li><p>ZONE（区域）—指明流量的区域走向。</p></li><li><p>TTL—会话的老化时间。</p></li><li><p>Left—会话剩余时间</p></li><li><p>output-interface—出接口</p></li><li><p>nextHop—下一跳</p></li><li><p>MAC—mac地址,</p></li><li><p>MAC地址为全0的情况：</p></li><li><p>反向流量统计</p></li><li><p>正向流量统计</p></li><li><p>五元组—<strong>源地址</strong>：<strong>源端口</strong>–&gt;<strong>目的地址</strong>：<strong>目的端口</strong>+<strong>4层通信协议</strong></p></li><li><p>PolicyName—匹配的策略名称</p></li></ul><p>栗子：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[FW1]<span class="comment">//display firewall session table  ---------------查看会话表简要信息</span></span><br><span class="line"> Current Total Sessions : <span class="number">5</span></span><br><span class="line">  https  VPN:public --&gt; public <span class="number">192.168</span><span class="number">.0</span><span class="number">.100</span>:<span class="number">49363</span>--&gt;<span class="number">192.168</span><span class="number">.0</span><span class="number">.10</span>:<span class="number">8443</span></span><br><span class="line">  协议（https等）    虚拟防火墙有作用（vpn）         源地址：源端口 目标地址：目标端口</span><br><span class="line">  https  VPN:public --&gt; public <span class="number">192.168</span><span class="number">.0</span><span class="number">.100</span>:<span class="number">49350</span>--&gt;<span class="number">192.168</span><span class="number">.0</span><span class="number">.10</span>:<span class="number">8443</span></span><br><span class="line">  tcp  VPN:public --&gt; public <span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">49395</span>--&gt;<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="number">17889</span></span><br><span class="line">  ftp-data  VPN:public --&gt; public <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">20</span>--&gt;<span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">49396</span></span><br><span class="line">  ftp  VPN:public --&gt; public <span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">49393</span>+-&gt;<span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span>:<span class="number">21</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><h4 id="双机热备实验"><a href="#双机热备实验" class="headerlink" title="双机热备实验"></a><strong>双机热备实验</strong></h4><h5 id="vrrp的特点"><a href="#vrrp的特点" class="headerlink" title="vrrp的特点"></a><strong>vrrp的特点</strong></h5><ul><li><p>默认优先级100-一样的情况下比较接口ip，IP大的是master</p></li><li><p>数据从master走</p></li><li><p>通过arp请求控制来让下层明白谁才是老大</p></li><li><p>一秒发hello包</p></li><li><p>三秒完成主备切换</p></li><li><p>上层线路可能会断开，需要进行检测</p></li></ul><h5 id="vrrp状态机"><a href="#vrrp状态机" class="headerlink" title="vrrp状态机"></a>vrrp状态机</h5><ul><li>initialize</li><li>backup</li><li>master</li></ul><h5 id="vrrp用于防火墙bug"><a href="#vrrp用于防火墙bug" class="headerlink" title="vrrp用于防火墙bug"></a><strong>vrrp用于防火墙bug</strong></h5><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240302210456607.png" alt="image-20240302210456607"></p><p>主要问题是由于两台防火墙<strong>的备份组角色不同</strong>导致出现线路故障而丢包（）</p><p>为了解决vrrp在防火墙配置中的bug，vrrp的升级版出现了—<strong>VGMP</strong></p><h5 id="VGMP特点"><a href="#VGMP特点" class="headerlink" title="VGMP特点"></a>VGMP特点</h5><ul><li>双机间增加线路心跳线用于检测对方是否正常工作，否则切换角色</li><li>主设备状态叫active，备份机叫standby</li></ul><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240302211714218.png" alt="image-20240302211714218"></p><h5 id="VGMP状态机"><a href="#VGMP状态机" class="headerlink" title="VGMP状态机"></a>VGMP状态机</h5><ul><li>Initialise： 启用双机热备功能后，VGMP管理组的初始状态。</li><li><strong>Load Blance</strong>： 当防火墙本端的VGMP管理组与对端的VGMP管理组优先级相等时，两端的VGMP组都处于Load Blance状态。报文转发负载均衡。</li><li>Active： 当本端的VGMP管理组高于对端时，本端的VGMP组处于Active状态，负责报文的转发。</li><li>Standby： 当本端的VGMP管理组低于对端时，本端的VGMP组处于Standby状态，负责监听Active端的状态。</li></ul><h5 id="VGMP状态切换"><a href="#VGMP状态切换" class="headerlink" title="VGMP状态切换"></a>VGMP状态切换</h5><ul><li>接口故障导致优先级降低</li><li>心跳线故障（3s切换）</li><li>主机恢复</li></ul><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240302190658065.png" alt="image-20240302190658065"></p><h6 id="切换原则"><a href="#切换原则" class="headerlink" title="切换原则"></a>切换原则</h6><ul><li>每个接口down，VGMP管理组优先级降低2。计算公式为：<strong>VGMP优先级&#x3D;VGMP初始优先级-2*接口宕的个数</strong></li><li>每台设备的VGMP管理组<strong>初始状态由用户指定</strong>（Active或Standby），且用户只能指定状态，<strong>不能指定VGMP组的具体的优先级</strong></li><li>③VGMP管理组的状态决定了该设备的主备状态，也决定了VGMP管理组成员（VRRP备份组成员或接口）的状态。（？）</li></ul><p>*实验下周</p><p><strong>拓扑图</strong></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20240305111446633.png" alt="image-20240305111446633"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信12&quot;&gt;&lt;a href=&quot;#数据通信12&quot; class=&quot;headerlink&quot; title=&quot;数据通信12&quot;&gt;&lt;/a&gt;数据通信12&lt;/h1&gt;&lt;p&gt;&amp;#x2F;&amp;#x2F;寒假回来第一次上课&lt;/p&gt;
&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;信息安全&quot;&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A111/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A111/</id>
    <published>2024-07-10T07:22:42.516Z</published>
    <updated>2023-12-21T16:58:14.165Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信11"><a href="#数据通信11" class="headerlink" title="数据通信11"></a>数据通信11</h1><p>要学会避责，成为甩锅大神</p><h2 id="网络准入控制NAC"><a href="#网络准入控制NAC" class="headerlink" title="网络准入控制NAC"></a>网络准入控制NAC</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>NAC（Network Admission Control）称为网络接入控制，是一种“端到端”的安全结构，包括<strong>802.1x认证</strong>、<strong>MAC认证</strong>（不建议使用）与<strong>Portal</strong>认证。</p><p>NAC安全构架包括三个关键组件：NAC终端、网络准入设备和准入服务器。</p><p><strong>基本原理</strong></p><ol><li>终端和网络准入设备交换报文，准入设备获取身份认证信息</li><li>准入设备将认证信息发送给服务器进行对比认证</li><li>查看合不合法，发送认证结果和策略</li><li>准入设备再转发给终端</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231217095059072.png" alt="image-20231217095059072"></p><h3 id="802-1x认证"><a href="#802-1x认证" class="headerlink" title="802.1x认证"></a>802.1x认证</h3><p>前提：搭建acs服务器，丢个iso镜像进模拟器，一路下一步（硬盘给80个g，进入之后要做一系列预配置）</p><ol><li>终端发送认证请求给接入设备(EAPOL-Start)</li><li>接入设备询问终端的用户名(EAP-Request&#x2F;Identity)</li><li>响应询问请求，回复准入设备身份信息</li><li>接入设备转发终端的信息给服务器（EAP封装在RADIUS报文中）</li><li>RADIUS服务器收到设备端转发的用户名信息后，将该信息与数据库中的用户名列表中对比，找到该用户名对应的密码信息，用<strong>随机生成的一个MD5 Challenge对密码进行加密处理</strong>，同时将此MD5 Challenge通过RADIUS Access-Challenge报文发送给设备端。</li><li>接入设备转发给终端MD5 challenge</li><li>终端又将这个报文对密码加密在发回去一个EAP-Response&#x2F;MD5 Challenge报文</li><li>接入设备封装后再转发</li><li>RADIUS服务器将收到的已加密的密码信息和本地经过加密运算后的密码信息进行对比，如果相同，则认为该用户为合法用户，并向设备端发送认证<strong>通过报文（RADIUS Access-Accept）。</strong>（双加密认证）</li><li>接入设备收到通过报文后打开端口允许通信</li><li>之后会有类似于ospf的邻居维持的过程：设备端会通过向客户端<strong>定期发送握手报文</strong>的方法，对用户的在线情况进行监测，若设备端发送的<strong>两次握手请求报文都未得到客户端应答，设备端就会让用户下线</strong>，防止用户因为异常原因下线而设备无法感知。</li><li>客户端可以发送EAPOL-Logoff帧给设备端，主动要求下线，设备端把端口状态从授权状态改变成未授权状态，并向客户端发送EAP-Failure报文。</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/fig_dc_fd_nac_000403.png" alt="img"></p><p>实验爆炸了，acs服务器玩不了</p><h3 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231222003055211.png" alt="image-20231222003055211"></p><h2 id="pppoe"><a href="#pppoe" class="headerlink" title="pppoe"></a>pppoe</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>ppp就是之前学的点对点通信，有两种认证方式，后面的oabcde就是封装在什么协议上，比如oe就是在以太网进行的ppp</p><h3 id="实验配置-1"><a href="#实验配置-1" class="headerlink" title="实验配置"></a>实验配置</h3><ol><li>配置R1为pppoe服务端</li><li>在R1上创建认证用户（账号：02365308051密码:992713,账号一般是手机号，密码一般是身份证后六位）</li><li>配置R2为pppoe客户端</li></ol><p>关键点：服务器端口为virtual-template客户端为dialer口</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">一、預配置，配置路由器接口</span><br><span class="line">r1：<span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">ip ad <span class="number">10.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">24</span></span><br><span class="line">r2：<span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">ip ad <span class="number">192.168</span><span class="number">.77</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">    </span><br><span class="line">二、AR1上配置pppoe service</span><br><span class="line">a，配置ip地址池</span><br><span class="line">    ip pool ben</span><br><span class="line">    net <span class="number">10.1</span><span class="number">.2</span><span class="number">.0</span> mask <span class="number">24</span></span><br><span class="line">b，配置认证用户</span><br><span class="line">    aaa</span><br><span class="line">    local-user <span class="number">02365308051</span> password ciper <span class="number">992713</span></span><br><span class="line">    local-user <span class="number">02365308051</span> service-type ppp</span><br><span class="line">c、创建虚拟vt接口</span><br><span class="line">    <span class="type">int</span> virtual-template <span class="number">1</span></span><br><span class="line">    ppp authentication-mode pap</span><br><span class="line">    ip ad <span class="number">10.1</span><span class="number">.2</span><span class="number">.1</span> <span class="number">24</span></span><br><span class="line">    remote add pool ben</span><br><span class="line">d，关联物理接口</span><br><span class="line">    <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">    pppoe-sever bind virtual-template <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">三、AR2上配置pppoe client</span><br><span class="line">a，创建虚拟接口dialer</span><br><span class="line">    <span class="type">int</span> dialer <span class="number">2</span></span><br><span class="line">link-protocol ppp<span class="comment">//配置链路为ppp</span></span><br><span class="line">ppp ipcp <span class="keyword">default</span>-route<span class="comment">//通过ipcp自动获取默认路由</span></span><br><span class="line">ppp pap  local-user <span class="number">02365308051</span> password ciper <span class="number">992713</span><span class="comment">//配置ppp用户名密码</span></span><br><span class="line">ppp chap user <span class="number">02365308051</span> <span class="comment">//配置chap用户名密码</span></span><br><span class="line">ppp chap password cipher <span class="number">992713</span><span class="comment">//配置chap用户名密码</span></span><br><span class="line">ip ad ppp-negotiate<span class="comment">//地址为自动协商</span></span><br><span class="line">dialer user <span class="number">02365308051</span><span class="comment">//配置为共享拨号中心</span></span><br><span class="line">dialer bundle <span class="number">2</span><span class="comment">//配置拨号捆绑接口为2</span></span><br><span class="line">    </span><br><span class="line">四、配置nat地址转换（easy ip）</span><br><span class="line">a,配置acl</span><br><span class="line">acl number <span class="number">2000</span></span><br><span class="line">rule permit </span><br><span class="line">b，配置easy nat</span><br><span class="line"><span class="type">int</span> dialer <span class="number">1</span><span class="comment">//三层通信是进行在这个虚拟接口上，物理接口变成了二层通信</span></span><br><span class="line">nat outbound <span class="number">2000</span></span><br></pre></td></tr></table></figure><h2 id="路由堆叠"><a href="#路由堆叠" class="headerlink" title="路由堆叠"></a>路由堆叠</h2><h3 id="堆叠的优点"><a href="#堆叠的优点" class="headerlink" title="堆叠的优点"></a>堆叠的优点</h3><ul><li>提高可靠性（一个坏了还有另外一个）</li><li>扩展端口数量（增加接入用户）</li><li>简化组网（逻辑上变成一个路由器，可以避免stp生成树的问题）</li><li>长距离堆叠（？）</li></ul><h3 id="成员交换机"><a href="#成员交换机" class="headerlink" title="成员交换机"></a>成员交换机</h3><ul><li><p>主交换机（<strong>Master</strong>）</p><p>主交换机负责管理整个堆叠。堆叠系统中只有一台主交换机。</p></li><li><p>备交换机（<strong>Standby</strong>）</p><p>备交换机是主交换机的备份交换机。堆叠系统中只有一台备交换机。当主交换机故障时，备交换机会接替原主交换机的所有业务。</p></li><li><p>从交换机（<strong>Slave</strong>）</p><p>从交换机用于业务转发，堆叠系统中可以有多台从交换机。从交换机数量越多，堆叠系统的转发带宽越大。</p></li></ul><h3 id="堆叠ID"><a href="#堆叠ID" class="headerlink" title="堆叠ID"></a>堆叠ID</h3><p>堆叠ID用来标识堆叠成员交换机，是成员交换机的<strong>槽位号</strong>。每个堆叠成员交换机在堆叠系统中具<strong>有唯一的堆叠ID。</strong></p><h3 id="堆叠优先级"><a href="#堆叠优先级" class="headerlink" title="堆叠优先级"></a>堆叠优先级</h3><p>堆叠优先级是成员交换机的一个属性<strong>，主要用于角色选举过程中确定成员交换机的角色</strong>，优先级值越大表示优先级越高<strong>，优先级越高当选为主交换机的可能性越大</strong></p><h3 id="实验配置-2"><a href="#实验配置-2" class="headerlink" title="实验配置"></a>实验配置</h3><h4 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a>拓扑图</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/v2-39cfb4594def153284ad964e72ccaea2_1440w.webp" alt="img"></p><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如拓扑图所示，完成2台SR8800路由器的IRF堆叠配置</span></span><br><span class="line"></span><br><span class="line">SR8808<span class="number">-01</span>路由器IRF配置：</span><br><span class="line"></span><br><span class="line">步骤<span class="number">1</span>：将运行模式由独立运行模式切换为IRF模式</span><br><span class="line"></span><br><span class="line">[H3C]chassis convert mode irf <span class="comment">//将运行模式由独立运行模式切换为IRF模式</span></span><br><span class="line"></span><br><span class="line">步骤<span class="number">2</span>：配置IRF</span><br><span class="line"></span><br><span class="line">[H3C]irf member <span class="number">1</span> priority <span class="number">20</span> <span class="comment">//配置成员编号及优先级</span></span><br><span class="line"></span><br><span class="line">[H3C]irf member <span class="number">1</span> description SR8808<span class="number">-01</span> <span class="comment">//配置成员编号及成员描述</span></span><br><span class="line"></span><br><span class="line">[H3C]irf domain <span class="number">100</span> <span class="comment">//配置域编号（2台IRF成员设备必须属于同一个域否则堆叠没法形成IRF关系）</span></span><br><span class="line"> </span><br><span class="line">步骤<span class="number">3</span>：将用于IRF堆叠的的成员端口切为二层模式，并shutdown，并关闭stp(可选）</span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]port link-mode bridge</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]undo stp enable</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]port link-mode bridge</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]undo stp enable</span><br><span class="line"></span><br><span class="line">步骤<span class="number">4</span>：配置irf-port</span><br><span class="line"></span><br><span class="line">irf-port <span class="number">1</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">port group interface GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span> <span class="comment">//添加用于IRF堆叠的成员端口</span></span><br><span class="line"></span><br><span class="line">port group interface GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line">步骤<span class="number">5</span>：开启用于IRF堆叠的成员端口</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">0</span>]undo shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet1/<span class="number">0</span>/<span class="number">1</span>]undo shutdown</span><br><span class="line"></span><br><span class="line">步骤<span class="number">5</span>：保存配置，并激活irf-port配置</span><br><span class="line"></span><br><span class="line">&lt;H3C&gt;Save</span><br><span class="line"></span><br><span class="line">[H3C]irf-port-configuration active <span class="comment">//激活irf-port配置</span></span><br><span class="line"></span><br><span class="line">SR8808<span class="number">-02</span>路由器IRF配置：</span><br><span class="line"></span><br><span class="line">步骤<span class="number">1</span>：将运行模式由独立运行模式切换为IRF模式</span><br><span class="line"></span><br><span class="line">[H3C]chassis convert mode irf <span class="comment">//将运行模式由独立运行模式切换为IRF模式</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">步骤<span class="number">2</span>：将SR8808<span class="number">-02</span>设备的成员编号修改为<span class="number">2</span>（默认为<span class="number">1</span>），然后重启</span><br><span class="line"></span><br><span class="line">[H3C]irf member <span class="number">1</span> renumber <span class="number">2</span></span><br><span class="line"></span><br><span class="line">&lt;H3C&gt;reboot</span><br><span class="line"></span><br><span class="line">步骤<span class="number">3</span>：配置IRF</span><br><span class="line"></span><br><span class="line">[H3C]irf member <span class="number">2</span> priority <span class="number">10</span> <span class="comment">//配置成员编号及优先级</span></span><br><span class="line"></span><br><span class="line">[H3C]irf member <span class="number">2</span> description SR8808<span class="number">-02</span> <span class="comment">//配置成员编号及成员描述</span></span><br><span class="line"></span><br><span class="line">[H3C]irf domain <span class="number">100</span> <span class="comment">//配置域编号（2台IRF成员设备必须属于同一个域否则堆叠没法形成IRF关系）</span></span><br><span class="line"></span><br><span class="line">步骤<span class="number">4</span>：将用于IRF堆叠的的成员端口切为二层模式，并shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">0</span>]port link-mode bridge</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">0</span>]shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">0</span>]undo stp enable</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">1</span>]port link-mode bridge</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">1</span>]shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">1</span>]undo stp enable</span><br><span class="line"></span><br><span class="line">步骤<span class="number">5</span>：配置irf-port</span><br><span class="line"></span><br><span class="line">irf-port <span class="number">2</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line">port group interface GigabitEthernet2/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line"></span><br><span class="line">port group interface GigabitEthernet2/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"></span><br><span class="line">步骤<span class="number">6</span>：开启用于IRF堆叠的成员端口</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">0</span>]undo shutdown</span><br><span class="line"></span><br><span class="line">[H3C-GigabitEthernet2/<span class="number">0</span>/<span class="number">1</span>]undo shutdown</span><br><span class="line"></span><br><span class="line">步骤<span class="number">7</span>：保存、连接IRF堆叠线缆</span><br><span class="line"></span><br><span class="line">&lt;H3C&gt;Save</span><br><span class="line"></span><br><span class="line">连接<span class="number">2</span>台路由器之间的IRF堆叠线缆</span><br><span class="line"></span><br><span class="line">步骤<span class="number">8</span>：并激活irf-port配置，此时<span class="number">2</span>台路由器会相互发送IRF协议报文(携带成员编号、优先级、域编号），优先级大的成为Master，优先级小的称为Slave(并自动重启)，然后形成IRF堆叠</span><br><span class="line"></span><br><span class="line">[H3C]irf-port-configuration active <span class="comment">//激活irf-port配置</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信11&quot;&gt;&lt;a href=&quot;#数据通信11&quot; class=&quot;headerlink&quot; title=&quot;数据通信11&quot;&gt;&lt;/a&gt;数据通信11&lt;/h1&gt;&lt;p&gt;要学会避责，成为甩锅大神&lt;/p&gt;
&lt;h2 id=&quot;网络准入控制NAC&quot;&gt;&lt;a href=&quot;#网络准入控制NA</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A110/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A110/</id>
    <published>2024-07-10T07:22:42.514Z</published>
    <updated>2024-05-04T04:04:29.453Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信10"><a href="#数据通信10" class="headerlink" title="数据通信10"></a>数据通信10</h1><p>从计网入门到网络黑客大成</p><p>[TOC]</p><h2 id="MAC地址表项配置"><a href="#MAC地址表项配置" class="headerlink" title="MAC地址表项配置"></a>MAC地址表项配置</h2><h3 id="配置静态mac表项"><a href="#配置静态mac表项" class="headerlink" title="配置静态mac表项"></a>配置静态mac表项</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mac-address <span class="type">static</span> mac-address interface-type inter-number vlan XX</span><br></pre></td></tr></table></figure><h3 id="配置mac黑洞MAC表项"><a href="#配置mac黑洞MAC表项" class="headerlink" title="配置mac黑洞MAC表项"></a>配置mac黑洞MAC表项</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mac-address blackhole mac-address 【vlan xx】</span><br></pre></td></tr></table></figure><h3 id="配置动态MAC表项的老化时间"><a href="#配置动态MAC表项的老化时间" class="headerlink" title="配置动态MAC表项的老化时间"></a>配置动态MAC表项的老化时间</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mac-address aging-time ading-time</span><br></pre></td></tr></table></figure><h3 id="MAC地址表安全配置举例"><a href="#MAC地址表安全配置举例" class="headerlink" title="MAC地址表安全配置举例"></a>MAC地址表安全配置举例</h3><p><strong>防止其他人的mac地址表攻击：</strong>发送大量的假的mac地址占据交换机的mac地址表，然后接收它的泛洪信息以破解命令(kali的macof)</p><h3 id="端口安全技术"><a href="#端口安全技术" class="headerlink" title="端口安全技术"></a>端口安全技术</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">port-security enable</span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">port-security mac-address sticky<span class="comment">//开启粘性mac模式</span></span><br><span class="line">port-security max-mac-num xx<span class="comment">//前xx个加入的pc的mac地址会记录，只有这些可以上网</span></span><br><span class="line">port-security protect-action &#123; protect | <span class="keyword">restrict</span> | shutdown &#125;<span class="comment">//配置端口安全保护动作</span></span><br><span class="line"><span class="comment">/*protect：当学习到的MAC地址数达到接口限制数时，接口丢弃源地址在MAC表以外的报文。</span></span><br><span class="line"><span class="comment">restrict：当学习到的MAC地址数超过接口限制数时，接口丢弃源地址在MAC表以外的报文，同时发出告警。</span></span><br><span class="line"><span class="comment">shutdown：当学习到的MAC地址数超过接口限制数时，将接口Error-Down，同时发出告警。*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="DHCP-snooping（窥探）"><a href="#DHCP-snooping（窥探）" class="headerlink" title="DHCP snooping（窥探）"></a>DHCP snooping（窥探）</h2><h3 id="出现背景"><a href="#出现背景" class="headerlink" title="出现背景"></a>出现背景</h3><p>一种攻击方式是打掉原来局域网的dhcp服务器然后再自己当上dhcp，为其他主机写ip地址，并且将相关的网关设置成自己，以此来”引流”</p><p><strong>dos dhcp discover 不断广播discover报文把原来的服务器搞崩，然后自己再假冒dhcp服务器分发ip</strong></p><h3 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h3><p>先<strong>全部设置为不信任端口</strong>（这时候收不到一点offer），再手动设置信任端口，信任端口可以通过offer包，不信任端口不通过offer包</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dhcp snooping enable<span class="comment">//全局</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span><span class="comment">//进入接口或者vlan</span></span><br><span class="line">dhcp snooping enable</span><br><span class="line"></span><br><span class="line">dhcp snooping trusted<span class="comment">//配置信任端口</span></span><br></pre></td></tr></table></figure><h2 id="IPSG"><a href="#IPSG" class="headerlink" title="IPSG"></a>IPSG</h2><p><strong>IP源防攻击</strong></p><p>出现原因：一些攻击者通过伪造合法用户的IP地址获取网络访问权限，非法访问网络</p><p><strong>实验配置</strong></p><p>基于dhcp snooping功能</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IP source check user-bind enable</span><br></pre></td></tr></table></figure><p>如果说有人在一个路由器上接线并且伪造了原网络的一个设备的ip的话，路由器查ipsg的绑定表发现不对后会堵塞掉新接入的那个端口</p><h2 id="VXLAN：虚拟拓展局域网–隧道技术"><a href="#VXLAN：虚拟拓展局域网–隧道技术" class="headerlink" title="VXLAN：虚拟拓展局域网–隧道技术"></a>VXLAN：虚拟拓展局域网–隧道技术</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><strong>将三层的设备两两相连，在逻辑上构成一个二层交换机，实现l2封装在l4上并且在l3中传输</strong></p><p><strong><u>采用mac in udp 封装，将以太报文封装在ip报文上</u></strong></p><h3 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h3><h4 id="bdif"><a href="#bdif" class="headerlink" title="bdif"></a>bdif</h4><p>BDIF接口的功能与VLANIF接口类似，是基于BD创建的三层逻辑接口，用以实现不同子网之间的通信，或VXLAN网络与非VXLAN网络之间的通信。</p><h4 id="VAP"><a href="#VAP" class="headerlink" title="VAP"></a>VAP</h4><p>虚拟接入点VAP，即VXLAN业务接入点，可以是二层子接口或VLAN</p><p>当接入节点是二层子接口时，通过在二层子接口上配置<strong>流封装类型</strong>（那4种）实现不同的接口接入不同的数据报文，将二层子接口关联广播域BD后，可实现数据报文通过BD转发。当业务接入点是VLAN时，需要将VLAN绑定到广播域BD，也可以实现数据报文通过BD转发。</p><h4 id="spine-leaf"><a href="#spine-leaf" class="headerlink" title="spine-leaf"></a>spine-leaf</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231209145518270.png" alt="image-20231209145518270"></p><p>vxlan<strong>配置在leaf（交换机）之间</strong>，完成vxlan的封装和解封装，spine节点（<strong>路由器）只进行路由转发</strong>，类似于之前学习到的ibgp之间进行配置，而中间那个路由器就不管了</p><h4 id="NVE"><a href="#NVE" class="headerlink" title="NVE"></a>NVE</h4><p>网络虚拟边缘节点NVE，实现网络虚拟化功能的网络实体。报文经过NVE封装转换后，NVE间就可基于三层基础网络建立二层虚拟化网络。（设备和服务器上的虚拟交换机VSwitch都可以作为NVE）</p><ul><li><p>硬件模式：所有的NVE都部署在支持NVE的设备上，所有的VXLAN报文封装与解封装都在设备上进行。</p></li><li><p>软件模式：所有的NVE都部署在vSwitch（开放的虚拟交换机）上，所有的VXLAN报文封装与解封装都在vSwitch上进行。</p></li><li><p>混合模式：部分NVE部署在vSwitch上，部分NVE部署在支持NVE的设备上，在vSwitch和设备上都有可能会进行VXLAN报文封装与解封装。</p></li></ul><h3 id="vxlan出现的原因"><a href="#vxlan出现的原因" class="headerlink" title="vxlan出现的原因"></a>vxlan出现的原因</h3><ol><li>虚拟机的动态迁移需要无障碍接入</li><li>租户过多，传统的valn技术不再适用，需要隔离海量的租户</li></ol><h3 id="服务器虚拟化技术"><a href="#服务器虚拟化技术" class="headerlink" title="服务器虚拟化技术"></a>服务器虚拟化技术</h3><p>将<strong>物理服务器</strong>分成多个<strong>虚拟服务器</strong>，这些服务器<strong>通过虚拟交换机（vswitch）与外界相连</strong></p><p>虚拟化的问题：</p><ol><li>vlan个数不够</li><li>mac地址表过大</li></ol><h3 id="服务器动态迁移"><a href="#服务器动态迁移" class="headerlink" title="服务器动态迁移"></a>服务器动态迁移</h3><p>原服务器正常运行的同时，将系统从一个物理服务器迁移到另一个物理服务器上，这要求服务器的<strong>tcp会话状态不变</strong>（ip不改变），所以<strong>只能在二层之中进行迁移</strong>，但是大型网络都会有三层结构，服务器迁移就需要<strong>vxlan技术将三层设备抽象成二层交换机</strong></p><h3 id="vxlan的报文格式"><a href="#vxlan的报文格式" class="headerlink" title="vxlan的报文格式"></a>vxlan的报文格式</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231209150126013.png" alt="image-20231209150126013"></p><h4 id="VTEP"><a href="#VTEP" class="headerlink" title="VTEP"></a>VTEP</h4><p><strong>VXLAN Tunnel Endpoints，VXLAN隧道端点</strong></p><p>就是之前的leaf节点，完成vxlan的封装和解封装</p><p>VTEP既可以是一台<strong>独立的网络设备</strong>（比如华为的CloudEngine系列交换机），也可以是在服务器中的<strong>虚拟交换机</strong>（vswitch）</p><h4 id="VNI"><a href="#VNI" class="headerlink" title="VNI"></a>VNI</h4><p><strong>VXLAN Network Identifier，VXLAN 网络标识符</strong></p><p>解决掉vlan id 不足的问题，功能类似，一个vni代表一个租户（虚拟机）</p><p>二层&#x2F;三层vni？</p><h4 id="vxlan报文"><a href="#vxlan报文" class="headerlink" title="vxlan报文"></a>vxlan报文</h4><ul><li><p>vxlan header :24比特的vni字段用来定义不同的租户，类似于vlan id。还有vxlan flags（0000 1000），两个保留字段</p></li><li><p>udp header：vxlan头部和原始数据帧组成udp数据。源udp端口通过哈希算法得到，源端口固定为4789</p></li><li><p>外部 IP 头部：源ip—源端vtep的ip地址   目的ip—目的端vtep的ip地址</p></li><li><p>外部mac头部：源mac—源端vtep的mac地址   目的mac—目的端vtep的mac地址</p></li></ul><h3 id="哪些vtep建立隧道连接"><a href="#哪些vtep建立隧道连接" class="headerlink" title="哪些vtep建立隧道连接"></a>哪些vtep建立隧道连接</h3><h4 id="大二层网络"><a href="#大二层网络" class="headerlink" title="大二层网络"></a>大二层网络</h4><p>两两互连</p><h4 id="同一大二层域BD"><a href="#同一大二层域BD" class="headerlink" title="同一大二层域BD"></a>同一大二层域BD</h4><p>类似于之前的vlan区域，但是vxlan这里叫BD（bridge-domain）</p><p><strong>创建配置</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bride-domain <span class="number">10</span><span class="comment">//创建bd 10</span></span><br><span class="line">vxlan vni <span class="number">5000</span><span class="comment">//bd 10下与之关联的是vni 500</span></span><br><span class="line"><span class="comment">//感觉像进入端口配置模式acess再default的感觉</span></span><br></pre></td></tr></table></figure><p>一个vni对应一个bd，一个bd下可以有多个vni</p><h3 id="哪些报文会走vxlan隧道"><a href="#哪些报文会走vxlan隧道" class="headerlink" title="哪些报文会走vxlan隧道"></a>哪些报文会走vxlan隧道</h3><h4 id="传统派"><a href="#传统派" class="headerlink" title="传统派"></a>传统派</h4><p>传统vlan技术中定义了三种不同类型的接口：Access、Trunk、Hybrid。这三种类型的接口虽然应用场景不同，但它们的最终目的是一样的：一是<strong>根据配置来检查哪些报文是允许通过的</strong>；二是判断对<strong>检查通过的报文做怎样的处理。</strong></p><h4 id="维新派"><a href="#维新派" class="headerlink" title="维新派"></a>维新派</h4><p>VXLAN网络中，VTEP上的<strong>“二层子接口”的逻辑接口</strong>也承担着类似的任务。二层子接口主要做两件事：一是<strong>根据配置来检查哪些报文需要进入VXLAN隧道</strong>；二是<strong>判断对检查通过的报文做怎样的处理</strong>。支持的流封装类型有<strong>dot1q</strong>、<strong>untag</strong>、<strong>qinq</strong>和<strong>default</strong>四种类型：</p><ul><li>dot1q：对于带有<strong>一层VLAN Tag</strong>的报文，该类型接口<strong>只接收与指定VLAN Ta</strong>g匹配的报文；对于带有<strong>两层VLAN</strong><br><strong>Tag的报文</strong>，该类型接口<strong>只接收外层VLAN Tag</strong>与指定VLAN Tag匹配的报文。（1层对应，两层对vni）</li><li>untag：该类型接口只接收<u>不带VLAN Tag</u>的报文。（0）</li><li>qinq：该类型接口<strong>只接收带有指定两层VLAN Tag</strong>的报文。（两层都对）</li><li>default：允许接口<strong>接收所有报文</strong>，不区分报文中是否带VLAN Tag。该类型接口都<strong>不会对原始报文进行任何VLAN Tag处理</strong>，包括添加、替换或剥离。（1）</li></ul><p><u>类型三变四，任务类似</u></p><p><strong>将二层子接口加入到指定的BD，再根据二层子接口上的配置，设备就可以确定报文属于哪个BD了</strong></p><h4 id="栗子"><a href="#栗子" class="headerlink" title="栗子"></a><strong>栗子</strong></h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/20201112101102241.png" alt="在这里插入图片描述"></p><ol><li><p>分别在VTEP的物理接口10GE 1&#x2F;0&#x2F;1上，分别针对VM1和VM2封装不同的二层子接口1&#x2F;0&#x2F;1.1</p></li><li><p>在VTEP的接入口上创建两个二层子接口，分别配置为dot1q和untag的封装类型，并将其分别加入不同的BD</p></li><li><p>vSwitch的上行口配置成Trunk模式，这样vSwitch发给VTEP的报文中，既有带tag的VM1流量，又有untag的VM2流量（pvid是20，truck口出去的时候会把vlan 20的标签删掉）</p></li></ol><p>标签复习一下：</p><table><thead><tr><th>access</th><th>truck</th></tr></thead><tbody><tr><td>收：没标签，打上，进入|有标签，丢弃数据</td><td>收：没有vid，打上pvid，进入|有vid，允许进入，不允许丢弃</td></tr><tr><td><strong>发：去掉标签</strong></td><td>发：<strong>vid&#x3D;&#x3D;pvid，去标签</strong>发|vid！&#x3D;pvid，直接发送</td></tr></tbody></table><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/v2-8b9d084da4096742fcd8215187274765_1440w.webp" alt="img"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="number">10</span>GE1/<span class="number">0</span>/<span class="number">1.1</span> mode l2<span class="comment">//创建二层接口</span></span><br><span class="line">encapsulation dolt1q vid <span class="number">10</span><span class="comment">//只允许vlan tag 10的报文进入vxlan隧道</span></span><br><span class="line">bride-domain <span class="number">10</span><span class="comment">//绑定bd 10</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="type">int</span> <span class="number">10</span>GE1/<span class="number">0</span>/<span class="number">1.2</span> mode l2<span class="comment">//创建二层接口</span></span><br><span class="line">encapsulation untag<span class="comment">//只允许vlan tag 20的报文进入vxlan隧道</span></span><br><span class="line">bride-domain <span class="number">20</span><span class="comment">//绑定bd 20</span></span><br></pre></td></tr></table></figure><p><strong>本质上还是靠标签进行确认</strong></p><h3 id="VXLAN隧道的建立"><a href="#VXLAN隧道的建立" class="headerlink" title="VXLAN隧道的建立"></a>VXLAN隧道的建立</h3><h4 id="手动"><a href="#手动" class="headerlink" title="手动"></a>手动</h4><p><strong>用户手动指定VXLAN隧道的源IP为本端VTEP的IP、目的IP为对端VTEP的IP</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Nve <span class="number">1</span><span class="comment">//创建逻辑接口Nve 1</span></span><br><span class="line">source <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span> <span class="comment">//源ip</span></span><br><span class="line">vni <span class="number">5000</span> head-end peer-<span class="built_in">list</span> <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span><span class="comment">//对端ip（1）</span></span><br><span class="line">vni <span class="number">5000</span> head-end peer-<span class="built_in">list</span> <span class="number">2.2</span><span class="number">.2</span><span class="number">.3</span><span class="comment">//对端ip（2）</span></span><br></pre></td></tr></table></figure><p><strong>头端复制列表</strong></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/20201112103425968.png" alt="**头端复制列表**"></p><p>感觉上类似于转发表，Peer List指明同一个bd下的vtep有哪些</p><p>，bum指Broadcast&amp;Unknown-unicast&amp;Multicast，广播&amp;未知单播&amp;组播报文，一个vtep收到bum时会发给其他的对端vtep</p><h4 id="自动"><a href="#自动" class="headerlink" title="自动"></a>自动</h4><p>evpn学</p><h3 id="VXLAN隧道的选择"><a href="#VXLAN隧道的选择" class="headerlink" title="VXLAN隧道的选择"></a>VXLAN隧道的选择</h3><h4 id="VXLAN网关"><a href="#VXLAN网关" class="headerlink" title="VXLAN网关"></a>VXLAN网关</h4><p>不同的vni之间的主机不能相互通信，为此出现了vxlan网关</p><ul><li>VXLAN二层网关：用于终端接入VXLAN网络，也可用于同一VXLAN网络的子网通信。</li><li>VXLAN三层网关：用于VXLAN网络中跨子网通信以及访问外部网络。</li></ul><p>其中三层网关又分为<strong>集中式网关与分布式网关</strong></p><h4 id="集中式网关"><a href="#集中式网关" class="headerlink" title="集中式网关"></a>集中式网关</h4><h3 id="集中式VXLAN中不同子网互通流程"><a href="#集中式VXLAN中不同子网互通流程" class="headerlink" title="集中式VXLAN中不同子网互通流程"></a>集中式VXLAN中不同子网互通流程</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231213144040730.png" alt="image-20231213144040730"></p><ol><li>A将报文先交给vtep1，源ip是自己，源mac是自己，目标ip是b的ip，<strong>目标mac是自己网关的mac（下一跳</strong>：bdif 10）</li><li>vtep1收到报文之后识别到报文要走vni隧道，进行报文封装，将源ip和mac修改成vtep1的ip和mac地址</li><li>vtep3收到报文发现数据要去b，于是根据路由表得到下一跳（bdif20），将源ip和mac进行修改</li><li>bdif20收到报文后进行发送的过程和vtep1发的过程类似</li><li>vtep2收到数据后解封装发送给b</li></ol><p><strong>集中式网关由spine结点做三层网关，分布式也可以用leaf节点做三层网关</strong></p><h2 id="实验配置-1"><a href="#实验配置-1" class="headerlink" title="实验配置"></a>实验配置</h2><h3 id="配置同网段用户通过VXLAN隧道互通"><a href="#配置同网段用户通过VXLAN隧道互通" class="headerlink" title="配置同网段用户通过VXLAN隧道互通"></a>配置同网段用户通过VXLAN隧道互通</h3><h4 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a><strong>拓扑图</strong></h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231214001656597.png" alt="image-20231214001656597"></p><ol><li>基础配置：设备名称，ip地址，vlan，接口模式等</li><li>配置ospf路由协议，使得环回口互通</li><li>vxlan配置</li><li>验证</li></ol><h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">ce1</span><br><span class="line">bridge-domain <span class="number">10</span></span><br><span class="line"> vxlan vni <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GE1/0/0</span></span><br><span class="line"> undo portswitch</span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">12.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> un shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">int lo 0</span></span><br><span class="line">ip ad <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GE1/0/1</span></span><br><span class="line"> undo shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">interface GE1/0/1.1 mode l2</span></span><br><span class="line"> encapsulation dot1q vid <span class="number">10</span></span><br><span class="line"> bridge-domain <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Nve1</span></span><br><span class="line"> source <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span></span><br><span class="line"> vni <span class="number">10</span> head-end peer-<span class="built_in">list</span> <span class="number">30.30</span><span class="number">.30</span><span class="number">.30</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">ospf 1</span></span><br><span class="line"> area <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">12.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">#</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ce2</span><br><span class="line">bridge-domain <span class="number">10</span></span><br><span class="line"> vxlan vni <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GE1/0/0</span></span><br><span class="line"> undo portswitch</span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">12.1</span><span class="number">.1</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> un shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">interface GE1/0/1</span></span><br><span class="line"> undo portswitch</span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">23.1</span><span class="number">.1</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> un shutdown</span><br><span class="line"> <span class="meta">#</span></span><br><span class="line"><span class="meta">int lo 0</span></span><br><span class="line">ip ad <span class="number">20.20</span><span class="number">.20</span><span class="number">.20</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">ospf 1</span></span><br><span class="line"> area <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">12.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">23.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">20.20</span><span class="number">.20</span><span class="number">.20</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">#</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ce3</span><br><span class="line">bridge-domain <span class="number">10</span></span><br><span class="line"> vxlan vni <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GE1/0/0</span></span><br><span class="line"> undo portswitch</span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">23.1</span><span class="number">.1</span><span class="number">.3</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> un shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">int lo 0</span></span><br><span class="line">ip ad <span class="number">30.30</span><span class="number">.30</span><span class="number">.30</span> <span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GE1/0/1</span></span><br><span class="line"> undo shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">interface GE1/0/1.1 mode l2</span></span><br><span class="line"> encapsulation dot1q vid <span class="number">10</span></span><br><span class="line"> bridge-domain <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Nve1</span></span><br><span class="line"> source <span class="number">30.30</span><span class="number">.30</span><span class="number">.30</span></span><br><span class="line"> vni <span class="number">10</span> head-end peer-<span class="built_in">list</span> <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">ospf 1</span></span><br><span class="line"> area <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">23.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">30.30</span><span class="number">.30</span><span class="number">.30</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">#</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lsw2</span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">2</span> to <span class="number">4094</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">10</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lsw3</span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">2</span> to <span class="number">4094</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">10</span></span><br></pre></td></tr></table></figure><h4 id="结果验证"><a href="#结果验证" class="headerlink" title="结果验证"></a>结果验证</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231213234315233.png" alt="image-20231213234315233"></p><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231214001503541.png" alt="image-20231214001503541"></p><h3 id="配置不同网段用户通过VXLAN三层网关通信"><a href="#配置不同网段用户通过VXLAN三层网关通信" class="headerlink" title="配置不同网段用户通过VXLAN三层网关通信"></a>配置不同网段用户通过VXLAN三层网关通信</h3><h4 id="拓扑图-1"><a href="#拓扑图-1" class="headerlink" title="拓扑图"></a><strong>拓扑图</strong></h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231214013253705.png" alt="image-20231214013253705"></p><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><ol><li>分别在ce1、ce2和ce3上配置ospf路由协议，保证网络三层互通。</li><li>分别在ce1和ce3上配置业务接入点实现区分业务流量。</li><li>分别在ce1、ce2和ce3上配置VXLAN隧道转发业务流量。</li><li><strong>在ce2上配置VXLAN三层网关，实现不同网段用户通过VXLAN三层网关互</strong></li></ol><p><strong><u>和同网段实验的区别就在于中间设备进行了配置：分别和leaf建立隧道并且设立了三层网关bdif</u></strong></p><h4 id="实验配置-2"><a href="#实验配置-2" class="headerlink" title="实验配置"></a>实验配置</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ce1</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">sysname Device1</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">bridge-domain 10</span></span><br><span class="line"> vxlan vni <span class="number">5010</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet1/0/1</span></span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet1/0/2</span></span><br><span class="line"> undo shutdown</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet1/0/2.1 mode l2</span></span><br><span class="line"> encapsulation dot1q vid <span class="number">10</span></span><br><span class="line"> rewrite pop single</span><br><span class="line"> bridge-domain <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface LoopBack1</span></span><br><span class="line"> ip address <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.255</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Nve1</span></span><br><span class="line"> source <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span></span><br><span class="line"> vni <span class="number">5010</span> head-end peer-<span class="built_in">list</span> <span class="number">3.3</span><span class="number">.3</span><span class="number">.3</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">ospf 1</span></span><br><span class="line"> area <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">10.1</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">return</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ce2</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">sysname Device2</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">bridge-domain 10</span></span><br><span class="line"> vxlan vni <span class="number">5010</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">bridge-domain 20</span></span><br><span class="line"> vxlan vni <span class="number">5020</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Vbdif10</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.10</span><span class="number">.10</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Vbdif20</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.20</span><span class="number">.10</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet1/0/1</span></span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet1/0/2</span></span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface LoopBack1</span></span><br><span class="line"> ip address <span class="number">3.3</span><span class="number">.3</span><span class="number">.3</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.255</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface Nve1</span></span><br><span class="line"> source <span class="number">3.3</span><span class="number">.3</span><span class="number">.3</span></span><br><span class="line"> vni <span class="number">5010</span> head-end peer-<span class="built_in">list</span> <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span></span><br><span class="line"> vni <span class="number">5020</span> head-end peer-<span class="built_in">list</span> <span class="number">4.4</span><span class="number">.4</span><span class="number">.4</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">ospf 1</span></span><br><span class="line"> area <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">3.3</span><span class="number">.3</span><span class="number">.3</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">  network <span class="number">192.168</span><span class="number">.2</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">return</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ce3</span><br><span class="line">#</span><br><span class="line">sysname Device3</span><br><span class="line">#</span><br><span class="line">bridge-domain 20</span><br><span class="line"> vxlan vni 5020</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet1/0/1</span><br><span class="line"> undo shutdown</span><br><span class="line"> ip address 192.168.2.2 255.255.255.0</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet1/0/2</span><br><span class="line"> undo shutdown</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet1/0/2.1 mode l2</span><br><span class="line"> encapsulation dot1q vid 20</span><br><span class="line"> rewrite pop single</span><br><span class="line"> bridge-domain 20</span><br><span class="line">#</span><br><span class="line">interface LoopBack1</span><br><span class="line"> ip address 4.4.4.4 255.255.255.255</span><br><span class="line">#</span><br><span class="line">interface Nve1</span><br><span class="line"> source 4.4.4.4</span><br><span class="line"> vni 5020 head-end peer-list 3.3.3.3</span><br><span class="line">#</span><br><span class="line">ospf 1</span><br><span class="line"> area 0.0.0.0</span><br><span class="line">  network 4.4.4.4 0.0.0.0</span><br><span class="line">  network 10.2.1.0 0.0.0.255</span><br><span class="line">  network 192.168.2.0 0.0.0.255</span><br><span class="line">#</span><br><span class="line">return</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lsw2</span><br><span class="line">    vlan <span class="number">10</span></span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">2</span> to <span class="number">4094</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">10</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lsw3</span><br><span class="line">    vlan <span class="number">20</span></span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">2</span> to <span class="number">4094</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">20</span></span><br></pre></td></tr></table></figure><h4 id="结果检验"><a href="#结果检验" class="headerlink" title="结果检验"></a>结果检验</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231214012446954.png" alt="image-20231214012446954"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信10&quot;&gt;&lt;a href=&quot;#数据通信10&quot; class=&quot;headerlink&quot; title=&quot;数据通信10&quot;&gt;&lt;/a&gt;数据通信10&lt;/h1&gt;&lt;p&gt;从计网入门到网络黑客大成&lt;/p&gt;
&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;MAC地址表项配置&quot;&gt;&lt;a hr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A19/"/>
    <id>http://charles-webebr.github.io/2024/07/10/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A19/</id>
    <published>2024-07-10T07:22:42.512Z</published>
    <updated>2024-04-13T07:19:27.875Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据通信9"><a href="#数据通信9" class="headerlink" title="数据通信9"></a>数据通信9</h1><p>[TOC]</p><h2 id="smart-link（断了选路）"><a href="#smart-link（断了选路）" class="headerlink" title="smart-link（断了选路）"></a>smart-link（断了选路）</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>实现两根线的备份，和生成树类似，但是不用计算</p><p><strong>设置一个master和slave，主挂了次就顶上来</strong></p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a><strong>特点</strong></h3><ol><li>两根上行链路只走一条，打破回路</li><li>主链路故障后流量会立刻切换到备用的链路上</li><li>配置简单</li><li>没有协议交互报文，大大提升收敛速度</li></ol><h3 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h3><p><strong>samrt-link的功能与生成树冲突，因此要先关闭stp</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">0</span></span><br><span class="line">stp disable</span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">stp disable</span><br><span class="line">smart-link group <span class="number">1</span></span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">0</span> master </span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">2</span> slave</span><br><span class="line">restore enable<span class="comment">//回切功能打开</span></span><br><span class="line">time wtr <span class="number">30</span><span class="comment">//等待回切时间</span></span><br></pre></td></tr></table></figure><h2 id="monitor-link（一起断）"><a href="#monitor-link（一起断）" class="headerlink" title="monitor-link（一起断）"></a>monitor-link（一起断）</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>为了解决smart-link的的缺点</p><h3 id="实验配置-1"><a href="#实验配置-1" class="headerlink" title="实验配置"></a>实验配置</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231202110137413.png" alt="image-20231202110137413"></p><p>将交换机LSW2 1和2端口配置monitor link，将2号口设置为uplink，1号口设置为downink</p><p>将交换机LSW3 1和2端口配置monitor link，将2号口设置为uplink，1号口设置为downink</p><p>R1</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">stp disable</span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">stp disable</span><br><span class="line">smart-link enable</span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">1</span> master</span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">2</span> slave</span><br><span class="line">flush send contorl-vlan <span class="number">1</span></span><br></pre></td></tr></table></figure><p>R2</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">stp disable</span><br><span class="line">smart-link flush receive control-vlan <span class="number">1</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">stp disable</span><br><span class="line">smart-link flush receive control-vlan <span class="number">1</span></span><br><span class="line">smart-link enable</span><br><span class="line">monitor-link group <span class="number">1</span></span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">1</span> uplink</span><br><span class="line">port g0/<span class="number">0</span>/<span class="number">2</span> downlink <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>R3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int g0/0/1</span><br><span class="line">stp disable</span><br><span class="line">smart-link flush receive control-vlan 1</span><br><span class="line">int g0/0/2</span><br><span class="line">stp disable</span><br><span class="line">smart-link flush receive control-vlan 1</span><br><span class="line">smart-link enable</span><br><span class="line">monitor-link group 1</span><br><span class="line">port g0/0/1 uplink</span><br><span class="line">port g0/0/2 downlink 1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="VRRP（备份-一个断了另一个补上）"><a href="#VRRP（备份-一个断了另一个补上）" class="headerlink" title="VRRP（备份-一个断了另一个补上）"></a>VRRP（备份-一个断了另一个补上）</h2><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231202103235036.png" alt="image-20231202103235036"></p><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><ul><li><p>虚拟路由器备份协议，用于一个pc有多个链路选择但是仅有一个网关（<strong>网关备份</strong>）</p></li><li><p>先在多个路由器里面选一个主机（master），其他的作为备份机（back-up）</p></li><li><p>pc在找自己的网关的时候会发送arp请求报文，只有master会回应arp请求</p></li></ul><h3 id="实验配置-2"><a href="#实验配置-2" class="headerlink" title="实验配置"></a>实验配置</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vrrp vrid <span class="number">1</span></span><br><span class="line">vrrp vrid <span class="number">1</span> virtual-ip <span class="number">10.234</span><span class="number">.0</span><span class="number">.1</span><span class="comment">//不存在的ip地址</span></span><br></pre></td></tr></table></figure><p><strong>虚拟mac地址<u>00:00:5e:00:01</u>:xx</strong>(16进制)</p><p>？那么master是<strong>怎么选举</strong>出来的呢？</p><ol><li>比较优先级，默认100（<strong>具备抢占性</strong>，可以自己关）</li><li>比较ip地址（<strong>不具备抢占性</strong>，一开始配置的就是master，如果需要更换，把接口关了再开，就会切换了）</li></ol><h3 id="链路状态监测"><a href="#链路状态监测" class="headerlink" title="链路状态监测"></a>链路状态监测</h3><h4 id="基于端口"><a href="#基于端口" class="headerlink" title="基于端口"></a>基于端口</h4><p><strong>下行链路做的vrrp，那么向上的链路down了怎么办呢？</strong></p><p>我们可以做一个<strong>vrrp跟踪</strong>来监控特定端口，如果端口出现异常使得优先级降低，这样就可以切换master了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vrrp vrid <span class="number">1</span> track <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span> reduced <span class="number">10</span> </span><br></pre></td></tr></table></figure><h4 id="基于nqa"><a href="#基于nqa" class="headerlink" title="基于nqa"></a>基于nqa</h4><p><strong>但是这样也有问题，线路没断就不会切换，要使用nqa来解决（判断标准更多）</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[RouterA] nqa test-instance user test</span><br><span class="line">[RouterA-user-test] test-type icmp</span><br><span class="line">[RouterA-user-test] destination-address ipv4 <span class="number">20.1</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line">[RouterA-user-test] frequency <span class="number">20</span></span><br><span class="line">[RouterA-user-test] probe-count <span class="number">5</span></span><br><span class="line">[RouterA-user-test] fail-percent <span class="number">80</span></span><br><span class="line">[RouterA-user-test] start now</span><br><span class="line">[RouterA-user-test] quit</span><br></pre></td></tr></table></figure><h2 id="MUX-VLAN（分隔vlan）"><a href="#MUX-VLAN（分隔vlan）" class="headerlink" title="MUX-VLAN（分隔vlan）"></a>MUX-VLAN（分隔vlan）</h2><h3 id="访问规则"><a href="#访问规则" class="headerlink" title="访问规则"></a>访问规则</h3><ul><li>在隔离域内部的主机既不能和本域主机通信，也不可以和外部通信</li><li>在一个组里面的主机可以互相通信</li><li>主vlan可以和所有的主机通信</li></ul><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231206224235529.png" alt="image-20231206224235529"></p><h3 id="实验配置-3"><a href="#实验配置-3" class="headerlink" title="实验配置"></a>实验配置</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- vlan batch <span class="number">100</span> <span class="number">200</span> <span class="number">300</span> <span class="number">400</span></span><br><span class="line"></span><br><span class="line">- vlan <span class="number">100</span></span><br><span class="line">- mux-vlan  </span><br><span class="line"></span><br><span class="line">- subordinate separate <span class="number">400</span>（该vlan内pc谁都联系不了）</span><br><span class="line"></span><br><span class="line">- subordinate group <span class="number">200</span> <span class="number">300</span>（该vlan200内pc可以互相通信，但是<span class="number">200</span>和<span class="number">300</span>不可以）</span><br><span class="line"></span><br><span class="line">- 其他就和之前学的vlan划分类似：</span><br><span class="line"></span><br><span class="line">- interface GigabitEthernet0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  port link-type access</span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">100</span></span><br><span class="line">  **port mux-vlan enable**<span class="comment">//但是多了句</span></span><br></pre></td></tr></table></figure><h2 id="VLAN聚合（SUPER-VLAN）"><a href="#VLAN聚合（SUPER-VLAN）" class="headerlink" title="VLAN聚合（SUPER VLAN）"></a>VLAN聚合（SUPER VLAN）</h2><h4 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h4><p>定义Super-VLAN和Sub-VLAN</p><p>实现所有Sub-VLAN共用一个网关与外部网络通信，并用ARP Proxy实现Sub-VLAN间的三层通信，从而在实现普通VLAN的隔离广播域的同时，达到节省IP地址的目的。</p><h4 id="实验配置-4"><a href="#实验配置-4" class="headerlink" title="实验配置"></a>实验配置</h4><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231206230552259.png" alt="image-20231206230552259"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">lsw2</span><br><span class="line">vlan <span class="number">10</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">10</span>  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">10</span></span><br><span class="line"></span><br><span class="line">lsw3</span><br><span class="line">vlan <span class="number">20</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">20</span>  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lsw4</span><br><span class="line">vlan <span class="number">30</span></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">30</span>  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">lsw1 </span><br><span class="line">vlan batch <span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">100</span> <span class="number">200</span></span><br><span class="line">vlan <span class="number">100</span> </span><br><span class="line">aggregate-vlan<span class="comment">// 打开vlan聚合</span></span><br><span class="line">access-vlan <span class="number">10</span> <span class="number">20</span> <span class="number">30</span><span class="comment">//聚合对象是10 20 30</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">port link-type access</span><br><span class="line">port <span class="keyword">default</span> vlan <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">port link-type trunk</span><br><span class="line">port trunk allow-pass vlan <span class="number">10</span> <span class="number">20</span> <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> g0/<span class="number">0</span>/<span class="number">3</span></span><br><span class="line">port link-type trunk</span><br><span class="line">port trunk allow-pass vlan <span class="number">10</span> <span class="number">20</span> <span class="number">30</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="VLAN-QinQ（vlan的嵌套映射增加）"><a href="#VLAN-QinQ（vlan的嵌套映射增加）" class="headerlink" title="VLAN-QinQ（vlan的嵌套映射增加）"></a>VLAN-QinQ（vlan的嵌套映射增加）</h2><p>QinQ是指在802.1Q VLAN的基础上增加一层802.1Q VLAN标签，从而拓展VLAN的使用空间。在<strong>公网</strong>的传输过程中，设备只根据<strong>外层VLAN Tag转发报文</strong>，并根据报文的外层VLAN Tag进行MAC地址学习，而用户的<strong>私网VLAN Tag将被当作报文的数据部分进行传输。</strong></p><h3 id="实验配置-5"><a href="#实验配置-5" class="headerlink" title="实验配置"></a>实验配置</h3><ol><li>LSW1和LSW2的gi0&#x2F;0&#x2F;1上配置QinQ。外层VLAN是100或300。</li><li>PC的IP地址是192.168.10.x&#x2F;24，X是PC编号。</li></ol><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/image-20231206231436788.png" alt="image-20231206231436788"></p><h4 id="简单qinq-多vlan映射一个vlan"><a href="#简单qinq-多vlan映射一个vlan" class="headerlink" title="简单qinq(多vlan映射一个vlan)"></a>简单qinq(多vlan映射一个vlan)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">lsw1</span><br><span class="line">    vlan batch <span class="number">100</span><span class="comment">//创建vlan</span></span><br><span class="line">    <span class="comment">//配置qinq端口//</span></span><br><span class="line">    <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">    port link-type dolt1q-tunnel<span class="comment">//关键就是这句命令</span></span><br><span class="line">    port <span class="keyword">default</span> vlan <span class="number">100</span></span><br><span class="line">    q</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//配置trunk口，在g0/0/2开启trunk模式并且允许vlan100</span></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">  port link-type trunk</span><br><span class="line">  port trunk allow-pass vlan <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">lsw3</span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">1</span></span><br><span class="line">  port link-type trunk</span><br><span class="line">  port trunk allow-pass vlan <span class="number">10</span> <span class="number">30</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">2</span></span><br><span class="line">  port link-type access</span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">  <span class="type">int</span> g0/<span class="number">0</span>/<span class="number">3</span></span><br><span class="line">  port link-type access</span><br><span class="line">  port <span class="keyword">default</span> vlan <span class="number">30</span></span><br><span class="line">  </span><br><span class="line">    </span><br><span class="line">   </span><br></pre></td></tr></table></figure><h4 id="灵活qinq（单个vlan映射单个vlan）"><a href="#灵活qinq（单个vlan映射单个vlan）" class="headerlink" title="灵活qinq（单个vlan映射单个vlan）"></a>灵活qinq（单个vlan映射单个vlan）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">lsw1</span><br><span class="line">    vlan batch 100 300//创建vlan</span><br><span class="line">    //配置qinq端口//</span><br><span class="line">    int g0/0/1</span><br><span class="line">    //port link-type hybrid</span><br><span class="line">    //port hybrid untag 100 300</span><br><span class="line">  //port vlan translation enable</span><br><span class="line">    //port vlan-stacking vlan 10 stack 100</span><br><span class="line">    //port vlan-stacking vlan 30 stack 300</span><br><span class="line">    </span><br><span class="line">    //配置trunk口，在g0/0/2开启trunk模式并且允许vlan100</span><br><span class="line">  int g0/0/2</span><br><span class="line">  port link-type trunk</span><br><span class="line">  port trunk allow-pass vlan 100 300</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">lsw3</span><br><span class="line">vlan batch 10 30</span><br><span class="line">  int g0/0/1</span><br><span class="line">  port link-type trunk</span><br><span class="line">  port trunk allow-pass vlan 10 30</span><br><span class="line"></span><br><span class="line">  int g0/0/2</span><br><span class="line">  port link-type access</span><br><span class="line">  port default vlan 10</span><br><span class="line">    </span><br><span class="line">  int g0/0/3</span><br><span class="line">  port link-type access</span><br><span class="line">  port default vlan 30</span><br><span class="line">  </span><br></pre></td></tr></table></figure><h2 id="VLAN-MAPPING"><a href="#VLAN-MAPPING" class="headerlink" title="VLAN-MAPPING"></a>VLAN-MAPPING</h2><p>不同于QINQ的在原来的tag头部前再添加一个头部进行映射，mapping直接<strong>将一个vlan转换成另一个vlan</strong></p><h3 id="实验配置-6"><a href="#实验配置-6" class="headerlink" title="实验配置"></a>实验配置</h3><p><img src="https://gitee.com/Charles-Webber/blog-image1/raw/master/img/20180521131532123" alt="这里写图片描述"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">lsw1/lsw4</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet0/0/1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">10</span> <span class="number">20</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet0/0/2</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">10</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet0/0/3</span></span><br><span class="line"> port link-type access</span><br><span class="line"> port <span class="keyword">default</span> vlan <span class="number">20</span></span><br><span class="line">#</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">lsw2/lsw3   </span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet0/0/1</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">100</span> <span class="number">200</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">interface GigabitEthernet0/0/2</span></span><br><span class="line"> qinq vlan-translation enable</span><br><span class="line"> <span class="comment">//开启vlan转换功能</span></span><br><span class="line"> port link-type trunk</span><br><span class="line"> port trunk allow-pass vlan <span class="number">100</span> <span class="number">200</span></span><br><span class="line"> port vlan-mapping vlan <span class="number">10</span> <span class="built_in">map</span>-vlan <span class="number">100</span><span class="comment">//最重要的一步，类似于灵活qinq的配置模式</span></span><br><span class="line">  <span class="comment">//配置VLAN10映射为VLAN100</span></span><br><span class="line"> port vlan-mapping vlan <span class="number">20</span> <span class="built_in">map</span>-vlan <span class="number">200</span></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数据通信9&quot;&gt;&lt;a href=&quot;#数据通信9&quot; class=&quot;headerlink&quot; title=&quot;数据通信9&quot;&gt;&lt;/a&gt;数据通信9&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;smart-link（断了选路）&quot;&gt;&lt;a href=&quot;#smart-link（断</summary>
      
    
    
    
    
  </entry>
  
</feed>
